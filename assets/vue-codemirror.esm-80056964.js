import{y as Yg,d as Xg,z as Pl,A as _g,B as jg,o as Jg,C as Ti,D as Zg,E as Qg,G as $g}from"./index-17477c0a.js";var ac={exports:{}};(function(f,t){(function(i,n){f.exports=n()})(Yg,function(){var i=navigator.userAgent,n=navigator.platform,s=/gecko\/\d/i.test(i),h=/MSIE \d/.test(i),u=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(i),d=/Edge\/(\d+)/.exec(i),p=h||u||d,v=p&&(h?document.documentMode||6:+(d||u)[1]),b=!d&&/WebKit\//.test(i),x=b&&/Qt\/\d+\.\d+/.test(i),S=!d&&/Chrome\/(\d+)/.exec(i),M=S&&+S[1],A=/Opera\//.test(i),D=/Apple Computer/.test(navigator.vendor),N=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(i),P=/PhantomJS/.test(i),W=D&&(/Mobile\/\w+/.test(i)||navigator.maxTouchPoints>2),_=/Android/.test(i),Y=W||_||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(i),V=W||/Mac/.test(n),st=/\bCrOS\b/.test(i),Q=/win/i.test(n),pt=A&&i.match(/Version\/(\d*\.\d*)/);pt&&(pt=Number(pt[1])),pt&&pt>=15&&(A=!1,b=!0);var yt=V&&(x||A&&(pt==null||pt<12.11)),at=s||p&&v>=9;function nt(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var it=function(e,r){var l=e.className,o=nt(r).exec(l);if(o){var a=l.slice(o.index+o[0].length);e.className=l.slice(0,o.index)+(a?o[1]+a:"")}};function ct(e){for(var r=e.childNodes.length;r>0;--r)e.removeChild(e.firstChild);return e}function lt(e,r){return ct(e).appendChild(r)}function U(e,r,l,o){var a=document.createElement(e);if(l&&(a.className=l),o&&(a.style.cssText=o),typeof r=="string")a.appendChild(document.createTextNode(r));else if(r)for(var c=0;c<r.length;++c)a.appendChild(r[c]);return a}function ye(e,r,l,o){var a=U(e,r,l,o);return a.setAttribute("role","presentation"),a}var be;document.createRange?be=function(e,r,l,o){var a=document.createRange();return a.setEnd(o||e,l),a.setStart(e,r),a}:be=function(e,r,l){var o=document.body.createTextRange();try{o.moveToElementText(e.parentNode)}catch{return o}return o.collapse(!0),o.moveEnd("character",l),o.moveStart("character",r),o};function te(e,r){if(r.nodeType==3&&(r=r.parentNode),e.contains)return e.contains(r);do if(r.nodeType==11&&(r=r.host),r==e)return!0;while(r=r.parentNode)}function he(e){var r=e.ownerDocument||e,l;try{l=e.activeElement}catch{l=r.body||null}for(;l&&l.shadowRoot&&l.shadowRoot.activeElement;)l=l.shadowRoot.activeElement;return l}function Xt(e,r){var l=e.className;nt(r).test(l)||(e.className+=(l?" ":"")+r)}function ee(e,r){for(var l=e.split(" "),o=0;o<l.length;o++)l[o]&&!nt(l[o]).test(r)&&(r+=" "+l[o]);return r}var ie=function(e){e.select()};W?ie=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:p&&(ie=function(e){try{e.select()}catch{}});function ke(e){return e.display.wrapper.ownerDocument}function Ce(e){return De(e.display.wrapper)}function De(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function Fi(e){return ke(e).defaultView}function bo(e){var r=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,r)}}function zi(e,r,l){r||(r={});for(var o in e)e.hasOwnProperty(o)&&(l!==!1||!r.hasOwnProperty(o))&&(r[o]=e[o]);return r}function Ne(e,r,l,o,a){r==null&&(r=e.search(/[^\s\u00a0]/),r==-1&&(r=e.length));for(var c=o||0,g=a||0;;){var m=e.indexOf("	",c);if(m<0||m>=r)return g+(r-c);g+=m-c,g+=l-g%l,c=m+1}}var vi=function(){this.id=null,this.f=null,this.time=0,this.handler=bo(this.onTimeout,this)};vi.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},vi.prototype.set=function(e,r){this.f=r;var l=+new Date+e;(!this.id||l<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=l)};function _t(e,r){for(var l=0;l<e.length;++l)if(e[l]==r)return l;return-1}var Ya=50,Zn={toString:function(){return"CodeMirror.Pass"}},Ge={scroll:!1},wo={origin:"*mouse"},jr={origin:"+move"};function xo(e,r,l){for(var o=0,a=0;;){var c=e.indexOf("	",o);c==-1&&(c=e.length);var g=c-o;if(c==e.length||a+g>=r)return o+Math.min(g,r-a);if(a+=c-o,a+=l-a%l,o=c+1,a>=r)return o}}var Qn=[""];function So(e){for(;Qn.length<=e;)Qn.push(dt(Qn)+" ");return Qn[e]}function dt(e){return e[e.length-1]}function $n(e,r){for(var l=[],o=0;o<e.length;o++)l[o]=r(e[o],o);return l}function Ed(e,r,l){for(var o=0,a=l(r);o<e.length&&l(e[o])<=a;)o++;e.splice(o,0,r)}function Xa(){}function _a(e,r){var l;return Object.create?l=Object.create(e):(Xa.prototype=e,l=new Xa),r&&zi(r,l),l}var Bd=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ko(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Bd.test(e))}function ts(e,r){return r?r.source.indexOf("\\w")>-1&&ko(e)?!0:r.test(e):ko(e)}function ja(e){for(var r in e)if(e.hasOwnProperty(r)&&e[r])return!1;return!0}var Rd=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Co(e){return e.charCodeAt(0)>=768&&Rd.test(e)}function Ja(e,r,l){for(;(l<0?r>0:r<e.length)&&Co(e.charAt(r));)r+=l;return r}function Jr(e,r,l){for(var o=r>l?-1:1;;){if(r==l)return r;var a=(r+l)/2,c=o<0?Math.ceil(a):Math.floor(a);if(c==r)return e(c)?r:l;e(c)?l=c:r=c+o}}function Hd(e,r,l,o){if(!e)return o(r,l,"ltr",0);for(var a=!1,c=0;c<e.length;++c){var g=e[c];(g.from<l&&g.to>r||r==l&&g.to==r)&&(o(Math.max(g.from,r),Math.min(g.to,l),g.level==1?"rtl":"ltr",c),a=!0)}a||o(r,l,"ltr")}var Zr=null;function Qr(e,r,l){var o;Zr=null;for(var a=0;a<e.length;++a){var c=e[a];if(c.from<r&&c.to>r)return a;c.to==r&&(c.from!=c.to&&l=="before"?o=a:Zr=a),c.from==r&&(c.from!=c.to&&l!="before"?o=a:Zr=a)}return o??Zr}var Id=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function l(w){return w<=247?e.charAt(w):1424<=w&&w<=1524?"R":1536<=w&&w<=1785?r.charAt(w-1536):1774<=w&&w<=2220?"r":8192<=w&&w<=8203?"w":w==8204?"b":"L"}var o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,a=/[stwN]/,c=/[LRr]/,g=/[Lb1n]/,m=/[1n]/;function y(w,k,C){this.level=w,this.from=k,this.to=C}return function(w,k){var C=k=="ltr"?"L":"R";if(w.length==0||k=="ltr"&&!o.test(w))return!1;for(var L=w.length,T=[],O=0;O<L;++O)T.push(l(w.charCodeAt(O)));for(var E=0,R=C;E<L;++E){var H=T[E];H=="m"?T[E]=R:R=H}for(var F=0,I=C;F<L;++F){var K=T[F];K=="1"&&I=="r"?T[F]="n":c.test(K)&&(I=K,K=="r"&&(T[F]="R"))}for(var J=1,X=T[0];J<L-1;++J){var rt=T[J];rt=="+"&&X=="1"&&T[J+1]=="1"?T[J]="1":rt==","&&X==T[J+1]&&(X=="1"||X=="n")&&(T[J]=X),X=rt}for(var wt=0;wt<L;++wt){var Ut=T[wt];if(Ut==",")T[wt]="N";else if(Ut=="%"){var At=void 0;for(At=wt+1;At<L&&T[At]=="%";++At);for(var xe=wt&&T[wt-1]=="!"||At<L&&T[At]=="1"?"1":"N",de=wt;de<At;++de)T[de]=xe;wt=At-1}}for(var Nt=0,pe=C;Nt<L;++Nt){var Vt=T[Nt];pe=="L"&&Vt=="1"?T[Nt]="L":c.test(Vt)&&(pe=Vt)}for(var Bt=0;Bt<L;++Bt)if(a.test(T[Bt])){var Pt=void 0;for(Pt=Bt+1;Pt<L&&a.test(T[Pt]);++Pt);for(var Tt=(Bt?T[Bt-1]:C)=="L",ge=(Pt<L?T[Pt]:C)=="L",Nr=Tt==ge?Tt?"L":"R":C,Ai=Bt;Ai<Pt;++Ai)T[Ai]=Nr;Bt=Pt-1}for(var Jt=[],_e,Gt=0;Gt<L;)if(g.test(T[Gt])){var Dl=Gt;for(++Gt;Gt<L&&g.test(T[Gt]);++Gt);Jt.push(new y(0,Dl,Gt))}else{var ui=Gt,Qi=Jt.length,$i=k=="rtl"?1:0;for(++Gt;Gt<L&&T[Gt]!="L";++Gt);for(var ne=ui;ne<Gt;)if(m.test(T[ne])){ui<ne&&(Jt.splice(Qi,0,new y(1,ui,ne)),Qi+=$i);var Pr=ne;for(++ne;ne<Gt&&m.test(T[ne]);++ne);Jt.splice(Qi,0,new y(2,Pr,ne)),Qi+=$i,ui=ne}else++ne;ui<Gt&&Jt.splice(Qi,0,new y(1,ui,Gt))}return k=="ltr"&&(Jt[0].level==1&&(_e=w.match(/^\s+/))&&(Jt[0].from=_e[0].length,Jt.unshift(new y(0,0,_e[0].length))),dt(Jt).level==1&&(_e=w.match(/\s+$/))&&(dt(Jt).to-=_e[0].length,Jt.push(new y(0,L-_e[0].length,L)))),k=="rtl"?Jt.reverse():Jt}}();function si(e,r){var l=e.order;return l==null&&(l=e.order=Id(e.text,r)),l}var Za=[],Z=function(e,r,l){if(e.addEventListener)e.addEventListener(r,l,!1);else if(e.attachEvent)e.attachEvent("on"+r,l);else{var o=e._handlers||(e._handlers={});o[r]=(o[r]||Za).concat(l)}};function Mo(e,r){return e._handlers&&e._handlers[r]||Za}function Me(e,r,l){if(e.removeEventListener)e.removeEventListener(r,l,!1);else if(e.detachEvent)e.detachEvent("on"+r,l);else{var o=e._handlers,a=o&&o[r];if(a){var c=_t(a,l);c>-1&&(o[r]=a.slice(0,c).concat(a.slice(c+1)))}}}function Ot(e,r){var l=Mo(e,r);if(l.length)for(var o=Array.prototype.slice.call(arguments,2),a=0;a<l.length;++a)l[a].apply(null,o)}function Wt(e,r,l){return typeof r=="string"&&(r={type:r,preventDefault:function(){this.defaultPrevented=!0}}),Ot(e,l||r.type,e,r),Ao(r)||r.codemirrorIgnore}function Qa(e){var r=e._handlers&&e._handlers.cursorActivity;if(r)for(var l=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),o=0;o<r.length;++o)_t(l,r[o])==-1&&l.push(r[o])}function Pe(e,r){return Mo(e,r).length>0}function ur(e){e.prototype.on=function(r,l){Z(this,r,l)},e.prototype.off=function(r,l){Me(this,r,l)}}function fe(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function $a(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Ao(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function $r(e){fe(e),$a(e)}function To(e){return e.target||e.srcElement}function th(e){var r=e.which;return r==null&&(e.button&1?r=1:e.button&2?r=3:e.button&4&&(r=2)),V&&e.ctrlKey&&r==1&&(r=3),r}var Wd=function(){if(p&&v<9)return!1;var e=U("div");return"draggable"in e||"dragDrop"in e}(),Lo;function Fd(e){if(Lo==null){var r=U("span","​");lt(e,U("span",[r,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Lo=r.offsetWidth<=1&&r.offsetHeight>2&&!(p&&v<8))}var l=Lo?U("span","​"):U("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return l.setAttribute("cm-text",""),l}var Oo;function zd(e){if(Oo!=null)return Oo;var r=lt(e,document.createTextNode("AخA")),l=be(r,0,1).getBoundingClientRect(),o=be(r,1,2).getBoundingClientRect();return ct(e),!l||l.left==l.right?!1:Oo=o.right-l.right<3}var Do=`

b`.split(/\n/).length!=3?function(e){for(var r=0,l=[],o=e.length;r<=o;){var a=e.indexOf(`
`,r);a==-1&&(a=e.length);var c=e.slice(r,e.charAt(a-1)=="\r"?a-1:a),g=c.indexOf("\r");g!=-1?(l.push(c.slice(0,g)),r+=g+1):(l.push(c),r=a+1)}return l}:function(e){return e.split(/\r\n?|\n/)},Kd=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var r;try{r=e.ownerDocument.selection.createRange()}catch{}return!r||r.parentElement()!=e?!1:r.compareEndPoints("StartToEnd",r)!=0},Ud=function(){var e=U("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),No=null;function Gd(e){if(No!=null)return No;var r=lt(e,U("span","x")),l=r.getBoundingClientRect(),o=be(r,0,1).getBoundingClientRect();return No=Math.abs(l.left-o.left)>1}var Po={},cr={};function Vd(e,r){arguments.length>2&&(r.dependencies=Array.prototype.slice.call(arguments,2)),Po[e]=r}function qd(e,r){cr[e]=r}function es(e){if(typeof e=="string"&&cr.hasOwnProperty(e))e=cr[e];else if(e&&typeof e.name=="string"&&cr.hasOwnProperty(e.name)){var r=cr[e.name];typeof r=="string"&&(r={name:r}),e=_a(r,e),e.name=r.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return es("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return es("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function Eo(e,r){r=es(r);var l=Po[r.name];if(!l)return Eo(e,"text/plain");var o=l(e,r);if(dr.hasOwnProperty(r.name)){var a=dr[r.name];for(var c in a)a.hasOwnProperty(c)&&(o.hasOwnProperty(c)&&(o["_"+c]=o[c]),o[c]=a[c])}if(o.name=r.name,r.helperType&&(o.helperType=r.helperType),r.modeProps)for(var g in r.modeProps)o[g]=r.modeProps[g];return o}var dr={};function Yd(e,r){var l=dr.hasOwnProperty(e)?dr[e]:dr[e]={};zi(r,l)}function Ki(e,r){if(r===!0)return r;if(e.copyState)return e.copyState(r);var l={};for(var o in r){var a=r[o];a instanceof Array&&(a=a.concat([])),l[o]=a}return l}function Bo(e,r){for(var l;e.innerMode&&(l=e.innerMode(r),!(!l||l.mode==e));)r=l.state,e=l.mode;return l||{mode:e,state:r}}function eh(e,r,l){return e.startState?e.startState(r,l):!0}var Dt=function(e,r,l){this.pos=this.start=0,this.string=e,this.tabSize=r||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=l};Dt.prototype.eol=function(){return this.pos>=this.string.length},Dt.prototype.sol=function(){return this.pos==this.lineStart},Dt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Dt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Dt.prototype.eat=function(e){var r=this.string.charAt(this.pos),l;if(typeof e=="string"?l=r==e:l=r&&(e.test?e.test(r):e(r)),l)return++this.pos,r},Dt.prototype.eatWhile=function(e){for(var r=this.pos;this.eat(e););return this.pos>r},Dt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Dt.prototype.skipToEnd=function(){this.pos=this.string.length},Dt.prototype.skipTo=function(e){var r=this.string.indexOf(e,this.pos);if(r>-1)return this.pos=r,!0},Dt.prototype.backUp=function(e){this.pos-=e},Dt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ne(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ne(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.indentation=function(){return Ne(this.string,null,this.tabSize)-(this.lineStart?Ne(this.string,this.lineStart,this.tabSize):0)},Dt.prototype.match=function(e,r,l){if(typeof e=="string"){var o=function(g){return l?g.toLowerCase():g},a=this.string.substr(this.pos,e.length);if(o(a)==o(e))return r!==!1&&(this.pos+=e.length),!0}else{var c=this.string.slice(this.pos).match(e);return c&&c.index>0?null:(c&&r!==!1&&(this.pos+=c[0].length),c)}},Dt.prototype.current=function(){return this.string.slice(this.start,this.pos)},Dt.prototype.hideFirstChars=function(e,r){this.lineStart+=e;try{return r()}finally{this.lineStart-=e}},Dt.prototype.lookAhead=function(e){var r=this.lineOracle;return r&&r.lookAhead(e)},Dt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function q(e,r){if(r-=e.first,r<0||r>=e.size)throw new Error("There is no line "+(r+e.first)+" in the document.");for(var l=e;!l.lines;)for(var o=0;;++o){var a=l.children[o],c=a.chunkSize();if(r<c){l=a;break}r-=c}return l.lines[r]}function Ui(e,r,l){var o=[],a=r.line;return e.iter(r.line,l.line+1,function(c){var g=c.text;a==l.line&&(g=g.slice(0,l.ch)),a==r.line&&(g=g.slice(r.ch)),o.push(g),++a}),o}function Ro(e,r,l){var o=[];return e.iter(r,l,function(a){o.push(a.text)}),o}function Ve(e,r){var l=r-e.height;if(l)for(var o=e;o;o=o.parent)o.height+=l}function gt(e){if(e.parent==null)return null;for(var r=e.parent,l=_t(r.lines,e),o=r.parent;o;r=o,o=o.parent)for(var a=0;o.children[a]!=r;++a)l+=o.children[a].chunkSize();return l+r.first}function Gi(e,r){var l=e.first;t:do{for(var o=0;o<e.children.length;++o){var a=e.children[o],c=a.height;if(r<c){e=a;continue t}r-=c,l+=a.chunkSize()}return l}while(!e.lines);for(var g=0;g<e.lines.length;++g){var m=e.lines[g],y=m.height;if(r<y)break;r-=y}return l+g}function tn(e,r){return r>=e.first&&r<e.first+e.size}function Ho(e,r){return String(e.lineNumberFormatter(r+e.firstLineNumber))}function B(e,r,l){if(l===void 0&&(l=null),!(this instanceof B))return new B(e,r,l);this.line=e,this.ch=r,this.sticky=l}function $(e,r){return e.line-r.line||e.ch-r.ch}function Io(e,r){return e.sticky==r.sticky&&$(e,r)==0}function Wo(e){return B(e.line,e.ch)}function is(e,r){return $(e,r)<0?r:e}function rs(e,r){return $(e,r)<0?e:r}function ih(e,r){return Math.max(e.first,Math.min(r,e.first+e.size-1))}function tt(e,r){if(r.line<e.first)return B(e.first,0);var l=e.first+e.size-1;return r.line>l?B(l,q(e,l).text.length):Xd(r,q(e,r.line).text.length)}function Xd(e,r){var l=e.ch;return l==null||l>r?B(e.line,r):l<0?B(e.line,0):e}function rh(e,r){for(var l=[],o=0;o<r.length;o++)l[o]=tt(e,r[o]);return l}var ns=function(e,r){this.state=e,this.lookAhead=r},qe=function(e,r,l,o){this.state=r,this.doc=e,this.line=l,this.maxLookAhead=o||0,this.baseTokens=null,this.baseTokenPos=1};qe.prototype.lookAhead=function(e){var r=this.doc.getLine(this.line+e);return r!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),r},qe.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var r=this.baseTokens[this.baseTokenPos+1];return{type:r&&r.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},qe.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},qe.fromSaved=function(e,r,l){return r instanceof ns?new qe(e,Ki(e.mode,r.state),l,r.lookAhead):new qe(e,Ki(e.mode,r),l)},qe.prototype.save=function(e){var r=e!==!1?Ki(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ns(r,this.maxLookAhead):r};function nh(e,r,l,o){var a=[e.state.modeGen],c={};fh(e,r.text,e.doc.mode,l,function(w,k){return a.push(w,k)},c,o);for(var g=l.state,m=function(w){l.baseTokens=a;var k=e.state.overlays[w],C=1,L=0;l.state=!0,fh(e,r.text,k.mode,l,function(T,O){for(var E=C;L<T;){var R=a[C];R>T&&a.splice(C,1,T,a[C+1],R),C+=2,L=Math.min(T,R)}if(O)if(k.opaque)a.splice(E,C-E,T,"overlay "+O),C=E+2;else for(;E<C;E+=2){var H=a[E+1];a[E+1]=(H?H+" ":"")+"overlay "+O}},c),l.state=g,l.baseTokens=null,l.baseTokenPos=1},y=0;y<e.state.overlays.length;++y)m(y);return{styles:a,classes:c.bgClass||c.textClass?c:null}}function sh(e,r,l){if(!r.styles||r.styles[0]!=e.state.modeGen){var o=en(e,gt(r)),a=r.text.length>e.options.maxHighlightLength&&Ki(e.doc.mode,o.state),c=nh(e,r,o);a&&(o.state=a),r.stateAfter=o.save(!a),r.styles=c.styles,c.classes?r.styleClasses=c.classes:r.styleClasses&&(r.styleClasses=null),l===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return r.styles}function en(e,r,l){var o=e.doc,a=e.display;if(!o.mode.startState)return new qe(o,!0,r);var c=_d(e,r,l),g=c>o.first&&q(o,c-1).stateAfter,m=g?qe.fromSaved(o,g,c):new qe(o,eh(o.mode),c);return o.iter(c,r,function(y){Fo(e,y.text,m);var w=m.line;y.stateAfter=w==r-1||w%5==0||w>=a.viewFrom&&w<a.viewTo?m.save():null,m.nextLine()}),l&&(o.modeFrontier=m.line),m}function Fo(e,r,l,o){var a=e.doc.mode,c=new Dt(r,e.options.tabSize,l);for(c.start=c.pos=o||0,r==""&&oh(a,l.state);!c.eol();)zo(a,c,l.state),c.start=c.pos}function oh(e,r){if(e.blankLine)return e.blankLine(r);if(e.innerMode){var l=Bo(e,r);if(l.mode.blankLine)return l.mode.blankLine(l.state)}}function zo(e,r,l,o){for(var a=0;a<10;a++){o&&(o[0]=Bo(e,l).mode);var c=e.token(r,l);if(r.pos>r.start)return c}throw new Error("Mode "+e.name+" failed to advance stream.")}var lh=function(e,r,l){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=r||null,this.state=l};function ah(e,r,l,o){var a=e.doc,c=a.mode,g;r=tt(a,r);var m=q(a,r.line),y=en(e,r.line,l),w=new Dt(m.text,e.options.tabSize,y),k;for(o&&(k=[]);(o||w.pos<r.ch)&&!w.eol();)w.start=w.pos,g=zo(c,w,y.state),o&&k.push(new lh(w,g,Ki(a.mode,y.state)));return o?k:new lh(w,g,y.state)}function hh(e,r){if(e)for(;;){var l=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!l)break;e=e.slice(0,l.index)+e.slice(l.index+l[0].length);var o=l[1]?"bgClass":"textClass";r[o]==null?r[o]=l[2]:new RegExp("(?:^|\\s)"+l[2]+"(?:$|\\s)").test(r[o])||(r[o]+=" "+l[2])}return e}function fh(e,r,l,o,a,c,g){var m=l.flattenSpans;m==null&&(m=e.options.flattenSpans);var y=0,w=null,k=new Dt(r,e.options.tabSize,o),C,L=e.options.addModeClass&&[null];for(r==""&&hh(oh(l,o.state),c);!k.eol();){if(k.pos>e.options.maxHighlightLength?(m=!1,g&&Fo(e,r,o,k.pos),k.pos=r.length,C=null):C=hh(zo(l,k,o.state,L),c),L){var T=L[0].name;T&&(C="m-"+(C?T+" "+C:T))}if(!m||w!=C){for(;y<k.start;)y=Math.min(k.start,y+5e3),a(y,w);w=C}k.start=k.pos}for(;y<k.pos;){var O=Math.min(k.pos,y+5e3);a(O,w),y=O}}function _d(e,r,l){for(var o,a,c=e.doc,g=l?-1:r-(e.doc.mode.innerMode?1e3:100),m=r;m>g;--m){if(m<=c.first)return c.first;var y=q(c,m-1),w=y.stateAfter;if(w&&(!l||m+(w instanceof ns?w.lookAhead:0)<=c.modeFrontier))return m;var k=Ne(y.text,null,e.options.tabSize);(a==null||o>k)&&(a=m-1,o=k)}return a}function jd(e,r){if(e.modeFrontier=Math.min(e.modeFrontier,r),!(e.highlightFrontier<r-10)){for(var l=e.first,o=r-1;o>l;o--){var a=q(e,o).stateAfter;if(a&&(!(a instanceof ns)||o+a.lookAhead<r)){l=o+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,l)}}var uh=!1,oi=!1;function Jd(){uh=!0}function Zd(){oi=!0}function ss(e,r,l){this.marker=e,this.from=r,this.to=l}function rn(e,r){if(e)for(var l=0;l<e.length;++l){var o=e[l];if(o.marker==r)return o}}function Qd(e,r){for(var l,o=0;o<e.length;++o)e[o]!=r&&(l||(l=[])).push(e[o]);return l}function $d(e,r,l){var o=l&&window.WeakSet&&(l.markedSpans||(l.markedSpans=new WeakSet));o&&e.markedSpans&&o.has(e.markedSpans)?e.markedSpans.push(r):(e.markedSpans=e.markedSpans?e.markedSpans.concat([r]):[r],o&&o.add(e.markedSpans)),r.marker.attachLine(e)}function tp(e,r,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.from==null||(g.inclusiveLeft?c.from<=r:c.from<r);if(m||c.from==r&&g.type=="bookmark"&&(!l||!c.marker.insertLeft)){var y=c.to==null||(g.inclusiveRight?c.to>=r:c.to>r);(o||(o=[])).push(new ss(g,c.from,y?null:c.to))}}return o}function ep(e,r,l){var o;if(e)for(var a=0;a<e.length;++a){var c=e[a],g=c.marker,m=c.to==null||(g.inclusiveRight?c.to>=r:c.to>r);if(m||c.from==r&&g.type=="bookmark"&&(!l||c.marker.insertLeft)){var y=c.from==null||(g.inclusiveLeft?c.from<=r:c.from<r);(o||(o=[])).push(new ss(g,y?null:c.from-r,c.to==null?null:c.to-r))}}return o}function Ko(e,r){if(r.full)return null;var l=tn(e,r.from.line)&&q(e,r.from.line).markedSpans,o=tn(e,r.to.line)&&q(e,r.to.line).markedSpans;if(!l&&!o)return null;var a=r.from.ch,c=r.to.ch,g=$(r.from,r.to)==0,m=tp(l,a,g),y=ep(o,c,g),w=r.text.length==1,k=dt(r.text).length+(w?a:0);if(m)for(var C=0;C<m.length;++C){var L=m[C];if(L.to==null){var T=rn(y,L.marker);T?w&&(L.to=T.to==null?null:T.to+k):L.to=a}}if(y)for(var O=0;O<y.length;++O){var E=y[O];if(E.to!=null&&(E.to+=k),E.from==null){var R=rn(m,E.marker);R||(E.from=k,w&&(m||(m=[])).push(E))}else E.from+=k,w&&(m||(m=[])).push(E)}m&&(m=ch(m)),y&&y!=m&&(y=ch(y));var H=[m];if(!w){var F=r.text.length-2,I;if(F>0&&m)for(var K=0;K<m.length;++K)m[K].to==null&&(I||(I=[])).push(new ss(m[K].marker,null,null));for(var J=0;J<F;++J)H.push(I);H.push(y)}return H}function ch(e){for(var r=0;r<e.length;++r){var l=e[r];l.from!=null&&l.from==l.to&&l.marker.clearWhenEmpty!==!1&&e.splice(r--,1)}return e.length?e:null}function ip(e,r,l){var o=null;if(e.iter(r.line,l.line+1,function(T){if(T.markedSpans)for(var O=0;O<T.markedSpans.length;++O){var E=T.markedSpans[O].marker;E.readOnly&&(!o||_t(o,E)==-1)&&(o||(o=[])).push(E)}}),!o)return null;for(var a=[{from:r,to:l}],c=0;c<o.length;++c)for(var g=o[c],m=g.find(0),y=0;y<a.length;++y){var w=a[y];if(!($(w.to,m.from)<0||$(w.from,m.to)>0)){var k=[y,1],C=$(w.from,m.from),L=$(w.to,m.to);(C<0||!g.inclusiveLeft&&!C)&&k.push({from:w.from,to:m.from}),(L>0||!g.inclusiveRight&&!L)&&k.push({from:m.to,to:w.to}),a.splice.apply(a,k),y+=k.length-3}}return a}function dh(e){var r=e.markedSpans;if(r){for(var l=0;l<r.length;++l)r[l].marker.detachLine(e);e.markedSpans=null}}function ph(e,r){if(r){for(var l=0;l<r.length;++l)r[l].marker.attachLine(e);e.markedSpans=r}}function os(e){return e.inclusiveLeft?-1:0}function ls(e){return e.inclusiveRight?1:0}function Uo(e,r){var l=e.lines.length-r.lines.length;if(l!=0)return l;var o=e.find(),a=r.find(),c=$(o.from,a.from)||os(e)-os(r);if(c)return-c;var g=$(o.to,a.to)||ls(e)-ls(r);return g||r.id-e.id}function gh(e,r){var l=oi&&e.markedSpans,o;if(l)for(var a=void 0,c=0;c<l.length;++c)a=l[c],a.marker.collapsed&&(r?a.from:a.to)==null&&(!o||Uo(o,a.marker)<0)&&(o=a.marker);return o}function mh(e){return gh(e,!0)}function as(e){return gh(e,!1)}function rp(e,r){var l=oi&&e.markedSpans,o;if(l)for(var a=0;a<l.length;++a){var c=l[a];c.marker.collapsed&&(c.from==null||c.from<r)&&(c.to==null||c.to>r)&&(!o||Uo(o,c.marker)<0)&&(o=c.marker)}return o}function vh(e,r,l,o,a){var c=q(e,r),g=oi&&c.markedSpans;if(g)for(var m=0;m<g.length;++m){var y=g[m];if(y.marker.collapsed){var w=y.marker.find(0),k=$(w.from,l)||os(y.marker)-os(a),C=$(w.to,o)||ls(y.marker)-ls(a);if(!(k>=0&&C<=0||k<=0&&C>=0)&&(k<=0&&(y.marker.inclusiveRight&&a.inclusiveLeft?$(w.to,l)>=0:$(w.to,l)>0)||k>=0&&(y.marker.inclusiveRight&&a.inclusiveLeft?$(w.from,o)<=0:$(w.from,o)<0)))return!0}}}function Ie(e){for(var r;r=mh(e);)e=r.find(-1,!0).line;return e}function np(e){for(var r;r=as(e);)e=r.find(1,!0).line;return e}function sp(e){for(var r,l;r=as(e);)e=r.find(1,!0).line,(l||(l=[])).push(e);return l}function Go(e,r){var l=q(e,r),o=Ie(l);return l==o?r:gt(o)}function yh(e,r){if(r>e.lastLine())return r;var l=q(e,r),o;if(!yi(e,l))return r;for(;o=as(l);)l=o.find(1,!0).line;return gt(l)+1}function yi(e,r){var l=oi&&r.markedSpans;if(l){for(var o=void 0,a=0;a<l.length;++a)if(o=l[a],!!o.marker.collapsed){if(o.from==null)return!0;if(!o.marker.widgetNode&&o.from==0&&o.marker.inclusiveLeft&&Vo(e,r,o))return!0}}}function Vo(e,r,l){if(l.to==null){var o=l.marker.find(1,!0);return Vo(e,o.line,rn(o.line.markedSpans,l.marker))}if(l.marker.inclusiveRight&&l.to==r.text.length)return!0;for(var a=void 0,c=0;c<r.markedSpans.length;++c)if(a=r.markedSpans[c],a.marker.collapsed&&!a.marker.widgetNode&&a.from==l.to&&(a.to==null||a.to!=l.from)&&(a.marker.inclusiveLeft||l.marker.inclusiveRight)&&Vo(e,r,a))return!0}function li(e){e=Ie(e);for(var r=0,l=e.parent,o=0;o<l.lines.length;++o){var a=l.lines[o];if(a==e)break;r+=a.height}for(var c=l.parent;c;l=c,c=l.parent)for(var g=0;g<c.children.length;++g){var m=c.children[g];if(m==l)break;r+=m.height}return r}function hs(e){if(e.height==0)return 0;for(var r=e.text.length,l,o=e;l=mh(o);){var a=l.find(0,!0);o=a.from.line,r+=a.from.ch-a.to.ch}for(o=e;l=as(o);){var c=l.find(0,!0);r-=o.text.length-c.from.ch,o=c.to.line,r+=o.text.length-c.to.ch}return r}function qo(e){var r=e.display,l=e.doc;r.maxLine=q(l,l.first),r.maxLineLength=hs(r.maxLine),r.maxLineChanged=!0,l.iter(function(o){var a=hs(o);a>r.maxLineLength&&(r.maxLineLength=a,r.maxLine=o)})}var pr=function(e,r,l){this.text=e,ph(this,r),this.height=l?l(this):1};pr.prototype.lineNo=function(){return gt(this)},ur(pr);function op(e,r,l,o){e.text=r,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),dh(e),ph(e,l);var a=o?o(e):1;a!=e.height&&Ve(e,a)}function lp(e){e.parent=null,dh(e)}var ap={},hp={};function bh(e,r){if(!e||/^\s*$/.test(e))return null;var l=r.addModeClass?hp:ap;return l[e]||(l[e]=e.replace(/\S+/g,"cm-$&"))}function wh(e,r){var l=ye("span",null,null,b?"padding-right: .1px":null),o={pre:ye("pre",[l],"CodeMirror-line"),content:l,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};r.measure={};for(var a=0;a<=(r.rest?r.rest.length:0);a++){var c=a?r.rest[a-1]:r.line,g=void 0;o.pos=0,o.addToken=up,zd(e.display.measure)&&(g=si(c,e.doc.direction))&&(o.addToken=dp(o.addToken,g)),o.map=[];var m=r!=e.display.externalMeasured&&gt(c);pp(c,o,sh(e,c,m)),c.styleClasses&&(c.styleClasses.bgClass&&(o.bgClass=ee(c.styleClasses.bgClass,o.bgClass||"")),c.styleClasses.textClass&&(o.textClass=ee(c.styleClasses.textClass,o.textClass||""))),o.map.length==0&&o.map.push(0,0,o.content.appendChild(Fd(e.display.measure))),a==0?(r.measure.map=o.map,r.measure.cache={}):((r.measure.maps||(r.measure.maps=[])).push(o.map),(r.measure.caches||(r.measure.caches=[])).push({}))}if(b){var y=o.content.lastChild;(/\bcm-tab\b/.test(y.className)||y.querySelector&&y.querySelector(".cm-tab"))&&(o.content.className="cm-tab-wrap-hack")}return Ot(e,"renderLine",e,r.line,o.pre),o.pre.className&&(o.textClass=ee(o.pre.className,o.textClass||"")),o}function fp(e){var r=U("span","•","cm-invalidchar");return r.title="\\u"+e.charCodeAt(0).toString(16),r.setAttribute("aria-label",r.title),r}function up(e,r,l,o,a,c,g){if(r){var m=e.splitSpaces?cp(r,e.trailingSpace):r,y=e.cm.state.specialChars,w=!1,k;if(!y.test(r))e.col+=r.length,k=document.createTextNode(m),e.map.push(e.pos,e.pos+r.length,k),p&&v<9&&(w=!0),e.pos+=r.length;else{k=document.createDocumentFragment();for(var C=0;;){y.lastIndex=C;var L=y.exec(r),T=L?L.index-C:r.length-C;if(T){var O=document.createTextNode(m.slice(C,C+T));p&&v<9?k.appendChild(U("span",[O])):k.appendChild(O),e.map.push(e.pos,e.pos+T,O),e.col+=T,e.pos+=T}if(!L)break;C+=T+1;var E=void 0;if(L[0]=="	"){var R=e.cm.options.tabSize,H=R-e.col%R;E=k.appendChild(U("span",So(H),"cm-tab")),E.setAttribute("role","presentation"),E.setAttribute("cm-text","	"),e.col+=H}else L[0]=="\r"||L[0]==`
`?(E=k.appendChild(U("span",L[0]=="\r"?"␍":"␤","cm-invalidchar")),E.setAttribute("cm-text",L[0]),e.col+=1):(E=e.cm.options.specialCharPlaceholder(L[0]),E.setAttribute("cm-text",L[0]),p&&v<9?k.appendChild(U("span",[E])):k.appendChild(E),e.col+=1);e.map.push(e.pos,e.pos+1,E),e.pos++}}if(e.trailingSpace=m.charCodeAt(r.length-1)==32,l||o||a||w||c||g){var F=l||"";o&&(F+=o),a&&(F+=a);var I=U("span",[k],F,c);if(g)for(var K in g)g.hasOwnProperty(K)&&K!="style"&&K!="class"&&I.setAttribute(K,g[K]);return e.content.appendChild(I)}e.content.appendChild(k)}}function cp(e,r){if(e.length>1&&!/  /.test(e))return e;for(var l=r,o="",a=0;a<e.length;a++){var c=e.charAt(a);c==" "&&l&&(a==e.length-1||e.charCodeAt(a+1)==32)&&(c=" "),o+=c,l=c==" "}return o}function dp(e,r){return function(l,o,a,c,g,m,y){a=a?a+" cm-force-border":"cm-force-border";for(var w=l.pos,k=w+o.length;;){for(var C=void 0,L=0;L<r.length&&(C=r[L],!(C.to>w&&C.from<=w));L++);if(C.to>=k)return e(l,o,a,c,g,m,y);e(l,o.slice(0,C.to-w),a,c,null,m,y),c=null,o=o.slice(C.to-w),w=C.to}}}function xh(e,r,l,o){var a=!o&&l.widgetNode;a&&e.map.push(e.pos,e.pos+r,a),!o&&e.cm.display.input.needsContentAttribute&&(a||(a=e.content.appendChild(document.createElement("span"))),a.setAttribute("cm-marker",l.id)),a&&(e.cm.display.input.setUneditable(a),e.content.appendChild(a)),e.pos+=r,e.trailingSpace=!1}function pp(e,r,l){var o=e.markedSpans,a=e.text,c=0;if(!o){for(var g=1;g<l.length;g+=2)r.addToken(r,a.slice(c,c=l[g]),bh(l[g+1],r.cm.options));return}for(var m=a.length,y=0,w=1,k="",C,L,T=0,O,E,R,H,F;;){if(T==y){O=E=R=L="",F=null,H=null,T=1/0;for(var I=[],K=void 0,J=0;J<o.length;++J){var X=o[J],rt=X.marker;if(rt.type=="bookmark"&&X.from==y&&rt.widgetNode)I.push(rt);else if(X.from<=y&&(X.to==null||X.to>y||rt.collapsed&&X.to==y&&X.from==y)){if(X.to!=null&&X.to!=y&&T>X.to&&(T=X.to,E=""),rt.className&&(O+=" "+rt.className),rt.css&&(L=(L?L+";":"")+rt.css),rt.startStyle&&X.from==y&&(R+=" "+rt.startStyle),rt.endStyle&&X.to==T&&(K||(K=[])).push(rt.endStyle,X.to),rt.title&&((F||(F={})).title=rt.title),rt.attributes)for(var wt in rt.attributes)(F||(F={}))[wt]=rt.attributes[wt];rt.collapsed&&(!H||Uo(H.marker,rt)<0)&&(H=X)}else X.from>y&&T>X.from&&(T=X.from)}if(K)for(var Ut=0;Ut<K.length;Ut+=2)K[Ut+1]==T&&(E+=" "+K[Ut]);if(!H||H.from==y)for(var At=0;At<I.length;++At)xh(r,0,I[At]);if(H&&(H.from||0)==y){if(xh(r,(H.to==null?m+1:H.to)-y,H.marker,H.from==null),H.to==null)return;H.to==y&&(H=!1)}}if(y>=m)break;for(var xe=Math.min(m,T);;){if(k){var de=y+k.length;if(!H){var Nt=de>xe?k.slice(0,xe-y):k;r.addToken(r,Nt,C?C+O:O,R,y+Nt.length==T?E:"",L,F)}if(de>=xe){k=k.slice(xe-y),y=xe;break}y=de,R=""}k=a.slice(c,c=l[w++]),C=bh(l[w++],r.cm.options)}}}function Sh(e,r,l){this.line=r,this.rest=sp(r),this.size=this.rest?gt(dt(this.rest))-l+1:1,this.node=this.text=null,this.hidden=yi(e,r)}function fs(e,r,l){for(var o=[],a,c=r;c<l;c=a){var g=new Sh(e.doc,q(e.doc,c),c);a=c+g.size,o.push(g)}return o}var gr=null;function gp(e){gr?gr.ops.push(e):e.ownsGroup=gr={ops:[e],delayedCallbacks:[]}}function mp(e){var r=e.delayedCallbacks,l=0;do{for(;l<r.length;l++)r[l].call(null);for(var o=0;o<e.ops.length;o++){var a=e.ops[o];if(a.cursorActivityHandlers)for(;a.cursorActivityCalled<a.cursorActivityHandlers.length;)a.cursorActivityHandlers[a.cursorActivityCalled++].call(null,a.cm)}}while(l<r.length)}function vp(e,r){var l=e.ownsGroup;if(l)try{mp(l)}finally{gr=null,r(l)}}var nn=null;function Ft(e,r){var l=Mo(e,r);if(l.length){var o=Array.prototype.slice.call(arguments,2),a;gr?a=gr.delayedCallbacks:nn?a=nn:(a=nn=[],setTimeout(yp,0));for(var c=function(m){a.push(function(){return l[m].apply(null,o)})},g=0;g<l.length;++g)c(g)}}function yp(){var e=nn;nn=null;for(var r=0;r<e.length;++r)e[r]()}function kh(e,r,l,o){for(var a=0;a<r.changes.length;a++){var c=r.changes[a];c=="text"?wp(e,r):c=="gutter"?Mh(e,r,l,o):c=="class"?Yo(e,r):c=="widget"&&xp(e,r,o)}r.changes=null}function sn(e){return e.node==e.text&&(e.node=U("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),p&&v<8&&(e.node.style.zIndex=2)),e.node}function bp(e,r){var l=r.bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass;if(l&&(l+=" CodeMirror-linebackground"),r.background)l?r.background.className=l:(r.background.parentNode.removeChild(r.background),r.background=null);else if(l){var o=sn(r);r.background=o.insertBefore(U("div",null,l),o.firstChild),e.display.input.setUneditable(r.background)}}function Ch(e,r){var l=e.display.externalMeasured;return l&&l.line==r.line?(e.display.externalMeasured=null,r.measure=l.measure,l.built):wh(e,r)}function wp(e,r){var l=r.text.className,o=Ch(e,r);r.text==r.node&&(r.node=o.pre),r.text.parentNode.replaceChild(o.pre,r.text),r.text=o.pre,o.bgClass!=r.bgClass||o.textClass!=r.textClass?(r.bgClass=o.bgClass,r.textClass=o.textClass,Yo(e,r)):l&&(r.text.className=l)}function Yo(e,r){bp(e,r),r.line.wrapClass?sn(r).className=r.line.wrapClass:r.node!=r.text&&(r.node.className="");var l=r.textClass?r.textClass+" "+(r.line.textClass||""):r.line.textClass;r.text.className=l||""}function Mh(e,r,l,o){if(r.gutter&&(r.node.removeChild(r.gutter),r.gutter=null),r.gutterBackground&&(r.node.removeChild(r.gutterBackground),r.gutterBackground=null),r.line.gutterClass){var a=sn(r);r.gutterBackground=U("div",null,"CodeMirror-gutter-background "+r.line.gutterClass,"left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px; width: "+o.gutterTotalWidth+"px"),e.display.input.setUneditable(r.gutterBackground),a.insertBefore(r.gutterBackground,r.text)}var c=r.line.gutterMarkers;if(e.options.lineNumbers||c){var g=sn(r),m=r.gutter=U("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth)+"px");if(m.setAttribute("aria-hidden","true"),e.display.input.setUneditable(m),g.insertBefore(m,r.text),r.line.gutterClass&&(m.className+=" "+r.line.gutterClass),e.options.lineNumbers&&(!c||!c["CodeMirror-linenumbers"])&&(r.lineNumber=m.appendChild(U("div",Ho(e.options,l),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+o.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),c)for(var y=0;y<e.display.gutterSpecs.length;++y){var w=e.display.gutterSpecs[y].className,k=c.hasOwnProperty(w)&&c[w];k&&m.appendChild(U("div",[k],"CodeMirror-gutter-elt","left: "+o.gutterLeft[w]+"px; width: "+o.gutterWidth[w]+"px"))}}}function xp(e,r,l){r.alignable&&(r.alignable=null);for(var o=nt("CodeMirror-linewidget"),a=r.node.firstChild,c=void 0;a;a=c)c=a.nextSibling,o.test(a.className)&&r.node.removeChild(a);Ah(e,r,l)}function Sp(e,r,l,o){var a=Ch(e,r);return r.text=r.node=a.pre,a.bgClass&&(r.bgClass=a.bgClass),a.textClass&&(r.textClass=a.textClass),Yo(e,r),Mh(e,r,l,o),Ah(e,r,o),r.node}function Ah(e,r,l){if(Th(e,r.line,r,l,!0),r.rest)for(var o=0;o<r.rest.length;o++)Th(e,r.rest[o],r,l,!1)}function Th(e,r,l,o,a){if(r.widgets)for(var c=sn(l),g=0,m=r.widgets;g<m.length;++g){var y=m[g],w=U("div",[y.node],"CodeMirror-linewidget"+(y.className?" "+y.className:""));y.handleMouseEvents||w.setAttribute("cm-ignore-events","true"),kp(y,w,l,o),e.display.input.setUneditable(w),a&&y.above?c.insertBefore(w,l.gutter||l.text):c.appendChild(w),Ft(y,"redraw")}}function kp(e,r,l,o){if(e.noHScroll){(l.alignable||(l.alignable=[])).push(r);var a=o.wrapperWidth;r.style.left=o.fixedPos+"px",e.coverGutter||(a-=o.gutterTotalWidth,r.style.paddingLeft=o.gutterTotalWidth+"px"),r.style.width=a+"px"}e.coverGutter&&(r.style.zIndex=5,r.style.position="relative",e.noHScroll||(r.style.marginLeft=-o.gutterTotalWidth+"px"))}function on(e){if(e.height!=null)return e.height;var r=e.doc.cm;if(!r)return 0;if(!te(document.body,e.node)){var l="position: relative;";e.coverGutter&&(l+="margin-left: -"+r.display.gutters.offsetWidth+"px;"),e.noHScroll&&(l+="width: "+r.display.wrapper.clientWidth+"px;"),lt(r.display.measure,U("div",[e.node],null,l))}return e.height=e.node.parentNode.offsetHeight}function ai(e,r){for(var l=To(r);l!=e.wrapper;l=l.parentNode)if(!l||l.nodeType==1&&l.getAttribute("cm-ignore-events")=="true"||l.parentNode==e.sizer&&l!=e.mover)return!0}function us(e){return e.lineSpace.offsetTop}function Xo(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Lh(e){if(e.cachedPaddingH)return e.cachedPaddingH;var r=lt(e.measure,U("pre","x","CodeMirror-line-like")),l=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,o={left:parseInt(l.paddingLeft),right:parseInt(l.paddingRight)};return!isNaN(o.left)&&!isNaN(o.right)&&(e.cachedPaddingH=o),o}function Ye(e){return Ya-e.display.nativeBarWidth}function Vi(e){return e.display.scroller.clientWidth-Ye(e)-e.display.barWidth}function _o(e){return e.display.scroller.clientHeight-Ye(e)-e.display.barHeight}function Cp(e,r,l){var o=e.options.lineWrapping,a=o&&Vi(e);if(!r.measure.heights||o&&r.measure.width!=a){var c=r.measure.heights=[];if(o){r.measure.width=a;for(var g=r.text.firstChild.getClientRects(),m=0;m<g.length-1;m++){var y=g[m],w=g[m+1];Math.abs(y.bottom-w.bottom)>2&&c.push((y.bottom+w.top)/2-l.top)}}c.push(l.bottom-l.top)}}function Oh(e,r,l){if(e.line==r)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var o=0;o<e.rest.length;o++)if(e.rest[o]==r)return{map:e.measure.maps[o],cache:e.measure.caches[o]};for(var a=0;a<e.rest.length;a++)if(gt(e.rest[a])>l)return{map:e.measure.maps[a],cache:e.measure.caches[a],before:!0}}}function Mp(e,r){r=Ie(r);var l=gt(r),o=e.display.externalMeasured=new Sh(e.doc,r,l);o.lineN=l;var a=o.built=wh(e,o);return o.text=a.pre,lt(e.display.lineMeasure,a.pre),o}function Dh(e,r,l,o){return Xe(e,mr(e,r),l,o)}function jo(e,r){if(r>=e.display.viewFrom&&r<e.display.viewTo)return e.display.view[Xi(e,r)];var l=e.display.externalMeasured;if(l&&r>=l.lineN&&r<l.lineN+l.size)return l}function mr(e,r){var l=gt(r),o=jo(e,l);o&&!o.text?o=null:o&&o.changes&&(kh(e,o,l,tl(e)),e.curOp.forceUpdate=!0),o||(o=Mp(e,r));var a=Oh(o,r,l);return{line:r,view:o,rect:null,map:a.map,cache:a.cache,before:a.before,hasHeights:!1}}function Xe(e,r,l,o,a){r.before&&(l=-1);var c=l+(o||""),g;return r.cache.hasOwnProperty(c)?g=r.cache[c]:(r.rect||(r.rect=r.view.text.getBoundingClientRect()),r.hasHeights||(Cp(e,r.view,r.rect),r.hasHeights=!0),g=Tp(e,r,l,o),g.bogus||(r.cache[c]=g)),{left:g.left,right:g.right,top:a?g.rtop:g.top,bottom:a?g.rbottom:g.bottom}}var Nh={left:0,right:0,top:0,bottom:0};function Ph(e,r,l){for(var o,a,c,g,m,y,w=0;w<e.length;w+=3)if(m=e[w],y=e[w+1],r<m?(a=0,c=1,g="left"):r<y?(a=r-m,c=a+1):(w==e.length-3||r==y&&e[w+3]>r)&&(c=y-m,a=c-1,r>=y&&(g="right")),a!=null){if(o=e[w+2],m==y&&l==(o.insertLeft?"left":"right")&&(g=l),l=="left"&&a==0)for(;w&&e[w-2]==e[w-3]&&e[w-1].insertLeft;)o=e[(w-=3)+2],g="left";if(l=="right"&&a==y-m)for(;w<e.length-3&&e[w+3]==e[w+4]&&!e[w+5].insertLeft;)o=e[(w+=3)+2],g="right";break}return{node:o,start:a,end:c,collapse:g,coverStart:m,coverEnd:y}}function Ap(e,r){var l=Nh;if(r=="left")for(var o=0;o<e.length&&(l=e[o]).left==l.right;o++);else for(var a=e.length-1;a>=0&&(l=e[a]).left==l.right;a--);return l}function Tp(e,r,l,o){var a=Ph(r.map,l,o),c=a.node,g=a.start,m=a.end,y=a.collapse,w;if(c.nodeType==3){for(var k=0;k<4;k++){for(;g&&Co(r.line.text.charAt(a.coverStart+g));)--g;for(;a.coverStart+m<a.coverEnd&&Co(r.line.text.charAt(a.coverStart+m));)++m;if(p&&v<9&&g==0&&m==a.coverEnd-a.coverStart?w=c.parentNode.getBoundingClientRect():w=Ap(be(c,g,m).getClientRects(),o),w.left||w.right||g==0)break;m=g,g=g-1,y="right"}p&&v<11&&(w=Lp(e.display.measure,w))}else{g>0&&(y=o="right");var C;e.options.lineWrapping&&(C=c.getClientRects()).length>1?w=C[o=="right"?C.length-1:0]:w=c.getBoundingClientRect()}if(p&&v<9&&!g&&(!w||!w.left&&!w.right)){var L=c.parentNode.getClientRects()[0];L?w={left:L.left,right:L.left+yr(e.display),top:L.top,bottom:L.bottom}:w=Nh}for(var T=w.top-r.rect.top,O=w.bottom-r.rect.top,E=(T+O)/2,R=r.view.measure.heights,H=0;H<R.length-1&&!(E<R[H]);H++);var F=H?R[H-1]:0,I=R[H],K={left:(y=="right"?w.right:w.left)-r.rect.left,right:(y=="left"?w.left:w.right)-r.rect.left,top:F,bottom:I};return!w.left&&!w.right&&(K.bogus=!0),e.options.singleCursorHeightPerLine||(K.rtop=T,K.rbottom=O),K}function Lp(e,r){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Gd(e))return r;var l=screen.logicalXDPI/screen.deviceXDPI,o=screen.logicalYDPI/screen.deviceYDPI;return{left:r.left*l,right:r.right*l,top:r.top*o,bottom:r.bottom*o}}function Eh(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var r=0;r<e.rest.length;r++)e.measure.caches[r]={}}function Bh(e){e.display.externalMeasure=null,ct(e.display.lineMeasure);for(var r=0;r<e.display.view.length;r++)Eh(e.display.view[r])}function ln(e){Bh(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Rh(e){return S&&_?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function Hh(e){return S&&_?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function Jo(e){var r=Ie(e),l=r.widgets,o=0;if(l)for(var a=0;a<l.length;++a)l[a].above&&(o+=on(l[a]));return o}function cs(e,r,l,o,a){if(!a){var c=Jo(r);l.top+=c,l.bottom+=c}if(o=="line")return l;o||(o="local");var g=li(r);if(o=="local"?g+=us(e.display):g-=e.display.viewOffset,o=="page"||o=="window"){var m=e.display.lineSpace.getBoundingClientRect();g+=m.top+(o=="window"?0:Hh(ke(e)));var y=m.left+(o=="window"?0:Rh(ke(e)));l.left+=y,l.right+=y}return l.top+=g,l.bottom+=g,l}function Ih(e,r,l){if(l=="div")return r;var o=r.left,a=r.top;if(l=="page")o-=Rh(ke(e)),a-=Hh(ke(e));else if(l=="local"||!l){var c=e.display.sizer.getBoundingClientRect();o+=c.left,a+=c.top}var g=e.display.lineSpace.getBoundingClientRect();return{left:o-g.left,top:a-g.top}}function ds(e,r,l,o,a){return o||(o=q(e.doc,r.line)),cs(e,o,Dh(e,o,r.ch,a),l)}function We(e,r,l,o,a,c){o=o||q(e.doc,r.line),a||(a=mr(e,o));function g(O,E){var R=Xe(e,a,O,E?"right":"left",c);return E?R.left=R.right:R.right=R.left,cs(e,o,R,l)}var m=si(o,e.doc.direction),y=r.ch,w=r.sticky;if(y>=o.text.length?(y=o.text.length,w="before"):y<=0&&(y=0,w="after"),!m)return g(w=="before"?y-1:y,w=="before");function k(O,E,R){var H=m[E],F=H.level==1;return g(R?O-1:O,F!=R)}var C=Qr(m,y,w),L=Zr,T=k(y,C,w=="before");return L!=null&&(T.other=k(y,L,w!="before")),T}function Wh(e,r){var l=0;r=tt(e.doc,r),e.options.lineWrapping||(l=yr(e.display)*r.ch);var o=q(e.doc,r.line),a=li(o)+us(e.display);return{left:l,right:l,top:a,bottom:a+o.height}}function Zo(e,r,l,o,a){var c=B(e,r,l);return c.xRel=a,o&&(c.outside=o),c}function Qo(e,r,l){var o=e.doc;if(l+=e.display.viewOffset,l<0)return Zo(o.first,0,null,-1,-1);var a=Gi(o,l),c=o.first+o.size-1;if(a>c)return Zo(o.first+o.size-1,q(o,c).text.length,null,1,1);r<0&&(r=0);for(var g=q(o,a);;){var m=Op(e,g,a,r,l),y=rp(g,m.ch+(m.xRel>0||m.outside>0?1:0));if(!y)return m;var w=y.find(1);if(w.line==a)return w;g=q(o,a=w.line)}}function Fh(e,r,l,o){o-=Jo(r);var a=r.text.length,c=Jr(function(g){return Xe(e,l,g-1).bottom<=o},a,0);return a=Jr(function(g){return Xe(e,l,g).top>o},c,a),{begin:c,end:a}}function zh(e,r,l,o){l||(l=mr(e,r));var a=cs(e,r,Xe(e,l,o),"line").top;return Fh(e,r,l,a)}function $o(e,r,l,o){return e.bottom<=l?!1:e.top>l?!0:(o?e.left:e.right)>r}function Op(e,r,l,o,a){a-=li(r);var c=mr(e,r),g=Jo(r),m=0,y=r.text.length,w=!0,k=si(r,e.doc.direction);if(k){var C=(e.options.lineWrapping?Np:Dp)(e,r,l,c,k,o,a);w=C.level!=1,m=w?C.from:C.to-1,y=w?C.to:C.from-1}var L=null,T=null,O=Jr(function(J){var X=Xe(e,c,J);return X.top+=g,X.bottom+=g,$o(X,o,a,!1)?(X.top<=a&&X.left<=o&&(L=J,T=X),!0):!1},m,y),E,R,H=!1;if(T){var F=o-T.left<T.right-o,I=F==w;O=L+(I?0:1),R=I?"after":"before",E=F?T.left:T.right}else{!w&&(O==y||O==m)&&O++,R=O==0?"after":O==r.text.length?"before":Xe(e,c,O-(w?1:0)).bottom+g<=a==w?"after":"before";var K=We(e,B(l,O,R),"line",r,c);E=K.left,H=a<K.top?-1:a>=K.bottom?1:0}return O=Ja(r.text,O,1),Zo(l,O,R,H,o-E)}function Dp(e,r,l,o,a,c,g){var m=Jr(function(C){var L=a[C],T=L.level!=1;return $o(We(e,B(l,T?L.to:L.from,T?"before":"after"),"line",r,o),c,g,!0)},0,a.length-1),y=a[m];if(m>0){var w=y.level!=1,k=We(e,B(l,w?y.from:y.to,w?"after":"before"),"line",r,o);$o(k,c,g,!0)&&k.top>g&&(y=a[m-1])}return y}function Np(e,r,l,o,a,c,g){var m=Fh(e,r,o,g),y=m.begin,w=m.end;/\s/.test(r.text.charAt(w-1))&&w--;for(var k=null,C=null,L=0;L<a.length;L++){var T=a[L];if(!(T.from>=w||T.to<=y)){var O=T.level!=1,E=Xe(e,o,O?Math.min(w,T.to)-1:Math.max(y,T.from)).right,R=E<c?c-E+1e9:E-c;(!k||C>R)&&(k=T,C=R)}}return k||(k=a[a.length-1]),k.from<y&&(k={from:y,to:k.to,level:k.level}),k.to>w&&(k={from:k.from,to:w,level:k.level}),k}var qi;function vr(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(qi==null){qi=U("pre",null,"CodeMirror-line-like");for(var r=0;r<49;++r)qi.appendChild(document.createTextNode("x")),qi.appendChild(U("br"));qi.appendChild(document.createTextNode("x"))}lt(e.measure,qi);var l=qi.offsetHeight/50;return l>3&&(e.cachedTextHeight=l),ct(e.measure),l||1}function yr(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var r=U("span","xxxxxxxxxx"),l=U("pre",[r],"CodeMirror-line-like");lt(e.measure,l);var o=r.getBoundingClientRect(),a=(o.right-o.left)/10;return a>2&&(e.cachedCharWidth=a),a||10}function tl(e){for(var r=e.display,l={},o={},a=r.gutters.clientLeft,c=r.gutters.firstChild,g=0;c;c=c.nextSibling,++g){var m=e.display.gutterSpecs[g].className;l[m]=c.offsetLeft+c.clientLeft+a,o[m]=c.clientWidth}return{fixedPos:el(r),gutterTotalWidth:r.gutters.offsetWidth,gutterLeft:l,gutterWidth:o,wrapperWidth:r.wrapper.clientWidth}}function el(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Kh(e){var r=vr(e.display),l=e.options.lineWrapping,o=l&&Math.max(5,e.display.scroller.clientWidth/yr(e.display)-3);return function(a){if(yi(e.doc,a))return 0;var c=0;if(a.widgets)for(var g=0;g<a.widgets.length;g++)a.widgets[g].height&&(c+=a.widgets[g].height);return l?c+(Math.ceil(a.text.length/o)||1)*r:c+r}}function il(e){var r=e.doc,l=Kh(e);r.iter(function(o){var a=l(o);a!=o.height&&Ve(o,a)})}function Yi(e,r,l,o){var a=e.display;if(!l&&To(r).getAttribute("cm-not-content")=="true")return null;var c,g,m=a.lineSpace.getBoundingClientRect();try{c=r.clientX-m.left,g=r.clientY-m.top}catch{return null}var y=Qo(e,c,g),w;if(o&&y.xRel>0&&(w=q(e.doc,y.line).text).length==y.ch){var k=Ne(w,w.length,e.options.tabSize)-w.length;y=B(y.line,Math.max(0,Math.round((c-Lh(e.display).left)/yr(e.display))-k))}return y}function Xi(e,r){if(r>=e.display.viewTo||(r-=e.display.viewFrom,r<0))return null;for(var l=e.display.view,o=0;o<l.length;o++)if(r-=l[o].size,r<0)return o}function ue(e,r,l,o){r==null&&(r=e.doc.first),l==null&&(l=e.doc.first+e.doc.size),o||(o=0);var a=e.display;if(o&&l<a.viewTo&&(a.updateLineNumbers==null||a.updateLineNumbers>r)&&(a.updateLineNumbers=r),e.curOp.viewChanged=!0,r>=a.viewTo)oi&&Go(e.doc,r)<a.viewTo&&wi(e);else if(l<=a.viewFrom)oi&&yh(e.doc,l+o)>a.viewFrom?wi(e):(a.viewFrom+=o,a.viewTo+=o);else if(r<=a.viewFrom&&l>=a.viewTo)wi(e);else if(r<=a.viewFrom){var c=ps(e,l,l+o,1);c?(a.view=a.view.slice(c.index),a.viewFrom=c.lineN,a.viewTo+=o):wi(e)}else if(l>=a.viewTo){var g=ps(e,r,r,-1);g?(a.view=a.view.slice(0,g.index),a.viewTo=g.lineN):wi(e)}else{var m=ps(e,r,r,-1),y=ps(e,l,l+o,1);m&&y?(a.view=a.view.slice(0,m.index).concat(fs(e,m.lineN,y.lineN)).concat(a.view.slice(y.index)),a.viewTo+=o):wi(e)}var w=a.externalMeasured;w&&(l<w.lineN?w.lineN+=o:r<w.lineN+w.size&&(a.externalMeasured=null))}function bi(e,r,l){e.curOp.viewChanged=!0;var o=e.display,a=e.display.externalMeasured;if(a&&r>=a.lineN&&r<a.lineN+a.size&&(o.externalMeasured=null),!(r<o.viewFrom||r>=o.viewTo)){var c=o.view[Xi(e,r)];if(c.node!=null){var g=c.changes||(c.changes=[]);_t(g,l)==-1&&g.push(l)}}}function wi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function ps(e,r,l,o){var a=Xi(e,r),c,g=e.display.view;if(!oi||l==e.doc.first+e.doc.size)return{index:a,lineN:l};for(var m=e.display.viewFrom,y=0;y<a;y++)m+=g[y].size;if(m!=r){if(o>0){if(a==g.length-1)return null;c=m+g[a].size-r,a++}else c=m-r;r+=c,l+=c}for(;Go(e.doc,l)!=l;){if(a==(o<0?0:g.length-1))return null;l+=o*g[a-(o<0?1:0)].size,a+=o}return{index:a,lineN:l}}function Pp(e,r,l){var o=e.display,a=o.view;a.length==0||r>=o.viewTo||l<=o.viewFrom?(o.view=fs(e,r,l),o.viewFrom=r):(o.viewFrom>r?o.view=fs(e,r,o.viewFrom).concat(o.view):o.viewFrom<r&&(o.view=o.view.slice(Xi(e,r))),o.viewFrom=r,o.viewTo<l?o.view=o.view.concat(fs(e,o.viewTo,l)):o.viewTo>l&&(o.view=o.view.slice(0,Xi(e,l)))),o.viewTo=l}function Uh(e){for(var r=e.display.view,l=0,o=0;o<r.length;o++){var a=r[o];!a.hidden&&(!a.node||a.changes)&&++l}return l}function an(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Gh(e,r){r===void 0&&(r=!0);var l=e.doc,o={},a=o.cursors=document.createDocumentFragment(),c=o.selection=document.createDocumentFragment(),g=e.options.$customCursor;g&&(r=!0);for(var m=0;m<l.sel.ranges.length;m++)if(!(!r&&m==l.sel.primIndex)){var y=l.sel.ranges[m];if(!(y.from().line>=e.display.viewTo||y.to().line<e.display.viewFrom)){var w=y.empty();if(g){var k=g(e,y);k&&rl(e,k,a)}else(w||e.options.showCursorWhenSelecting)&&rl(e,y.head,a);w||Ep(e,y,c)}}return o}function rl(e,r,l){var o=We(e,r,"div",null,null,!e.options.singleCursorHeightPerLine),a=l.appendChild(U("div"," ","CodeMirror-cursor"));if(a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.height=Math.max(0,o.bottom-o.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var c=ds(e,r,"div",null,null),g=c.right-c.left;a.style.width=(g>0?g:e.defaultCharWidth())+"px"}if(o.other){var m=l.appendChild(U("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));m.style.display="",m.style.left=o.other.left+"px",m.style.top=o.other.top+"px",m.style.height=(o.other.bottom-o.other.top)*.85+"px"}}function gs(e,r){return e.top-r.top||e.left-r.left}function Ep(e,r,l){var o=e.display,a=e.doc,c=document.createDocumentFragment(),g=Lh(e.display),m=g.left,y=Math.max(o.sizerWidth,Vi(e)-o.sizer.offsetLeft)-g.right,w=a.direction=="ltr";function k(I,K,J,X){K<0&&(K=0),K=Math.round(K),X=Math.round(X),c.appendChild(U("div",null,"CodeMirror-selected","position: absolute; left: "+I+`px;
                             top: `+K+"px; width: "+(J??y-I)+`px;
                             height: `+(X-K)+"px"))}function C(I,K,J){var X=q(a,I),rt=X.text.length,wt,Ut;function At(Nt,pe){return ds(e,B(I,Nt),"div",X,pe)}function xe(Nt,pe,Vt){var Bt=zh(e,X,null,Nt),Pt=pe=="ltr"==(Vt=="after")?"left":"right",Tt=Vt=="after"?Bt.begin:Bt.end-(/\s/.test(X.text.charAt(Bt.end-1))?2:1);return At(Tt,Pt)[Pt]}var de=si(X,a.direction);return Hd(de,K||0,J??rt,function(Nt,pe,Vt,Bt){var Pt=Vt=="ltr",Tt=At(Nt,Pt?"left":"right"),ge=At(pe-1,Pt?"right":"left"),Nr=K==null&&Nt==0,Ai=J==null&&pe==rt,Jt=Bt==0,_e=!de||Bt==de.length-1;if(ge.top-Tt.top<=3){var Gt=(w?Nr:Ai)&&Jt,Dl=(w?Ai:Nr)&&_e,ui=Gt?m:(Pt?Tt:ge).left,Qi=Dl?y:(Pt?ge:Tt).right;k(ui,Tt.top,Qi-ui,Tt.bottom)}else{var $i,ne,Pr,Nl;Pt?($i=w&&Nr&&Jt?m:Tt.left,ne=w?y:xe(Nt,Vt,"before"),Pr=w?m:xe(pe,Vt,"after"),Nl=w&&Ai&&_e?y:ge.right):($i=w?xe(Nt,Vt,"before"):m,ne=!w&&Nr&&Jt?y:Tt.right,Pr=!w&&Ai&&_e?m:ge.left,Nl=w?xe(pe,Vt,"after"):y),k($i,Tt.top,ne-$i,Tt.bottom),Tt.bottom<ge.top&&k(m,Tt.bottom,null,ge.top),k(Pr,ge.top,Nl-Pr,ge.bottom)}(!wt||gs(Tt,wt)<0)&&(wt=Tt),gs(ge,wt)<0&&(wt=ge),(!Ut||gs(Tt,Ut)<0)&&(Ut=Tt),gs(ge,Ut)<0&&(Ut=ge)}),{start:wt,end:Ut}}var L=r.from(),T=r.to();if(L.line==T.line)C(L.line,L.ch,T.ch);else{var O=q(a,L.line),E=q(a,T.line),R=Ie(O)==Ie(E),H=C(L.line,L.ch,R?O.text.length+1:null).end,F=C(T.line,R?0:null,T.ch).start;R&&(H.top<F.top-2?(k(H.right,H.top,null,H.bottom),k(m,F.top,F.left,F.bottom)):k(H.right,H.top,F.left-H.right,H.bottom)),H.bottom<F.top&&k(m,H.bottom,null,F.top)}l.appendChild(c)}function nl(e){if(e.state.focused){var r=e.display;clearInterval(r.blinker);var l=!0;r.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?r.blinker=setInterval(function(){e.hasFocus()||br(e),r.cursorDiv.style.visibility=(l=!l)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(r.cursorDiv.style.visibility="hidden")}}function Vh(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||ol(e))}function sl(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&br(e))},100)}function ol(e,r){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Ot(e,"focus",e,r),e.state.focused=!0,Xt(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),b&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),nl(e))}function br(e,r){e.state.delayingBlurEvent||(e.state.focused&&(Ot(e,"blur",e,r),e.state.focused=!1,it(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function ms(e){for(var r=e.display,l=r.lineDiv.offsetTop,o=Math.max(0,r.scroller.getBoundingClientRect().top),a=r.lineDiv.getBoundingClientRect().top,c=0,g=0;g<r.view.length;g++){var m=r.view[g],y=e.options.lineWrapping,w=void 0,k=0;if(!m.hidden){if(a+=m.line.height,p&&v<8){var C=m.node.offsetTop+m.node.offsetHeight;w=C-l,l=C}else{var L=m.node.getBoundingClientRect();w=L.bottom-L.top,!y&&m.text.firstChild&&(k=m.text.firstChild.getBoundingClientRect().right-L.left-1)}var T=m.line.height-w;if((T>.005||T<-.005)&&(a<o&&(c-=T),Ve(m.line,w),qh(m.line),m.rest))for(var O=0;O<m.rest.length;O++)qh(m.rest[O]);if(k>e.display.sizerWidth){var E=Math.ceil(k/yr(e.display));E>e.display.maxLineLength&&(e.display.maxLineLength=E,e.display.maxLine=m.line,e.display.maxLineChanged=!0)}}}Math.abs(c)>2&&(r.scroller.scrollTop+=c)}function qh(e){if(e.widgets)for(var r=0;r<e.widgets.length;++r){var l=e.widgets[r],o=l.node.parentNode;o&&(l.height=o.offsetHeight)}}function vs(e,r,l){var o=l&&l.top!=null?Math.max(0,l.top):e.scroller.scrollTop;o=Math.floor(o-us(e));var a=l&&l.bottom!=null?l.bottom:o+e.wrapper.clientHeight,c=Gi(r,o),g=Gi(r,a);if(l&&l.ensure){var m=l.ensure.from.line,y=l.ensure.to.line;m<c?(c=m,g=Gi(r,li(q(r,m))+e.wrapper.clientHeight)):Math.min(y,r.lastLine())>=g&&(c=Gi(r,li(q(r,y))-e.wrapper.clientHeight),g=y)}return{from:c,to:Math.max(g,c+1)}}function Bp(e,r){if(!Wt(e,"scrollCursorIntoView")){var l=e.display,o=l.sizer.getBoundingClientRect(),a=null,c=l.wrapper.ownerDocument;if(r.top+o.top<0?a=!0:r.bottom+o.top>(c.defaultView.innerHeight||c.documentElement.clientHeight)&&(a=!1),a!=null&&!P){var g=U("div","​",null,`position: absolute;
                         top: `+(r.top-l.viewOffset-us(e.display))+`px;
                         height: `+(r.bottom-r.top+Ye(e)+l.barHeight)+`px;
                         left: `+r.left+"px; width: "+Math.max(2,r.right-r.left)+"px;");e.display.lineSpace.appendChild(g),g.scrollIntoView(a),e.display.lineSpace.removeChild(g)}}}function Rp(e,r,l,o){o==null&&(o=0);var a;!e.options.lineWrapping&&r==l&&(l=r.sticky=="before"?B(r.line,r.ch+1,"before"):r,r=r.ch?B(r.line,r.sticky=="before"?r.ch-1:r.ch,"after"):r);for(var c=0;c<5;c++){var g=!1,m=We(e,r),y=!l||l==r?m:We(e,l);a={left:Math.min(m.left,y.left),top:Math.min(m.top,y.top)-o,right:Math.max(m.left,y.left),bottom:Math.max(m.bottom,y.bottom)+o};var w=ll(e,a),k=e.doc.scrollTop,C=e.doc.scrollLeft;if(w.scrollTop!=null&&(fn(e,w.scrollTop),Math.abs(e.doc.scrollTop-k)>1&&(g=!0)),w.scrollLeft!=null&&(_i(e,w.scrollLeft),Math.abs(e.doc.scrollLeft-C)>1&&(g=!0)),!g)break}return a}function Hp(e,r){var l=ll(e,r);l.scrollTop!=null&&fn(e,l.scrollTop),l.scrollLeft!=null&&_i(e,l.scrollLeft)}function ll(e,r){var l=e.display,o=vr(e.display);r.top<0&&(r.top=0);var a=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:l.scroller.scrollTop,c=_o(e),g={};r.bottom-r.top>c&&(r.bottom=r.top+c);var m=e.doc.height+Xo(l),y=r.top<o,w=r.bottom>m-o;if(r.top<a)g.scrollTop=y?0:r.top;else if(r.bottom>a+c){var k=Math.min(r.top,(w?m:r.bottom)-c);k!=a&&(g.scrollTop=k)}var C=e.options.fixedGutter?0:l.gutters.offsetWidth,L=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:l.scroller.scrollLeft-C,T=Vi(e)-l.gutters.offsetWidth,O=r.right-r.left>T;return O&&(r.right=r.left+T),r.left<10?g.scrollLeft=0:r.left<L?g.scrollLeft=Math.max(0,r.left+C-(O?0:10)):r.right>T+L-3&&(g.scrollLeft=r.right+(O?0:10)-T),g}function al(e,r){r!=null&&(ys(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+r)}function wr(e){ys(e);var r=e.getCursor();e.curOp.scrollToPos={from:r,to:r,margin:e.options.cursorScrollMargin}}function hn(e,r,l){(r!=null||l!=null)&&ys(e),r!=null&&(e.curOp.scrollLeft=r),l!=null&&(e.curOp.scrollTop=l)}function Ip(e,r){ys(e),e.curOp.scrollToPos=r}function ys(e){var r=e.curOp.scrollToPos;if(r){e.curOp.scrollToPos=null;var l=Wh(e,r.from),o=Wh(e,r.to);Yh(e,l,o,r.margin)}}function Yh(e,r,l,o){var a=ll(e,{left:Math.min(r.left,l.left),top:Math.min(r.top,l.top)-o,right:Math.max(r.right,l.right),bottom:Math.max(r.bottom,l.bottom)+o});hn(e,a.scrollLeft,a.scrollTop)}function fn(e,r){Math.abs(e.doc.scrollTop-r)<2||(s||fl(e,{top:r}),Xh(e,r,!0),s&&fl(e),dn(e,100))}function Xh(e,r,l){r=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,r)),!(e.display.scroller.scrollTop==r&&!l)&&(e.doc.scrollTop=r,e.display.scrollbars.setScrollTop(r),e.display.scroller.scrollTop!=r&&(e.display.scroller.scrollTop=r))}function _i(e,r,l,o){r=Math.max(0,Math.min(r,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((l?r==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-r)<2)&&!o)&&(e.doc.scrollLeft=r,Qh(e),e.display.scroller.scrollLeft!=r&&(e.display.scroller.scrollLeft=r),e.display.scrollbars.setScrollLeft(r))}function un(e){var r=e.display,l=r.gutters.offsetWidth,o=Math.round(e.doc.height+Xo(e.display));return{clientHeight:r.scroller.clientHeight,viewHeight:r.wrapper.clientHeight,scrollWidth:r.scroller.scrollWidth,clientWidth:r.scroller.clientWidth,viewWidth:r.wrapper.clientWidth,barLeft:e.options.fixedGutter?l:0,docHeight:o,scrollHeight:o+Ye(e)+r.barHeight,nativeBarWidth:r.nativeBarWidth,gutterWidth:l}}var ji=function(e,r,l){this.cm=l;var o=this.vert=U("div",[U("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),a=this.horiz=U("div",[U("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=a.tabIndex=-1,e(o),e(a),Z(o,"scroll",function(){o.clientHeight&&r(o.scrollTop,"vertical")}),Z(a,"scroll",function(){a.clientWidth&&r(a.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,p&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};ji.prototype.update=function(e){var r=e.scrollWidth>e.clientWidth+1,l=e.scrollHeight>e.clientHeight+1,o=e.nativeBarWidth;if(l){this.vert.style.display="block",this.vert.style.bottom=r?o+"px":"0";var a=e.viewHeight-(r?o:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+a)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(r){this.horiz.style.display="block",this.horiz.style.right=l?o+"px":"0",this.horiz.style.left=e.barLeft+"px";var c=e.viewWidth-e.barLeft-(l?o:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+c)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(o==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:l?o:0,bottom:r?o:0}},ji.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},ji.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},ji.prototype.zeroWidthHack=function(){var e=V&&!N?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new vi,this.disableVert=new vi},ji.prototype.enableZeroWidthBar=function(e,r,l){e.style.visibility="";function o(){var a=e.getBoundingClientRect(),c=l=="vert"?document.elementFromPoint(a.right-1,(a.top+a.bottom)/2):document.elementFromPoint((a.right+a.left)/2,a.bottom-1);c!=e?e.style.visibility="hidden":r.set(1e3,o)}r.set(1e3,o)},ji.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var cn=function(){};cn.prototype.update=function(){return{bottom:0,right:0}},cn.prototype.setScrollLeft=function(){},cn.prototype.setScrollTop=function(){},cn.prototype.clear=function(){};function xr(e,r){r||(r=un(e));var l=e.display.barWidth,o=e.display.barHeight;_h(e,r);for(var a=0;a<4&&l!=e.display.barWidth||o!=e.display.barHeight;a++)l!=e.display.barWidth&&e.options.lineWrapping&&ms(e),_h(e,un(e)),l=e.display.barWidth,o=e.display.barHeight}function _h(e,r){var l=e.display,o=l.scrollbars.update(r);l.sizer.style.paddingRight=(l.barWidth=o.right)+"px",l.sizer.style.paddingBottom=(l.barHeight=o.bottom)+"px",l.heightForcer.style.borderBottom=o.bottom+"px solid transparent",o.right&&o.bottom?(l.scrollbarFiller.style.display="block",l.scrollbarFiller.style.height=o.bottom+"px",l.scrollbarFiller.style.width=o.right+"px"):l.scrollbarFiller.style.display="",o.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(l.gutterFiller.style.display="block",l.gutterFiller.style.height=o.bottom+"px",l.gutterFiller.style.width=r.gutterWidth+"px"):l.gutterFiller.style.display=""}var jh={native:ji,null:cn};function Jh(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&it(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new jh[e.options.scrollbarStyle](function(r){e.display.wrapper.insertBefore(r,e.display.scrollbarFiller),Z(r,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),r.setAttribute("cm-not-content","true")},function(r,l){l=="horizontal"?_i(e,r):fn(e,r)},e),e.display.scrollbars.addClass&&Xt(e.display.wrapper,e.display.scrollbars.addClass)}var Wp=0;function Ji(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Wp,markArrays:null},gp(e.curOp)}function Zi(e){var r=e.curOp;r&&vp(r,function(l){for(var o=0;o<l.ops.length;o++)l.ops[o].cm.curOp=null;Fp(l)})}function Fp(e){for(var r=e.ops,l=0;l<r.length;l++)zp(r[l]);for(var o=0;o<r.length;o++)Kp(r[o]);for(var a=0;a<r.length;a++)Up(r[a]);for(var c=0;c<r.length;c++)Gp(r[c]);for(var g=0;g<r.length;g++)Vp(r[g])}function zp(e){var r=e.cm,l=r.display;Yp(r),e.updateMaxLine&&qo(r),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<l.viewFrom||e.scrollToPos.to.line>=l.viewTo)||l.maxLineChanged&&r.options.lineWrapping,e.update=e.mustUpdate&&new bs(r,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Kp(e){e.updatedDisplay=e.mustUpdate&&hl(e.cm,e.update)}function Up(e){var r=e.cm,l=r.display;e.updatedDisplay&&ms(r),e.barMeasure=un(r),l.maxLineChanged&&!r.options.lineWrapping&&(e.adjustWidthTo=Dh(r,l.maxLine,l.maxLine.text.length).left+3,r.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(l.scroller.clientWidth,l.sizer.offsetLeft+e.adjustWidthTo+Ye(r)+r.display.barWidth),e.maxScrollLeft=Math.max(0,l.sizer.offsetLeft+e.adjustWidthTo-Vi(r))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=l.input.prepareSelection())}function Gp(e){var r=e.cm;e.adjustWidthTo!=null&&(r.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<r.doc.scrollLeft&&_i(r,Math.min(r.display.scroller.scrollLeft,e.maxScrollLeft),!0),r.display.maxLineChanged=!1);var l=e.focus&&e.focus==he(Ce(r));e.preparedSelection&&r.display.input.showSelection(e.preparedSelection,l),(e.updatedDisplay||e.startHeight!=r.doc.height)&&xr(r,e.barMeasure),e.updatedDisplay&&cl(r,e.barMeasure),e.selectionChanged&&nl(r),r.state.focused&&e.updateInput&&r.display.input.reset(e.typing),l&&Vh(e.cm)}function Vp(e){var r=e.cm,l=r.display,o=r.doc;if(e.updatedDisplay&&Zh(r,e.update),l.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(l.wheelStartX=l.wheelStartY=null),e.scrollTop!=null&&Xh(r,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&_i(r,e.scrollLeft,!0,!0),e.scrollToPos){var a=Rp(r,tt(o,e.scrollToPos.from),tt(o,e.scrollToPos.to),e.scrollToPos.margin);Bp(r,a)}var c=e.maybeHiddenMarkers,g=e.maybeUnhiddenMarkers;if(c)for(var m=0;m<c.length;++m)c[m].lines.length||Ot(c[m],"hide");if(g)for(var y=0;y<g.length;++y)g[y].lines.length&&Ot(g[y],"unhide");l.wrapper.offsetHeight&&(o.scrollTop=r.display.scroller.scrollTop),e.changeObjs&&Ot(r,"changes",r,e.changeObjs),e.update&&e.update.finish()}function we(e,r){if(e.curOp)return r();Ji(e);try{return r()}finally{Zi(e)}}function zt(e,r){return function(){if(e.curOp)return r.apply(e,arguments);Ji(e);try{return r.apply(e,arguments)}finally{Zi(e)}}}function re(e){return function(){if(this.curOp)return e.apply(this,arguments);Ji(this);try{return e.apply(this,arguments)}finally{Zi(this)}}}function Kt(e){return function(){var r=this.cm;if(!r||r.curOp)return e.apply(this,arguments);Ji(r);try{return e.apply(this,arguments)}finally{Zi(r)}}}function dn(e,r){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(r,bo(qp,e))}function qp(e){var r=e.doc;if(!(r.highlightFrontier>=e.display.viewTo)){var l=+new Date+e.options.workTime,o=en(e,r.highlightFrontier),a=[];r.iter(o.line,Math.min(r.first+r.size,e.display.viewTo+500),function(c){if(o.line>=e.display.viewFrom){var g=c.styles,m=c.text.length>e.options.maxHighlightLength?Ki(r.mode,o.state):null,y=nh(e,c,o,!0);m&&(o.state=m),c.styles=y.styles;var w=c.styleClasses,k=y.classes;k?c.styleClasses=k:w&&(c.styleClasses=null);for(var C=!g||g.length!=c.styles.length||w!=k&&(!w||!k||w.bgClass!=k.bgClass||w.textClass!=k.textClass),L=0;!C&&L<g.length;++L)C=g[L]!=c.styles[L];C&&a.push(o.line),c.stateAfter=o.save(),o.nextLine()}else c.text.length<=e.options.maxHighlightLength&&Fo(e,c.text,o),c.stateAfter=o.line%5==0?o.save():null,o.nextLine();if(+new Date>l)return dn(e,e.options.workDelay),!0}),r.highlightFrontier=o.line,r.modeFrontier=Math.max(r.modeFrontier,o.line),a.length&&we(e,function(){for(var c=0;c<a.length;c++)bi(e,a[c],"text")})}}var bs=function(e,r,l){var o=e.display;this.viewport=r,this.visible=vs(o,e.doc,r),this.editorIsHidden=!o.wrapper.offsetWidth,this.wrapperHeight=o.wrapper.clientHeight,this.wrapperWidth=o.wrapper.clientWidth,this.oldDisplayWidth=Vi(e),this.force=l,this.dims=tl(e),this.events=[]};bs.prototype.signal=function(e,r){Pe(e,r)&&this.events.push(arguments)},bs.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ot.apply(null,this.events[e])};function Yp(e){var r=e.display;!r.scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=Ye(e)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=Ye(e)+"px",r.scrollbarsClipped=!0)}function Xp(e){if(e.hasFocus())return null;var r=he(Ce(e));if(!r||!te(e.display.lineDiv,r))return null;var l={activeElt:r};if(window.getSelection){var o=Fi(e).getSelection();o.anchorNode&&o.extend&&te(e.display.lineDiv,o.anchorNode)&&(l.anchorNode=o.anchorNode,l.anchorOffset=o.anchorOffset,l.focusNode=o.focusNode,l.focusOffset=o.focusOffset)}return l}function _p(e){if(!(!e||!e.activeElt||e.activeElt==he(De(e.activeElt)))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&te(document.body,e.anchorNode)&&te(document.body,e.focusNode))){var r=e.activeElt.ownerDocument,l=r.defaultView.getSelection(),o=r.createRange();o.setEnd(e.anchorNode,e.anchorOffset),o.collapse(!1),l.removeAllRanges(),l.addRange(o),l.extend(e.focusNode,e.focusOffset)}}function hl(e,r){var l=e.display,o=e.doc;if(r.editorIsHidden)return wi(e),!1;if(!r.force&&r.visible.from>=l.viewFrom&&r.visible.to<=l.viewTo&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo)&&l.renderedView==l.view&&Uh(e)==0)return!1;$h(e)&&(wi(e),r.dims=tl(e));var a=o.first+o.size,c=Math.max(r.visible.from-e.options.viewportMargin,o.first),g=Math.min(a,r.visible.to+e.options.viewportMargin);l.viewFrom<c&&c-l.viewFrom<20&&(c=Math.max(o.first,l.viewFrom)),l.viewTo>g&&l.viewTo-g<20&&(g=Math.min(a,l.viewTo)),oi&&(c=Go(e.doc,c),g=yh(e.doc,g));var m=c!=l.viewFrom||g!=l.viewTo||l.lastWrapHeight!=r.wrapperHeight||l.lastWrapWidth!=r.wrapperWidth;Pp(e,c,g),l.viewOffset=li(q(e.doc,l.viewFrom)),e.display.mover.style.top=l.viewOffset+"px";var y=Uh(e);if(!m&&y==0&&!r.force&&l.renderedView==l.view&&(l.updateLineNumbers==null||l.updateLineNumbers>=l.viewTo))return!1;var w=Xp(e);return y>4&&(l.lineDiv.style.display="none"),jp(e,l.updateLineNumbers,r.dims),y>4&&(l.lineDiv.style.display=""),l.renderedView=l.view,_p(w),ct(l.cursorDiv),ct(l.selectionDiv),l.gutters.style.height=l.sizer.style.minHeight=0,m&&(l.lastWrapHeight=r.wrapperHeight,l.lastWrapWidth=r.wrapperWidth,dn(e,400)),l.updateLineNumbers=null,!0}function Zh(e,r){for(var l=r.viewport,o=!0;;o=!1){if(!o||!e.options.lineWrapping||r.oldDisplayWidth==Vi(e)){if(l&&l.top!=null&&(l={top:Math.min(e.doc.height+Xo(e.display)-_o(e),l.top)}),r.visible=vs(e.display,e.doc,l),r.visible.from>=e.display.viewFrom&&r.visible.to<=e.display.viewTo)break}else o&&(r.visible=vs(e.display,e.doc,l));if(!hl(e,r))break;ms(e);var a=un(e);an(e),xr(e,a),cl(e,a),r.force=!1}r.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(r.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function fl(e,r){var l=new bs(e,r);if(hl(e,l)){ms(e),Zh(e,l);var o=un(e);an(e),xr(e,o),cl(e,o),l.finish()}}function jp(e,r,l){var o=e.display,a=e.options.lineNumbers,c=o.lineDiv,g=c.firstChild;function m(O){var E=O.nextSibling;return b&&V&&e.display.currentWheelTarget==O?O.style.display="none":O.parentNode.removeChild(O),E}for(var y=o.view,w=o.viewFrom,k=0;k<y.length;k++){var C=y[k];if(!C.hidden)if(!C.node||C.node.parentNode!=c){var L=Sp(e,C,w,l);c.insertBefore(L,g)}else{for(;g!=C.node;)g=m(g);var T=a&&r!=null&&r<=w&&C.lineNumber;C.changes&&(_t(C.changes,"gutter")>-1&&(T=!1),kh(e,C,w,l)),T&&(ct(C.lineNumber),C.lineNumber.appendChild(document.createTextNode(Ho(e.options,w)))),g=C.node.nextSibling}w+=C.size}for(;g;)g=m(g)}function ul(e){var r=e.gutters.offsetWidth;e.sizer.style.marginLeft=r+"px",Ft(e,"gutterChanged",e)}function cl(e,r){e.display.sizer.style.minHeight=r.docHeight+"px",e.display.heightForcer.style.top=r.docHeight+"px",e.display.gutters.style.height=r.docHeight+e.display.barHeight+Ye(e)+"px"}function Qh(e){var r=e.display,l=r.view;if(!(!r.alignWidgets&&(!r.gutters.firstChild||!e.options.fixedGutter))){for(var o=el(r)-r.scroller.scrollLeft+e.doc.scrollLeft,a=r.gutters.offsetWidth,c=o+"px",g=0;g<l.length;g++)if(!l[g].hidden){e.options.fixedGutter&&(l[g].gutter&&(l[g].gutter.style.left=c),l[g].gutterBackground&&(l[g].gutterBackground.style.left=c));var m=l[g].alignable;if(m)for(var y=0;y<m.length;y++)m[y].style.left=c}e.options.fixedGutter&&(r.gutters.style.left=o+a+"px")}}function $h(e){if(!e.options.lineNumbers)return!1;var r=e.doc,l=Ho(e.options,r.first+r.size-1),o=e.display;if(l.length!=o.lineNumChars){var a=o.measure.appendChild(U("div",[U("div",l)],"CodeMirror-linenumber CodeMirror-gutter-elt")),c=a.firstChild.offsetWidth,g=a.offsetWidth-c;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(c,o.lineGutter.offsetWidth-g)+1,o.lineNumWidth=o.lineNumInnerWidth+g,o.lineNumChars=o.lineNumInnerWidth?l.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",ul(e.display),!0}return!1}function dl(e,r){for(var l=[],o=!1,a=0;a<e.length;a++){var c=e[a],g=null;if(typeof c!="string"&&(g=c.style,c=c.className),c=="CodeMirror-linenumbers")if(r)o=!0;else continue;l.push({className:c,style:g})}return r&&!o&&l.push({className:"CodeMirror-linenumbers",style:null}),l}function tf(e){var r=e.gutters,l=e.gutterSpecs;ct(r),e.lineGutter=null;for(var o=0;o<l.length;++o){var a=l[o],c=a.className,g=a.style,m=r.appendChild(U("div",null,"CodeMirror-gutter "+c));g&&(m.style.cssText=g),c=="CodeMirror-linenumbers"&&(e.lineGutter=m,m.style.width=(e.lineNumWidth||1)+"px")}r.style.display=l.length?"":"none",ul(e)}function pn(e){tf(e.display),ue(e),Qh(e)}function Jp(e,r,l,o){var a=this;this.input=l,a.scrollbarFiller=U("div",null,"CodeMirror-scrollbar-filler"),a.scrollbarFiller.setAttribute("cm-not-content","true"),a.gutterFiller=U("div",null,"CodeMirror-gutter-filler"),a.gutterFiller.setAttribute("cm-not-content","true"),a.lineDiv=ye("div",null,"CodeMirror-code"),a.selectionDiv=U("div",null,null,"position: relative; z-index: 1"),a.cursorDiv=U("div",null,"CodeMirror-cursors"),a.measure=U("div",null,"CodeMirror-measure"),a.lineMeasure=U("div",null,"CodeMirror-measure"),a.lineSpace=ye("div",[a.measure,a.lineMeasure,a.selectionDiv,a.cursorDiv,a.lineDiv],null,"position: relative; outline: none");var c=ye("div",[a.lineSpace],"CodeMirror-lines");a.mover=U("div",[c],null,"position: relative"),a.sizer=U("div",[a.mover],"CodeMirror-sizer"),a.sizerWidth=null,a.heightForcer=U("div",null,null,"position: absolute; height: "+Ya+"px; width: 1px;"),a.gutters=U("div",null,"CodeMirror-gutters"),a.lineGutter=null,a.scroller=U("div",[a.sizer,a.heightForcer,a.gutters],"CodeMirror-scroll"),a.scroller.setAttribute("tabIndex","-1"),a.wrapper=U("div",[a.scrollbarFiller,a.gutterFiller,a.scroller],"CodeMirror"),S&&M>=105&&(a.wrapper.style.clipPath="inset(0px)"),a.wrapper.setAttribute("translate","no"),p&&v<8&&(a.gutters.style.zIndex=-1,a.scroller.style.paddingRight=0),!b&&!(s&&Y)&&(a.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(a.wrapper):e(a.wrapper)),a.viewFrom=a.viewTo=r.first,a.reportedViewFrom=a.reportedViewTo=r.first,a.view=[],a.renderedView=null,a.externalMeasured=null,a.viewOffset=0,a.lastWrapHeight=a.lastWrapWidth=0,a.updateLineNumbers=null,a.nativeBarWidth=a.barHeight=a.barWidth=0,a.scrollbarsClipped=!1,a.lineNumWidth=a.lineNumInnerWidth=a.lineNumChars=null,a.alignWidgets=!1,a.cachedCharWidth=a.cachedTextHeight=a.cachedPaddingH=null,a.maxLine=null,a.maxLineLength=0,a.maxLineChanged=!1,a.wheelDX=a.wheelDY=a.wheelStartX=a.wheelStartY=null,a.shift=!1,a.selForContextMenu=null,a.activeTouch=null,a.gutterSpecs=dl(o.gutters,o.lineNumbers),tf(a),l.init(a)}var ws=0,hi=null;p?hi=-.53:s?hi=15:S?hi=-.7:D&&(hi=-1/3);function ef(e){var r=e.wheelDeltaX,l=e.wheelDeltaY;return r==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(r=e.detail),l==null&&e.detail&&e.axis==e.VERTICAL_AXIS?l=e.detail:l==null&&(l=e.wheelDelta),{x:r,y:l}}function Zp(e){var r=ef(e);return r.x*=hi,r.y*=hi,r}function rf(e,r){S&&M==102&&(e.display.chromeScrollHack==null?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout(function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""},100));var l=ef(r),o=l.x,a=l.y,c=hi;r.deltaMode===0&&(o=r.deltaX,a=r.deltaY,c=1);var g=e.display,m=g.scroller,y=m.scrollWidth>m.clientWidth,w=m.scrollHeight>m.clientHeight;if(o&&y||a&&w){if(a&&V&&b){t:for(var k=r.target,C=g.view;k!=m;k=k.parentNode)for(var L=0;L<C.length;L++)if(C[L].node==k){e.display.currentWheelTarget=k;break t}}if(o&&!s&&!A&&c!=null){a&&w&&fn(e,Math.max(0,m.scrollTop+a*c)),_i(e,Math.max(0,m.scrollLeft+o*c)),(!a||a&&w)&&fe(r),g.wheelStartX=null;return}if(a&&c!=null){var T=a*c,O=e.doc.scrollTop,E=O+g.wrapper.clientHeight;T<0?O=Math.max(0,O+T-50):E=Math.min(e.doc.height,E+T+50),fl(e,{top:O,bottom:E})}ws<20&&r.deltaMode!==0&&(g.wheelStartX==null?(g.wheelStartX=m.scrollLeft,g.wheelStartY=m.scrollTop,g.wheelDX=o,g.wheelDY=a,setTimeout(function(){if(g.wheelStartX!=null){var R=m.scrollLeft-g.wheelStartX,H=m.scrollTop-g.wheelStartY,F=H&&g.wheelDY&&H/g.wheelDY||R&&g.wheelDX&&R/g.wheelDX;g.wheelStartX=g.wheelStartY=null,F&&(hi=(hi*ws+F)/(ws+1),++ws)}},200)):(g.wheelDX+=o,g.wheelDY+=a))}}var Ae=function(e,r){this.ranges=e,this.primIndex=r};Ae.prototype.primary=function(){return this.ranges[this.primIndex]},Ae.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var r=0;r<this.ranges.length;r++){var l=this.ranges[r],o=e.ranges[r];if(!Io(l.anchor,o.anchor)||!Io(l.head,o.head))return!1}return!0},Ae.prototype.deepCopy=function(){for(var e=[],r=0;r<this.ranges.length;r++)e[r]=new ft(Wo(this.ranges[r].anchor),Wo(this.ranges[r].head));return new Ae(e,this.primIndex)},Ae.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},Ae.prototype.contains=function(e,r){r||(r=e);for(var l=0;l<this.ranges.length;l++){var o=this.ranges[l];if($(r,o.from())>=0&&$(e,o.to())<=0)return l}return-1};var ft=function(e,r){this.anchor=e,this.head=r};ft.prototype.from=function(){return rs(this.anchor,this.head)},ft.prototype.to=function(){return is(this.anchor,this.head)},ft.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function Fe(e,r,l){var o=e&&e.options.selectionsMayTouch,a=r[l];r.sort(function(L,T){return $(L.from(),T.from())}),l=_t(r,a);for(var c=1;c<r.length;c++){var g=r[c],m=r[c-1],y=$(m.to(),g.from());if(o&&!g.empty()?y>0:y>=0){var w=rs(m.from(),g.from()),k=is(m.to(),g.to()),C=m.empty()?g.from()==g.head:m.from()==m.head;c<=l&&--l,r.splice(--c,2,new ft(C?k:w,C?w:k))}}return new Ae(r,l)}function xi(e,r){return new Ae([new ft(e,r||e)],0)}function Si(e){return e.text?B(e.from.line+e.text.length-1,dt(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function nf(e,r){if($(e,r.from)<0)return e;if($(e,r.to)<=0)return Si(r);var l=e.line+r.text.length-(r.to.line-r.from.line)-1,o=e.ch;return e.line==r.to.line&&(o+=Si(r).ch-r.to.ch),B(l,o)}function pl(e,r){for(var l=[],o=0;o<e.sel.ranges.length;o++){var a=e.sel.ranges[o];l.push(new ft(nf(a.anchor,r),nf(a.head,r)))}return Fe(e.cm,l,e.sel.primIndex)}function sf(e,r,l){return e.line==r.line?B(l.line,e.ch-r.ch+l.ch):B(l.line+(e.line-r.line),e.ch)}function Qp(e,r,l){for(var o=[],a=B(e.first,0),c=a,g=0;g<r.length;g++){var m=r[g],y=sf(m.from,a,c),w=sf(Si(m),a,c);if(a=m.to,c=w,l=="around"){var k=e.sel.ranges[g],C=$(k.head,k.anchor)<0;o[g]=new ft(C?w:y,C?y:w)}else o[g]=new ft(y,y)}return new Ae(o,e.sel.primIndex)}function gl(e){e.doc.mode=Eo(e.options,e.doc.modeOption),gn(e)}function gn(e){e.doc.iter(function(r){r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,dn(e,100),e.state.modeGen++,e.curOp&&ue(e)}function of(e,r){return r.from.ch==0&&r.to.ch==0&&dt(r.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function ml(e,r,l,o){function a(F){return l?l[F]:null}function c(F,I,K){op(F,I,K,o),Ft(F,"change",F,r)}function g(F,I){for(var K=[],J=F;J<I;++J)K.push(new pr(w[J],a(J),o));return K}var m=r.from,y=r.to,w=r.text,k=q(e,m.line),C=q(e,y.line),L=dt(w),T=a(w.length-1),O=y.line-m.line;if(r.full)e.insert(0,g(0,w.length)),e.remove(w.length,e.size-w.length);else if(of(e,r)){var E=g(0,w.length-1);c(C,C.text,T),O&&e.remove(m.line,O),E.length&&e.insert(m.line,E)}else if(k==C)if(w.length==1)c(k,k.text.slice(0,m.ch)+L+k.text.slice(y.ch),T);else{var R=g(1,w.length-1);R.push(new pr(L+k.text.slice(y.ch),T,o)),c(k,k.text.slice(0,m.ch)+w[0],a(0)),e.insert(m.line+1,R)}else if(w.length==1)c(k,k.text.slice(0,m.ch)+w[0]+C.text.slice(y.ch),a(0)),e.remove(m.line+1,O);else{c(k,k.text.slice(0,m.ch)+w[0],a(0)),c(C,L+C.text.slice(y.ch),T);var H=g(1,w.length-1);O>1&&e.remove(m.line+1,O-1),e.insert(m.line+1,H)}Ft(e,"change",e,r)}function ki(e,r,l){function o(a,c,g){if(a.linked)for(var m=0;m<a.linked.length;++m){var y=a.linked[m];if(y.doc!=c){var w=g&&y.sharedHist;l&&!w||(r(y.doc,w),o(y.doc,a,w))}}}o(e,null,!0)}function lf(e,r){if(r.cm)throw new Error("This document is already in use.");e.doc=r,r.cm=e,il(e),gl(e),af(e),e.options.direction=r.direction,e.options.lineWrapping||qo(e),e.options.mode=r.modeOption,ue(e)}function af(e){(e.doc.direction=="rtl"?Xt:it)(e.display.lineDiv,"CodeMirror-rtl")}function $p(e){we(e,function(){af(e),ue(e)})}function xs(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function vl(e,r){var l={from:Wo(r.from),to:Si(r),text:Ui(e,r.from,r.to)};return uf(e,l,r.from.line,r.to.line+1),ki(e,function(o){return uf(o,l,r.from.line,r.to.line+1)},!0),l}function hf(e){for(;e.length;){var r=dt(e);if(r.ranges)e.pop();else break}}function tg(e,r){if(r)return hf(e.done),dt(e.done);if(e.done.length&&!dt(e.done).ranges)return dt(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),dt(e.done)}function ff(e,r,l,o){var a=e.history;a.undone.length=0;var c=+new Date,g,m;if((a.lastOp==o||a.lastOrigin==r.origin&&r.origin&&(r.origin.charAt(0)=="+"&&a.lastModTime>c-(e.cm?e.cm.options.historyEventDelay:500)||r.origin.charAt(0)=="*"))&&(g=tg(a,a.lastOp==o)))m=dt(g.changes),$(r.from,r.to)==0&&$(r.from,m.to)==0?m.to=Si(r):g.changes.push(vl(e,r));else{var y=dt(a.done);for((!y||!y.ranges)&&Ss(e.sel,a.done),g={changes:[vl(e,r)],generation:a.generation},a.done.push(g);a.done.length>a.undoDepth;)a.done.shift(),a.done[0].ranges||a.done.shift()}a.done.push(l),a.generation=++a.maxGeneration,a.lastModTime=a.lastSelTime=c,a.lastOp=a.lastSelOp=o,a.lastOrigin=a.lastSelOrigin=r.origin,m||Ot(e,"historyAdded")}function eg(e,r,l,o){var a=r.charAt(0);return a=="*"||a=="+"&&l.ranges.length==o.ranges.length&&l.somethingSelected()==o.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function ig(e,r,l,o){var a=e.history,c=o&&o.origin;l==a.lastSelOp||c&&a.lastSelOrigin==c&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==c||eg(e,c,dt(a.done),r))?a.done[a.done.length-1]=r:Ss(r,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=c,a.lastSelOp=l,o&&o.clearRedo!==!1&&hf(a.undone)}function Ss(e,r){var l=dt(r);l&&l.ranges&&l.equals(e)||r.push(e)}function uf(e,r,l,o){var a=r["spans_"+e.id],c=0;e.iter(Math.max(e.first,l),Math.min(e.first+e.size,o),function(g){g.markedSpans&&((a||(a=r["spans_"+e.id]={}))[c]=g.markedSpans),++c})}function rg(e){if(!e)return null;for(var r,l=0;l<e.length;++l)e[l].marker.explicitlyCleared?r||(r=e.slice(0,l)):r&&r.push(e[l]);return r?r.length?r:null:e}function ng(e,r){var l=r["spans_"+e.id];if(!l)return null;for(var o=[],a=0;a<r.text.length;++a)o.push(rg(l[a]));return o}function cf(e,r){var l=ng(e,r),o=Ko(e,r);if(!l)return o;if(!o)return l;for(var a=0;a<l.length;++a){var c=l[a],g=o[a];if(c&&g)t:for(var m=0;m<g.length;++m){for(var y=g[m],w=0;w<c.length;++w)if(c[w].marker==y.marker)continue t;c.push(y)}else g&&(l[a]=g)}return l}function Sr(e,r,l){for(var o=[],a=0;a<e.length;++a){var c=e[a];if(c.ranges){o.push(l?Ae.prototype.deepCopy.call(c):c);continue}var g=c.changes,m=[];o.push({changes:m});for(var y=0;y<g.length;++y){var w=g[y],k=void 0;if(m.push({from:w.from,to:w.to,text:w.text}),r)for(var C in w)(k=C.match(/^spans_(\d+)$/))&&_t(r,Number(k[1]))>-1&&(dt(m)[C]=w[C],delete w[C])}}return o}function yl(e,r,l,o){if(o){var a=e.anchor;if(l){var c=$(r,a)<0;c!=$(l,a)<0?(a=r,r=l):c!=$(r,l)<0&&(r=l)}return new ft(a,r)}else return new ft(l||r,r)}function ks(e,r,l,o,a){a==null&&(a=e.cm&&(e.cm.display.shift||e.extend)),jt(e,new Ae([yl(e.sel.primary(),r,l,a)],0),o)}function df(e,r,l){for(var o=[],a=e.cm&&(e.cm.display.shift||e.extend),c=0;c<e.sel.ranges.length;c++)o[c]=yl(e.sel.ranges[c],r[c],null,a);var g=Fe(e.cm,o,e.sel.primIndex);jt(e,g,l)}function bl(e,r,l,o){var a=e.sel.ranges.slice(0);a[r]=l,jt(e,Fe(e.cm,a,e.sel.primIndex),o)}function pf(e,r,l,o){jt(e,xi(r,l),o)}function sg(e,r,l){var o={ranges:r.ranges,update:function(a){this.ranges=[];for(var c=0;c<a.length;c++)this.ranges[c]=new ft(tt(e,a[c].anchor),tt(e,a[c].head))},origin:l&&l.origin};return Ot(e,"beforeSelectionChange",e,o),e.cm&&Ot(e.cm,"beforeSelectionChange",e.cm,o),o.ranges!=r.ranges?Fe(e.cm,o.ranges,o.ranges.length-1):r}function gf(e,r,l){var o=e.history.done,a=dt(o);a&&a.ranges?(o[o.length-1]=r,Cs(e,r,l)):jt(e,r,l)}function jt(e,r,l){Cs(e,r,l),ig(e,e.sel,e.cm?e.cm.curOp.id:NaN,l)}function Cs(e,r,l){(Pe(e,"beforeSelectionChange")||e.cm&&Pe(e.cm,"beforeSelectionChange"))&&(r=sg(e,r,l));var o=l&&l.bias||($(r.primary().head,e.sel.primary().head)<0?-1:1);mf(e,yf(e,r,o,!0)),!(l&&l.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&wr(e.cm)}function mf(e,r){r.equals(e.sel)||(e.sel=r,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Qa(e.cm)),Ft(e,"cursorActivity",e))}function vf(e){mf(e,yf(e,e.sel,null,!1))}function yf(e,r,l,o){for(var a,c=0;c<r.ranges.length;c++){var g=r.ranges[c],m=r.ranges.length==e.sel.ranges.length&&e.sel.ranges[c],y=Ms(e,g.anchor,m&&m.anchor,l,o),w=g.head==g.anchor?y:Ms(e,g.head,m&&m.head,l,o);(a||y!=g.anchor||w!=g.head)&&(a||(a=r.ranges.slice(0,c)),a[c]=new ft(y,w))}return a?Fe(e.cm,a,r.primIndex):r}function kr(e,r,l,o,a){var c=q(e,r.line);if(c.markedSpans)for(var g=0;g<c.markedSpans.length;++g){var m=c.markedSpans[g],y=m.marker,w="selectLeft"in y?!y.selectLeft:y.inclusiveLeft,k="selectRight"in y?!y.selectRight:y.inclusiveRight;if((m.from==null||(w?m.from<=r.ch:m.from<r.ch))&&(m.to==null||(k?m.to>=r.ch:m.to>r.ch))){if(a&&(Ot(y,"beforeCursorEnter"),y.explicitlyCleared))if(c.markedSpans){--g;continue}else break;if(!y.atomic)continue;if(l){var C=y.find(o<0?1:-1),L=void 0;if((o<0?k:w)&&(C=bf(e,C,-o,C&&C.line==r.line?c:null)),C&&C.line==r.line&&(L=$(C,l))&&(o<0?L<0:L>0))return kr(e,C,r,o,a)}var T=y.find(o<0?-1:1);return(o<0?w:k)&&(T=bf(e,T,o,T.line==r.line?c:null)),T?kr(e,T,r,o,a):null}}return r}function Ms(e,r,l,o,a){var c=o||1,g=kr(e,r,l,c,a)||!a&&kr(e,r,l,c,!0)||kr(e,r,l,-c,a)||!a&&kr(e,r,l,-c,!0);return g||(e.cantEdit=!0,B(e.first,0))}function bf(e,r,l,o){return l<0&&r.ch==0?r.line>e.first?tt(e,B(r.line-1)):null:l>0&&r.ch==(o||q(e,r.line)).text.length?r.line<e.first+e.size-1?B(r.line+1,0):null:new B(r.line,r.ch+l)}function wf(e){e.setSelection(B(e.firstLine(),0),B(e.lastLine()),Ge)}function xf(e,r,l){var o={canceled:!1,from:r.from,to:r.to,text:r.text,origin:r.origin,cancel:function(){return o.canceled=!0}};return l&&(o.update=function(a,c,g,m){a&&(o.from=tt(e,a)),c&&(o.to=tt(e,c)),g&&(o.text=g),m!==void 0&&(o.origin=m)}),Ot(e,"beforeChange",e,o),e.cm&&Ot(e.cm,"beforeChange",e.cm,o),o.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Cr(e,r,l){if(e.cm){if(!e.cm.curOp)return zt(e.cm,Cr)(e,r,l);if(e.cm.state.suppressEdits)return}if(!((Pe(e,"beforeChange")||e.cm&&Pe(e.cm,"beforeChange"))&&(r=xf(e,r,!0),!r))){var o=uh&&!l&&ip(e,r.from,r.to);if(o)for(var a=o.length-1;a>=0;--a)Sf(e,{from:o[a].from,to:o[a].to,text:a?[""]:r.text,origin:r.origin});else Sf(e,r)}}function Sf(e,r){if(!(r.text.length==1&&r.text[0]==""&&$(r.from,r.to)==0)){var l=pl(e,r);ff(e,r,l,e.cm?e.cm.curOp.id:NaN),mn(e,r,l,Ko(e,r));var o=[];ki(e,function(a,c){!c&&_t(o,a.history)==-1&&(Af(a.history,r),o.push(a.history)),mn(a,r,null,Ko(a,r))})}}function As(e,r,l){var o=e.cm&&e.cm.state.suppressEdits;if(!(o&&!l)){for(var a=e.history,c,g=e.sel,m=r=="undo"?a.done:a.undone,y=r=="undo"?a.undone:a.done,w=0;w<m.length&&(c=m[w],!(l?c.ranges&&!c.equals(e.sel):!c.ranges));w++);if(w!=m.length){for(a.lastOrigin=a.lastSelOrigin=null;;)if(c=m.pop(),c.ranges){if(Ss(c,y),l&&!c.equals(e.sel)){jt(e,c,{clearRedo:!1});return}g=c}else if(o){m.push(c);return}else break;var k=[];Ss(g,y),y.push({changes:k,generation:a.generation}),a.generation=c.generation||++a.maxGeneration;for(var C=Pe(e,"beforeChange")||e.cm&&Pe(e.cm,"beforeChange"),L=function(E){var R=c.changes[E];if(R.origin=r,C&&!xf(e,R,!1))return m.length=0,{};k.push(vl(e,R));var H=E?pl(e,R):dt(m);mn(e,R,H,cf(e,R)),!E&&e.cm&&e.cm.scrollIntoView({from:R.from,to:Si(R)});var F=[];ki(e,function(I,K){!K&&_t(F,I.history)==-1&&(Af(I.history,R),F.push(I.history)),mn(I,R,null,cf(I,R))})},T=c.changes.length-1;T>=0;--T){var O=L(T);if(O)return O.v}}}}function kf(e,r){if(r!=0&&(e.first+=r,e.sel=new Ae($n(e.sel.ranges,function(a){return new ft(B(a.anchor.line+r,a.anchor.ch),B(a.head.line+r,a.head.ch))}),e.sel.primIndex),e.cm)){ue(e.cm,e.first,e.first-r,r);for(var l=e.cm.display,o=l.viewFrom;o<l.viewTo;o++)bi(e.cm,o,"gutter")}}function mn(e,r,l,o){if(e.cm&&!e.cm.curOp)return zt(e.cm,mn)(e,r,l,o);if(r.to.line<e.first){kf(e,r.text.length-1-(r.to.line-r.from.line));return}if(!(r.from.line>e.lastLine())){if(r.from.line<e.first){var a=r.text.length-1-(e.first-r.from.line);kf(e,a),r={from:B(e.first,0),to:B(r.to.line+a,r.to.ch),text:[dt(r.text)],origin:r.origin}}var c=e.lastLine();r.to.line>c&&(r={from:r.from,to:B(c,q(e,c).text.length),text:[r.text[0]],origin:r.origin}),r.removed=Ui(e,r.from,r.to),l||(l=pl(e,r)),e.cm?og(e.cm,r,o):ml(e,r,o),Cs(e,l,Ge),e.cantEdit&&Ms(e,B(e.firstLine(),0))&&(e.cantEdit=!1)}}function og(e,r,l){var o=e.doc,a=e.display,c=r.from,g=r.to,m=!1,y=c.line;e.options.lineWrapping||(y=gt(Ie(q(o,c.line))),o.iter(y,g.line+1,function(T){if(T==a.maxLine)return m=!0,!0})),o.sel.contains(r.from,r.to)>-1&&Qa(e),ml(o,r,l,Kh(e)),e.options.lineWrapping||(o.iter(y,c.line+r.text.length,function(T){var O=hs(T);O>a.maxLineLength&&(a.maxLine=T,a.maxLineLength=O,a.maxLineChanged=!0,m=!1)}),m&&(e.curOp.updateMaxLine=!0)),jd(o,c.line),dn(e,400);var w=r.text.length-(g.line-c.line)-1;r.full?ue(e):c.line==g.line&&r.text.length==1&&!of(e.doc,r)?bi(e,c.line,"text"):ue(e,c.line,g.line+1,w);var k=Pe(e,"changes"),C=Pe(e,"change");if(C||k){var L={from:c,to:g,text:r.text,removed:r.removed,origin:r.origin};C&&Ft(e,"change",e,L),k&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(L)}e.display.selForContextMenu=null}function Mr(e,r,l,o,a){var c;o||(o=l),$(o,l)<0&&(c=[o,l],l=c[0],o=c[1]),typeof r=="string"&&(r=e.splitLines(r)),Cr(e,{from:l,to:o,text:r,origin:a})}function Cf(e,r,l,o){l<e.line?e.line+=o:r<e.line&&(e.line=r,e.ch=0)}function Mf(e,r,l,o){for(var a=0;a<e.length;++a){var c=e[a],g=!0;if(c.ranges){c.copied||(c=e[a]=c.deepCopy(),c.copied=!0);for(var m=0;m<c.ranges.length;m++)Cf(c.ranges[m].anchor,r,l,o),Cf(c.ranges[m].head,r,l,o);continue}for(var y=0;y<c.changes.length;++y){var w=c.changes[y];if(l<w.from.line)w.from=B(w.from.line+o,w.from.ch),w.to=B(w.to.line+o,w.to.ch);else if(r<=w.to.line){g=!1;break}}g||(e.splice(0,a+1),a=0)}}function Af(e,r){var l=r.from.line,o=r.to.line,a=r.text.length-(o-l)-1;Mf(e.done,l,o,a),Mf(e.undone,l,o,a)}function vn(e,r,l,o){var a=r,c=r;return typeof r=="number"?c=q(e,ih(e,r)):a=gt(r),a==null?null:(o(c,a)&&e.cm&&bi(e.cm,a,l),c)}function yn(e){this.lines=e,this.parent=null;for(var r=0,l=0;l<e.length;++l)e[l].parent=this,r+=e[l].height;this.height=r}yn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,r){for(var l=e,o=e+r;l<o;++l){var a=this.lines[l];this.height-=a.height,lp(a),Ft(a,"delete")}this.lines.splice(e,r)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,r,l){this.height+=l,this.lines=this.lines.slice(0,e).concat(r).concat(this.lines.slice(e));for(var o=0;o<r.length;++o)r[o].parent=this},iterN:function(e,r,l){for(var o=e+r;e<o;++e)if(l(this.lines[e]))return!0}};function bn(e){this.children=e;for(var r=0,l=0,o=0;o<e.length;++o){var a=e[o];r+=a.chunkSize(),l+=a.height,a.parent=this}this.size=r,this.height=l,this.parent=null}bn.prototype={chunkSize:function(){return this.size},removeInner:function(e,r){this.size-=r;for(var l=0;l<this.children.length;++l){var o=this.children[l],a=o.chunkSize();if(e<a){var c=Math.min(r,a-e),g=o.height;if(o.removeInner(e,c),this.height-=g-o.height,a==c&&(this.children.splice(l--,1),o.parent=null),(r-=c)==0)break;e=0}else e-=a}if(this.size-r<25&&(this.children.length>1||!(this.children[0]instanceof yn))){var m=[];this.collapse(m),this.children=[new yn(m)],this.children[0].parent=this}},collapse:function(e){for(var r=0;r<this.children.length;++r)this.children[r].collapse(e)},insertInner:function(e,r,l){this.size+=r.length,this.height+=l;for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<=c){if(a.insertInner(e,r,l),a.lines&&a.lines.length>50){for(var g=a.lines.length%25+25,m=g;m<a.lines.length;){var y=new yn(a.lines.slice(m,m+=25));a.height-=y.height,this.children.splice(++o,0,y),y.parent=this}a.lines=a.lines.slice(0,g),this.maybeSpill()}break}e-=c}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var r=e.children.splice(e.children.length-5,5),l=new bn(r);if(e.parent){e.size-=l.size,e.height-=l.height;var a=_t(e.parent.children,e);e.parent.children.splice(a+1,0,l)}else{var o=new bn(e.children);o.parent=e,e.children=[o,l],e=o}l.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,r,l){for(var o=0;o<this.children.length;++o){var a=this.children[o],c=a.chunkSize();if(e<c){var g=Math.min(r,c-e);if(a.iterN(e,g,l))return!0;if((r-=g)==0)break;e=0}else e-=c}}};var wn=function(e,r,l){if(l)for(var o in l)l.hasOwnProperty(o)&&(this[o]=l[o]);this.doc=e,this.node=r};wn.prototype.clear=function(){var e=this.doc.cm,r=this.line.widgets,l=this.line,o=gt(l);if(!(o==null||!r)){for(var a=0;a<r.length;++a)r[a]==this&&r.splice(a--,1);r.length||(l.widgets=null);var c=on(this);Ve(l,Math.max(0,l.height-c)),e&&(we(e,function(){Tf(e,l,-c),bi(e,o,"widget")}),Ft(e,"lineWidgetCleared",e,this,o))}},wn.prototype.changed=function(){var e=this,r=this.height,l=this.doc.cm,o=this.line;this.height=null;var a=on(this)-r;a&&(yi(this.doc,o)||Ve(o,o.height+a),l&&we(l,function(){l.curOp.forceUpdate=!0,Tf(l,o,a),Ft(l,"lineWidgetChanged",l,e,gt(o))}))},ur(wn);function Tf(e,r,l){li(r)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&al(e,l)}function lg(e,r,l,o){var a=new wn(e,l,o),c=e.cm;return c&&a.noHScroll&&(c.display.alignWidgets=!0),vn(e,r,"widget",function(g){var m=g.widgets||(g.widgets=[]);if(a.insertAt==null?m.push(a):m.splice(Math.min(m.length,Math.max(0,a.insertAt)),0,a),a.line=g,c&&!yi(e,g)){var y=li(g)<e.scrollTop;Ve(g,g.height+on(a)),y&&al(c,a.height),c.curOp.forceUpdate=!0}return!0}),c&&Ft(c,"lineWidgetAdded",c,a,typeof r=="number"?r:gt(r)),a}var Lf=0,Ci=function(e,r){this.lines=[],this.type=r,this.doc=e,this.id=++Lf};Ci.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,r=e&&!e.curOp;if(r&&Ji(e),Pe(this,"clear")){var l=this.find();l&&Ft(this,"clear",l.from,l.to)}for(var o=null,a=null,c=0;c<this.lines.length;++c){var g=this.lines[c],m=rn(g.markedSpans,this);e&&!this.collapsed?bi(e,gt(g),"text"):e&&(m.to!=null&&(a=gt(g)),m.from!=null&&(o=gt(g))),g.markedSpans=Qd(g.markedSpans,m),m.from==null&&this.collapsed&&!yi(this.doc,g)&&e&&Ve(g,vr(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var y=0;y<this.lines.length;++y){var w=Ie(this.lines[y]),k=hs(w);k>e.display.maxLineLength&&(e.display.maxLine=w,e.display.maxLineLength=k,e.display.maxLineChanged=!0)}o!=null&&e&&this.collapsed&&ue(e,o,a+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&vf(e.doc)),e&&Ft(e,"markerCleared",e,this,o,a),r&&Zi(e),this.parent&&this.parent.clear()}},Ci.prototype.find=function(e,r){e==null&&this.type=="bookmark"&&(e=1);for(var l,o,a=0;a<this.lines.length;++a){var c=this.lines[a],g=rn(c.markedSpans,this);if(g.from!=null&&(l=B(r?c:gt(c),g.from),e==-1))return l;if(g.to!=null&&(o=B(r?c:gt(c),g.to),e==1))return o}return l&&{from:l,to:o}},Ci.prototype.changed=function(){var e=this,r=this.find(-1,!0),l=this,o=this.doc.cm;!r||!o||we(o,function(){var a=r.line,c=gt(r.line),g=jo(o,c);if(g&&(Eh(g),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!yi(l.doc,a)&&l.height!=null){var m=l.height;l.height=null;var y=on(l)-m;y&&Ve(a,a.height+y)}Ft(o,"markerChanged",o,e)})},Ci.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(!r.maybeHiddenMarkers||_t(r.maybeHiddenMarkers,this)==-1)&&(r.maybeUnhiddenMarkers||(r.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},Ci.prototype.detachLine=function(e){if(this.lines.splice(_t(this.lines,e),1),!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(r.maybeHiddenMarkers||(r.maybeHiddenMarkers=[])).push(this)}},ur(Ci);function Ar(e,r,l,o,a){if(o&&o.shared)return ag(e,r,l,o,a);if(e.cm&&!e.cm.curOp)return zt(e.cm,Ar)(e,r,l,o,a);var c=new Ci(e,a),g=$(r,l);if(o&&zi(o,c,!1),g>0||g==0&&c.clearWhenEmpty!==!1)return c;if(c.replacedWith&&(c.collapsed=!0,c.widgetNode=ye("span",[c.replacedWith],"CodeMirror-widget"),o.handleMouseEvents||c.widgetNode.setAttribute("cm-ignore-events","true"),o.insertLeft&&(c.widgetNode.insertLeft=!0)),c.collapsed){if(vh(e,r.line,r,l,c)||r.line!=l.line&&vh(e,l.line,r,l,c))throw new Error("Inserting collapsed marker partially overlapping an existing one");Zd()}c.addToHistory&&ff(e,{from:r,to:l,origin:"markText"},e.sel,NaN);var m=r.line,y=e.cm,w;if(e.iter(m,l.line+1,function(C){y&&c.collapsed&&!y.options.lineWrapping&&Ie(C)==y.display.maxLine&&(w=!0),c.collapsed&&m!=r.line&&Ve(C,0),$d(C,new ss(c,m==r.line?r.ch:null,m==l.line?l.ch:null),e.cm&&e.cm.curOp),++m}),c.collapsed&&e.iter(r.line,l.line+1,function(C){yi(e,C)&&Ve(C,0)}),c.clearOnEnter&&Z(c,"beforeCursorEnter",function(){return c.clear()}),c.readOnly&&(Jd(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),c.collapsed&&(c.id=++Lf,c.atomic=!0),y){if(w&&(y.curOp.updateMaxLine=!0),c.collapsed)ue(y,r.line,l.line+1);else if(c.className||c.startStyle||c.endStyle||c.css||c.attributes||c.title)for(var k=r.line;k<=l.line;k++)bi(y,k,"text");c.atomic&&vf(y.doc),Ft(y,"markerAdded",y,c)}return c}var xn=function(e,r){this.markers=e,this.primary=r;for(var l=0;l<e.length;++l)e[l].parent=this};xn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Ft(this,"clear")}},xn.prototype.find=function(e,r){return this.primary.find(e,r)},ur(xn);function ag(e,r,l,o,a){o=zi(o),o.shared=!1;var c=[Ar(e,r,l,o,a)],g=c[0],m=o.widgetNode;return ki(e,function(y){m&&(o.widgetNode=m.cloneNode(!0)),c.push(Ar(y,tt(y,r),tt(y,l),o,a));for(var w=0;w<y.linked.length;++w)if(y.linked[w].isParent)return;g=dt(c)}),new xn(c,g)}function Of(e){return e.findMarks(B(e.first,0),e.clipPos(B(e.lastLine())),function(r){return r.parent})}function hg(e,r){for(var l=0;l<r.length;l++){var o=r[l],a=o.find(),c=e.clipPos(a.from),g=e.clipPos(a.to);if($(c,g)){var m=Ar(e,c,g,o.primary,o.primary.type);o.markers.push(m),m.parent=o}}}function fg(e){for(var r=function(o){var a=e[o],c=[a.primary.doc];ki(a.primary.doc,function(y){return c.push(y)});for(var g=0;g<a.markers.length;g++){var m=a.markers[g];_t(c,m.doc)==-1&&(m.parent=null,a.markers.splice(g--,1))}},l=0;l<e.length;l++)r(l)}var ug=0,ce=function(e,r,l,o,a){if(!(this instanceof ce))return new ce(e,r,l,o,a);l==null&&(l=0),bn.call(this,[new yn([new pr("",null)])]),this.first=l,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=l;var c=B(l,0);this.sel=xi(c),this.history=new xs(null),this.id=++ug,this.modeOption=r,this.lineSep=o,this.direction=a=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),ml(this,{from:c,to:c,text:e}),jt(this,xi(c),Ge)};ce.prototype=_a(bn.prototype,{constructor:ce,iter:function(e,r,l){l?this.iterN(e-this.first,r-e,l):this.iterN(this.first,this.first+this.size,e)},insert:function(e,r){for(var l=0,o=0;o<r.length;++o)l+=r[o].height;this.insertInner(e-this.first,r,l)},remove:function(e,r){this.removeInner(e-this.first,r)},getValue:function(e){var r=Ro(this,this.first,this.first+this.size);return e===!1?r:r.join(e||this.lineSeparator())},setValue:Kt(function(e){var r=B(this.first,0),l=this.first+this.size-1;Cr(this,{from:r,to:B(l,q(this,l).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&hn(this.cm,0,0),jt(this,xi(r),Ge)}),replaceRange:function(e,r,l,o){r=tt(this,r),l=l?tt(this,l):r,Mr(this,e,r,l,o)},getRange:function(e,r,l){var o=Ui(this,tt(this,e),tt(this,r));return l===!1?o:l===""?o.join(""):o.join(l||this.lineSeparator())},getLine:function(e){var r=this.getLineHandle(e);return r&&r.text},getLineHandle:function(e){if(tn(this,e))return q(this,e)},getLineNumber:function(e){return gt(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=q(this,e)),Ie(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return tt(this,e)},getCursor:function(e){var r=this.sel.primary(),l;return e==null||e=="head"?l=r.head:e=="anchor"?l=r.anchor:e=="end"||e=="to"||e===!1?l=r.to():l=r.from(),l},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Kt(function(e,r,l){pf(this,tt(this,typeof e=="number"?B(e,r||0):e),null,l)}),setSelection:Kt(function(e,r,l){pf(this,tt(this,e),tt(this,r||e),l)}),extendSelection:Kt(function(e,r,l){ks(this,tt(this,e),r&&tt(this,r),l)}),extendSelections:Kt(function(e,r){df(this,rh(this,e),r)}),extendSelectionsBy:Kt(function(e,r){var l=$n(this.sel.ranges,e);df(this,rh(this,l),r)}),setSelections:Kt(function(e,r,l){if(e.length){for(var o=[],a=0;a<e.length;a++)o[a]=new ft(tt(this,e[a].anchor),tt(this,e[a].head||e[a].anchor));r==null&&(r=Math.min(e.length-1,this.sel.primIndex)),jt(this,Fe(this.cm,o,r),l)}}),addSelection:Kt(function(e,r,l){var o=this.sel.ranges.slice(0);o.push(new ft(tt(this,e),tt(this,r||e))),jt(this,Fe(this.cm,o,o.length-1),l)}),getSelection:function(e){for(var r=this.sel.ranges,l,o=0;o<r.length;o++){var a=Ui(this,r[o].from(),r[o].to());l=l?l.concat(a):a}return e===!1?l:l.join(e||this.lineSeparator())},getSelections:function(e){for(var r=[],l=this.sel.ranges,o=0;o<l.length;o++){var a=Ui(this,l[o].from(),l[o].to());e!==!1&&(a=a.join(e||this.lineSeparator())),r[o]=a}return r},replaceSelection:function(e,r,l){for(var o=[],a=0;a<this.sel.ranges.length;a++)o[a]=e;this.replaceSelections(o,r,l||"+input")},replaceSelections:Kt(function(e,r,l){for(var o=[],a=this.sel,c=0;c<a.ranges.length;c++){var g=a.ranges[c];o[c]={from:g.from(),to:g.to(),text:this.splitLines(e[c]),origin:l}}for(var m=r&&r!="end"&&Qp(this,o,r),y=o.length-1;y>=0;y--)Cr(this,o[y]);m?gf(this,m):this.cm&&wr(this.cm)}),undo:Kt(function(){As(this,"undo")}),redo:Kt(function(){As(this,"redo")}),undoSelection:Kt(function(){As(this,"undo",!0)}),redoSelection:Kt(function(){As(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,r=0,l=0,o=0;o<e.done.length;o++)e.done[o].ranges||++r;for(var a=0;a<e.undone.length;a++)e.undone[a].ranges||++l;return{undo:r,redo:l}},clearHistory:function(){var e=this;this.history=new xs(this.history),ki(this,function(r){return r.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Sr(this.history.done),undone:Sr(this.history.undone)}},setHistory:function(e){var r=this.history=new xs(this.history);r.done=Sr(e.done.slice(0),null,!0),r.undone=Sr(e.undone.slice(0),null,!0)},setGutterMarker:Kt(function(e,r,l){return vn(this,e,"gutter",function(o){var a=o.gutterMarkers||(o.gutterMarkers={});return a[r]=l,!l&&ja(a)&&(o.gutterMarkers=null),!0})}),clearGutter:Kt(function(e){var r=this;this.iter(function(l){l.gutterMarkers&&l.gutterMarkers[e]&&vn(r,l,"gutter",function(){return l.gutterMarkers[e]=null,ja(l.gutterMarkers)&&(l.gutterMarkers=null),!0})})}),lineInfo:function(e){var r;if(typeof e=="number"){if(!tn(this,e)||(r=e,e=q(this,e),!e))return null}else if(r=gt(e),r==null)return null;return{line:r,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Kt(function(e,r,l){return vn(this,e,r=="gutter"?"gutter":"class",function(o){var a=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass";if(!o[a])o[a]=l;else{if(nt(l).test(o[a]))return!1;o[a]+=" "+l}return!0})}),removeLineClass:Kt(function(e,r,l){return vn(this,e,r=="gutter"?"gutter":"class",function(o){var a=r=="text"?"textClass":r=="background"?"bgClass":r=="gutter"?"gutterClass":"wrapClass",c=o[a];if(c)if(l==null)o[a]=null;else{var g=c.match(nt(l));if(!g)return!1;var m=g.index+g[0].length;o[a]=c.slice(0,g.index)+(!g.index||m==c.length?"":" ")+c.slice(m)||null}else return!1;return!0})}),addLineWidget:Kt(function(e,r,l){return lg(this,e,r,l)}),removeLineWidget:function(e){e.clear()},markText:function(e,r,l){return Ar(this,tt(this,e),tt(this,r),l,l&&l.type||"range")},setBookmark:function(e,r){var l={replacedWith:r&&(r.nodeType==null?r.widget:r),insertLeft:r&&r.insertLeft,clearWhenEmpty:!1,shared:r&&r.shared,handleMouseEvents:r&&r.handleMouseEvents};return e=tt(this,e),Ar(this,e,e,l,"bookmark")},findMarksAt:function(e){e=tt(this,e);var r=[],l=q(this,e.line).markedSpans;if(l)for(var o=0;o<l.length;++o){var a=l[o];(a.from==null||a.from<=e.ch)&&(a.to==null||a.to>=e.ch)&&r.push(a.marker.parent||a.marker)}return r},findMarks:function(e,r,l){e=tt(this,e),r=tt(this,r);var o=[],a=e.line;return this.iter(e.line,r.line+1,function(c){var g=c.markedSpans;if(g)for(var m=0;m<g.length;m++){var y=g[m];!(y.to!=null&&a==e.line&&e.ch>=y.to||y.from==null&&a!=e.line||y.from!=null&&a==r.line&&y.from>=r.ch)&&(!l||l(y.marker))&&o.push(y.marker.parent||y.marker)}++a}),o},getAllMarks:function(){var e=[];return this.iter(function(r){var l=r.markedSpans;if(l)for(var o=0;o<l.length;++o)l[o].from!=null&&e.push(l[o].marker)}),e},posFromIndex:function(e){var r,l=this.first,o=this.lineSeparator().length;return this.iter(function(a){var c=a.text.length+o;if(c>e)return r=e,!0;e-=c,++l}),tt(this,B(l,r))},indexFromPos:function(e){e=tt(this,e);var r=e.ch;if(e.line<this.first||e.ch<0)return 0;var l=this.lineSeparator().length;return this.iter(this.first,e.line,function(o){r+=o.text.length+l}),r},copy:function(e){var r=new ce(Ro(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return r.scrollTop=this.scrollTop,r.scrollLeft=this.scrollLeft,r.sel=this.sel,r.extend=!1,e&&(r.history.undoDepth=this.history.undoDepth,r.setHistory(this.getHistory())),r},linkedDoc:function(e){e||(e={});var r=this.first,l=this.first+this.size;e.from!=null&&e.from>r&&(r=e.from),e.to!=null&&e.to<l&&(l=e.to);var o=new ce(Ro(this,r,l),e.mode||this.modeOption,r,this.lineSep,this.direction);return e.sharedHist&&(o.history=this.history),(this.linked||(this.linked=[])).push({doc:o,sharedHist:e.sharedHist}),o.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],hg(o,Of(this)),o},unlinkDoc:function(e){if(e instanceof Ct&&(e=e.doc),this.linked)for(var r=0;r<this.linked.length;++r){var l=this.linked[r];if(l.doc==e){this.linked.splice(r,1),e.unlinkDoc(this),fg(Of(this));break}}if(e.history==this.history){var o=[e.id];ki(e,function(a){return o.push(a.id)},!0),e.history=new xs(null),e.history.done=Sr(this.history.done,o),e.history.undone=Sr(this.history.undone,o)}},iterLinkedDocs:function(e){ki(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Do(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:Kt(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(r){return r.order=null}),this.cm&&$p(this.cm))})}),ce.prototype.eachLine=ce.prototype.iter;var Df=0;function cg(e){var r=this;if(Nf(r),!(Wt(r,e)||ai(r.display,e))){fe(e),p&&(Df=+new Date);var l=Yi(r,e,!0),o=e.dataTransfer.files;if(!(!l||r.isReadOnly()))if(o&&o.length&&window.FileReader&&window.File)for(var a=o.length,c=Array(a),g=0,m=function(){++g==a&&zt(r,function(){l=tt(r.doc,l);var T={from:l,to:l,text:r.doc.splitLines(c.filter(function(O){return O!=null}).join(r.doc.lineSeparator())),origin:"paste"};Cr(r.doc,T),gf(r.doc,xi(tt(r.doc,l),tt(r.doc,Si(T))))})()},y=function(T,O){if(r.options.allowDropFileTypes&&_t(r.options.allowDropFileTypes,T.type)==-1){m();return}var E=new FileReader;E.onerror=function(){return m()},E.onload=function(){var R=E.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(R)){m();return}c[O]=R,m()},E.readAsText(T)},w=0;w<o.length;w++)y(o[w],w);else{if(r.state.draggingText&&r.doc.sel.contains(l)>-1){r.state.draggingText(e),setTimeout(function(){return r.display.input.focus()},20);return}try{var k=e.dataTransfer.getData("Text");if(k){var C;if(r.state.draggingText&&!r.state.draggingText.copy&&(C=r.listSelections()),Cs(r.doc,xi(l,l)),C)for(var L=0;L<C.length;++L)Mr(r.doc,"",C[L].anchor,C[L].head,"drag");r.replaceSelection(k,"around","paste"),r.display.input.focus()}}catch{}}}}function dg(e,r){if(p&&(!e.state.draggingText||+new Date-Df<100)){$r(r);return}if(!(Wt(e,r)||ai(e.display,r))&&(r.dataTransfer.setData("Text",e.getSelection()),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage&&!D)){var l=U("img",null,null,"position: fixed; left: 0; top: 0;");l.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",A&&(l.width=l.height=1,e.display.wrapper.appendChild(l),l._top=l.offsetTop),r.dataTransfer.setDragImage(l,0,0),A&&l.parentNode.removeChild(l)}}function pg(e,r){var l=Yi(e,r);if(l){var o=document.createDocumentFragment();rl(e,l,o),e.display.dragCursor||(e.display.dragCursor=U("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),lt(e.display.dragCursor,o)}}function Nf(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Pf(e){if(document.getElementsByClassName){for(var r=document.getElementsByClassName("CodeMirror"),l=[],o=0;o<r.length;o++){var a=r[o].CodeMirror;a&&l.push(a)}l.length&&l[0].operation(function(){for(var c=0;c<l.length;c++)e(l[c])})}}var Ef=!1;function gg(){Ef||(mg(),Ef=!0)}function mg(){var e;Z(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Pf(vg)},100))}),Z(window,"blur",function(){return Pf(br)})}function vg(e){var r=e.display;r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.scrollbarsClipped=!1,e.setSize()}for(var Mi={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Sn=0;Sn<10;Sn++)Mi[Sn+48]=Mi[Sn+96]=String(Sn);for(var Ts=65;Ts<=90;Ts++)Mi[Ts]=String.fromCharCode(Ts);for(var kn=1;kn<=12;kn++)Mi[kn+111]=Mi[kn+63235]="F"+kn;var fi={};fi.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},fi.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},fi.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},fi.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},fi.default=V?fi.macDefault:fi.pcDefault;function yg(e){var r=e.split(/-(?!$)/);e=r[r.length-1];for(var l,o,a,c,g=0;g<r.length-1;g++){var m=r[g];if(/^(cmd|meta|m)$/i.test(m))c=!0;else if(/^a(lt)?$/i.test(m))l=!0;else if(/^(c|ctrl|control)$/i.test(m))o=!0;else if(/^s(hift)?$/i.test(m))a=!0;else throw new Error("Unrecognized modifier name: "+m)}return l&&(e="Alt-"+e),o&&(e="Ctrl-"+e),c&&(e="Cmd-"+e),a&&(e="Shift-"+e),e}function bg(e){var r={};for(var l in e)if(e.hasOwnProperty(l)){var o=e[l];if(/^(name|fallthrough|(de|at)tach)$/.test(l))continue;if(o=="..."){delete e[l];continue}for(var a=$n(l.split(" "),yg),c=0;c<a.length;c++){var g=void 0,m=void 0;c==a.length-1?(m=a.join(" "),g=o):(m=a.slice(0,c+1).join(" "),g="...");var y=r[m];if(!y)r[m]=g;else if(y!=g)throw new Error("Inconsistent bindings for "+m)}delete e[l]}for(var w in r)e[w]=r[w];return e}function Tr(e,r,l,o){r=Ls(r);var a=r.call?r.call(e,o):r[e];if(a===!1)return"nothing";if(a==="...")return"multi";if(a!=null&&l(a))return"handled";if(r.fallthrough){if(Object.prototype.toString.call(r.fallthrough)!="[object Array]")return Tr(e,r.fallthrough,l,o);for(var c=0;c<r.fallthrough.length;c++){var g=Tr(e,r.fallthrough[c],l,o);if(g)return g}}}function Bf(e){var r=typeof e=="string"?e:Mi[e.keyCode];return r=="Ctrl"||r=="Alt"||r=="Shift"||r=="Mod"}function Rf(e,r,l){var o=e;return r.altKey&&o!="Alt"&&(e="Alt-"+e),(yt?r.metaKey:r.ctrlKey)&&o!="Ctrl"&&(e="Ctrl-"+e),(yt?r.ctrlKey:r.metaKey)&&o!="Mod"&&(e="Cmd-"+e),!l&&r.shiftKey&&o!="Shift"&&(e="Shift-"+e),e}function Hf(e,r){if(A&&e.keyCode==34&&e.char)return!1;var l=Mi[e.keyCode];return l==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(l=e.code),Rf(l,e,r))}function Ls(e){return typeof e=="string"?fi[e]:e}function Lr(e,r){for(var l=e.doc.sel.ranges,o=[],a=0;a<l.length;a++){for(var c=r(l[a]);o.length&&$(c.from,dt(o).to)<=0;){var g=o.pop();if($(g.from,c.from)<0){c.from=g.from;break}}o.push(c)}we(e,function(){for(var m=o.length-1;m>=0;m--)Mr(e.doc,"",o[m].from,o[m].to,"+delete");wr(e)})}function wl(e,r,l){var o=Ja(e.text,r+l,l);return o<0||o>e.text.length?null:o}function xl(e,r,l){var o=wl(e,r.ch,l);return o==null?null:new B(r.line,o,l<0?"after":"before")}function Sl(e,r,l,o,a){if(e){r.doc.direction=="rtl"&&(a=-a);var c=si(l,r.doc.direction);if(c){var g=a<0?dt(c):c[0],m=a<0==(g.level==1),y=m?"after":"before",w;if(g.level>0||r.doc.direction=="rtl"){var k=mr(r,l);w=a<0?l.text.length-1:0;var C=Xe(r,k,w).top;w=Jr(function(L){return Xe(r,k,L).top==C},a<0==(g.level==1)?g.from:g.to-1,w),y=="before"&&(w=wl(l,w,1))}else w=a<0?g.to:g.from;return new B(o,w,y)}}return new B(o,a<0?l.text.length:0,a<0?"before":"after")}function wg(e,r,l,o){var a=si(r,e.doc.direction);if(!a)return xl(r,l,o);l.ch>=r.text.length?(l.ch=r.text.length,l.sticky="before"):l.ch<=0&&(l.ch=0,l.sticky="after");var c=Qr(a,l.ch,l.sticky),g=a[c];if(e.doc.direction=="ltr"&&g.level%2==0&&(o>0?g.to>l.ch:g.from<l.ch))return xl(r,l,o);var m=function(H,F){return wl(r,H instanceof B?H.ch:H,F)},y,w=function(H){return e.options.lineWrapping?(y=y||mr(e,r),zh(e,r,y,H)):{begin:0,end:r.text.length}},k=w(l.sticky=="before"?m(l,-1):l.ch);if(e.doc.direction=="rtl"||g.level==1){var C=g.level==1==o<0,L=m(l,C?1:-1);if(L!=null&&(C?L<=g.to&&L<=k.end:L>=g.from&&L>=k.begin)){var T=C?"before":"after";return new B(l.line,L,T)}}var O=function(H,F,I){for(var K=function(wt,Ut){return Ut?new B(l.line,m(wt,1),"before"):new B(l.line,wt,"after")};H>=0&&H<a.length;H+=F){var J=a[H],X=F>0==(J.level!=1),rt=X?I.begin:m(I.end,-1);if(J.from<=rt&&rt<J.to||(rt=X?J.from:m(J.to,-1),I.begin<=rt&&rt<I.end))return K(rt,X)}},E=O(c+o,o,k);if(E)return E;var R=o>0?k.end:m(k.begin,-1);return R!=null&&!(o>0&&R==r.text.length)&&(E=O(o>0?0:a.length-1,o,w(R)),E)?E:null}var Cn={selectAll:wf,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ge)},killLine:function(e){return Lr(e,function(r){if(r.empty()){var l=q(e.doc,r.head.line).text.length;return r.head.ch==l&&r.head.line<e.lastLine()?{from:r.head,to:B(r.head.line+1,0)}:{from:r.head,to:B(r.head.line,l)}}else return{from:r.from(),to:r.to()}})},deleteLine:function(e){return Lr(e,function(r){return{from:B(r.from().line,0),to:tt(e.doc,B(r.to().line+1,0))}})},delLineLeft:function(e){return Lr(e,function(r){return{from:B(r.from().line,0),to:r.from()}})},delWrappedLineLeft:function(e){return Lr(e,function(r){var l=e.charCoords(r.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return{from:o,to:r.from()}})},delWrappedLineRight:function(e){return Lr(e,function(r){var l=e.charCoords(r.head,"div").top+5,o=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div");return{from:r.from(),to:o}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(B(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(B(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(r){return If(e,r.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(r){return Wf(e,r.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(r){return xg(e,r.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(r){var l=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:l},"div")},jr)},goLineLeft:function(e){return e.extendSelectionsBy(function(r){var l=e.cursorCoords(r.head,"div").top+5;return e.coordsChar({left:0,top:l},"div")},jr)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(r){var l=e.cursorCoords(r.head,"div").top+5,o=e.coordsChar({left:0,top:l},"div");return o.ch<e.getLine(o.line).search(/\S/)?Wf(e,r.head):o},jr)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var r=[],l=e.listSelections(),o=e.options.tabSize,a=0;a<l.length;a++){var c=l[a].from(),g=Ne(e.getLine(c.line),c.ch,o);r.push(So(o-g%o))}e.replaceSelections(r)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return we(e,function(){for(var r=e.listSelections(),l=[],o=0;o<r.length;o++)if(r[o].empty()){var a=r[o].head,c=q(e.doc,a.line).text;if(c){if(a.ch==c.length&&(a=new B(a.line,a.ch-1)),a.ch>0)a=new B(a.line,a.ch+1),e.replaceRange(c.charAt(a.ch-1)+c.charAt(a.ch-2),B(a.line,a.ch-2),a,"+transpose");else if(a.line>e.doc.first){var g=q(e.doc,a.line-1).text;g&&(a=new B(a.line,1),e.replaceRange(c.charAt(0)+e.doc.lineSeparator()+g.charAt(g.length-1),B(a.line-1,g.length-1),a,"+transpose"))}}l.push(new ft(a,a))}e.setSelections(l)})},newlineAndIndent:function(e){return we(e,function(){for(var r=e.listSelections(),l=r.length-1;l>=0;l--)e.replaceRange(e.doc.lineSeparator(),r[l].anchor,r[l].head,"+input");r=e.listSelections();for(var o=0;o<r.length;o++)e.indentLine(r[o].from().line,null,!0);wr(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function If(e,r){var l=q(e.doc,r),o=Ie(l);return o!=l&&(r=gt(o)),Sl(!0,e,o,r,1)}function xg(e,r){var l=q(e.doc,r),o=np(l);return o!=l&&(r=gt(o)),Sl(!0,e,l,r,-1)}function Wf(e,r){var l=If(e,r.line),o=q(e.doc,l.line),a=si(o,e.doc.direction);if(!a||a[0].level==0){var c=Math.max(l.ch,o.text.search(/\S/)),g=r.line==l.line&&r.ch<=c&&r.ch;return B(l.line,g?0:c,l.sticky)}return l}function Os(e,r,l){if(typeof r=="string"&&(r=Cn[r],!r))return!1;e.display.input.ensurePolled();var o=e.display.shift,a=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),l&&(e.display.shift=!1),a=r(e)!=Zn}finally{e.display.shift=o,e.state.suppressEdits=!1}return a}function Sg(e,r,l){for(var o=0;o<e.state.keyMaps.length;o++){var a=Tr(r,e.state.keyMaps[o],l,e);if(a)return a}return e.options.extraKeys&&Tr(r,e.options.extraKeys,l,e)||Tr(r,e.options.keyMap,l,e)}var kg=new vi;function Mn(e,r,l,o){var a=e.state.keySeq;if(a){if(Bf(r))return"handled";if(/\'$/.test(r)?e.state.keySeq=null:kg.set(50,function(){e.state.keySeq==a&&(e.state.keySeq=null,e.display.input.reset())}),Ff(e,a+" "+r,l,o))return!0}return Ff(e,r,l,o)}function Ff(e,r,l,o){var a=Sg(e,r,o);return a=="multi"&&(e.state.keySeq=r),a=="handled"&&Ft(e,"keyHandled",e,r,l),(a=="handled"||a=="multi")&&(fe(l),nl(e)),!!a}function zf(e,r){var l=Hf(r,!0);return l?r.shiftKey&&!e.state.keySeq?Mn(e,"Shift-"+l,r,function(o){return Os(e,o,!0)})||Mn(e,l,r,function(o){if(typeof o=="string"?/^go[A-Z]/.test(o):o.motion)return Os(e,o)}):Mn(e,l,r,function(o){return Os(e,o)}):!1}function Cg(e,r,l){return Mn(e,"'"+l+"'",r,function(o){return Os(e,o,!0)})}var kl=null;function Kf(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&(r.curOp.focus=he(Ce(r)),!Wt(r,e))){p&&v<11&&e.keyCode==27&&(e.returnValue=!1);var l=e.keyCode;r.display.shift=l==16||e.shiftKey;var o=zf(r,e);A&&(kl=o?l:null,!o&&l==88&&!Ud&&(V?e.metaKey:e.ctrlKey)&&r.replaceSelection("",null,"cut")),s&&!V&&!o&&l==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),l==18&&!/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)&&Mg(r)}}function Mg(e){var r=e.display.lineDiv;Xt(r,"CodeMirror-crosshair");function l(o){(o.keyCode==18||!o.altKey)&&(it(r,"CodeMirror-crosshair"),Me(document,"keyup",l),Me(document,"mouseover",l))}Z(document,"keyup",l),Z(document,"mouseover",l)}function Uf(e){e.keyCode==16&&(this.doc.sel.shift=!1),Wt(this,e)}function Gf(e){var r=this;if(!(e.target&&e.target!=r.display.input.getField())&&!(ai(r.display,e)||Wt(r,e)||e.ctrlKey&&!e.altKey||V&&e.metaKey)){var l=e.keyCode,o=e.charCode;if(A&&l==kl){kl=null,fe(e);return}if(!(A&&(!e.which||e.which<10)&&zf(r,e))){var a=String.fromCharCode(o??l);a!="\b"&&(Cg(r,e,a)||r.display.input.onKeyPress(e))}}}var Ag=400,Cl=function(e,r,l){this.time=e,this.pos=r,this.button=l};Cl.prototype.compare=function(e,r,l){return this.time+Ag>e&&$(r,this.pos)==0&&l==this.button};var An,Tn;function Tg(e,r){var l=+new Date;return Tn&&Tn.compare(l,e,r)?(An=Tn=null,"triple"):An&&An.compare(l,e,r)?(Tn=new Cl(l,e,r),An=null,"double"):(An=new Cl(l,e,r),Tn=null,"single")}function Vf(e){var r=this,l=r.display;if(!(Wt(r,e)||l.activeTouch&&l.input.supportsTouch())){if(l.input.ensurePolled(),l.shift=e.shiftKey,ai(l,e)){b||(l.scroller.draggable=!1,setTimeout(function(){return l.scroller.draggable=!0},100));return}if(!Ml(r,e)){var o=Yi(r,e),a=th(e),c=o?Tg(o,a):"single";Fi(r).focus(),a==1&&r.state.selectingText&&r.state.selectingText(e),!(o&&Lg(r,a,o,c,e))&&(a==1?o?Dg(r,o,c,e):To(e)==l.scroller&&fe(e):a==2?(o&&ks(r.doc,o),setTimeout(function(){return l.input.focus()},20)):a==3&&(at?r.display.input.onContextMenu(e):sl(r)))}}}function Lg(e,r,l,o,a){var c="Click";return o=="double"?c="Double"+c:o=="triple"&&(c="Triple"+c),c=(r==1?"Left":r==2?"Middle":"Right")+c,Mn(e,Rf(c,a),a,function(g){if(typeof g=="string"&&(g=Cn[g]),!g)return!1;var m=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),m=g(e,l)!=Zn}finally{e.state.suppressEdits=!1}return m})}function Og(e,r,l){var o=e.getOption("configureMouse"),a=o?o(e,r,l):{};if(a.unit==null){var c=st?l.shiftKey&&l.metaKey:l.altKey;a.unit=c?"rectangle":r=="single"?"char":r=="double"?"word":"line"}return(a.extend==null||e.doc.extend)&&(a.extend=e.doc.extend||l.shiftKey),a.addNew==null&&(a.addNew=V?l.metaKey:l.ctrlKey),a.moveOnDrag==null&&(a.moveOnDrag=!(V?l.altKey:l.ctrlKey)),a}function Dg(e,r,l,o){p?setTimeout(bo(Vh,e),0):e.curOp.focus=he(Ce(e));var a=Og(e,l,o),c=e.doc.sel,g;e.options.dragDrop&&Wd&&!e.isReadOnly()&&l=="single"&&(g=c.contains(r))>-1&&($((g=c.ranges[g]).from(),r)<0||r.xRel>0)&&($(g.to(),r)>0||r.xRel<0)?Ng(e,o,r,a):Pg(e,o,r,a)}function Ng(e,r,l,o){var a=e.display,c=!1,g=zt(e,function(w){b&&(a.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:sl(e)),Me(a.wrapper.ownerDocument,"mouseup",g),Me(a.wrapper.ownerDocument,"mousemove",m),Me(a.scroller,"dragstart",y),Me(a.scroller,"drop",g),c||(fe(w),o.addNew||ks(e.doc,l,null,null,o.extend),b&&!D||p&&v==9?setTimeout(function(){a.wrapper.ownerDocument.body.focus({preventScroll:!0}),a.input.focus()},20):a.input.focus())}),m=function(w){c=c||Math.abs(r.clientX-w.clientX)+Math.abs(r.clientY-w.clientY)>=10},y=function(){return c=!0};b&&(a.scroller.draggable=!0),e.state.draggingText=g,g.copy=!o.moveOnDrag,Z(a.wrapper.ownerDocument,"mouseup",g),Z(a.wrapper.ownerDocument,"mousemove",m),Z(a.scroller,"dragstart",y),Z(a.scroller,"drop",g),e.state.delayingBlurEvent=!0,setTimeout(function(){return a.input.focus()},20),a.scroller.dragDrop&&a.scroller.dragDrop()}function qf(e,r,l){if(l=="char")return new ft(r,r);if(l=="word")return e.findWordAt(r);if(l=="line")return new ft(B(r.line,0),tt(e.doc,B(r.line+1,0)));var o=l(e,r);return new ft(o.from,o.to)}function Pg(e,r,l,o){p&&sl(e);var a=e.display,c=e.doc;fe(r);var g,m,y=c.sel,w=y.ranges;if(o.addNew&&!o.extend?(m=c.sel.contains(l),m>-1?g=w[m]:g=new ft(l,l)):(g=c.sel.primary(),m=c.sel.primIndex),o.unit=="rectangle")o.addNew||(g=new ft(l,l)),l=Yi(e,r,!0,!0),m=-1;else{var k=qf(e,l,o.unit);o.extend?g=yl(g,k.anchor,k.head,o.extend):g=k}o.addNew?m==-1?(m=w.length,jt(c,Fe(e,w.concat([g]),m),{scroll:!1,origin:"*mouse"})):w.length>1&&w[m].empty()&&o.unit=="char"&&!o.extend?(jt(c,Fe(e,w.slice(0,m).concat(w.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),y=c.sel):bl(c,m,g,wo):(m=0,jt(c,new Ae([g],0),wo),y=c.sel);var C=l;function L(I){if($(C,I)!=0)if(C=I,o.unit=="rectangle"){for(var K=[],J=e.options.tabSize,X=Ne(q(c,l.line).text,l.ch,J),rt=Ne(q(c,I.line).text,I.ch,J),wt=Math.min(X,rt),Ut=Math.max(X,rt),At=Math.min(l.line,I.line),xe=Math.min(e.lastLine(),Math.max(l.line,I.line));At<=xe;At++){var de=q(c,At).text,Nt=xo(de,wt,J);wt==Ut?K.push(new ft(B(At,Nt),B(At,Nt))):de.length>Nt&&K.push(new ft(B(At,Nt),B(At,xo(de,Ut,J))))}K.length||K.push(new ft(l,l)),jt(c,Fe(e,y.ranges.slice(0,m).concat(K),m),{origin:"*mouse",scroll:!1}),e.scrollIntoView(I)}else{var pe=g,Vt=qf(e,I,o.unit),Bt=pe.anchor,Pt;$(Vt.anchor,Bt)>0?(Pt=Vt.head,Bt=rs(pe.from(),Vt.anchor)):(Pt=Vt.anchor,Bt=is(pe.to(),Vt.head));var Tt=y.ranges.slice(0);Tt[m]=Eg(e,new ft(tt(c,Bt),Pt)),jt(c,Fe(e,Tt,m),wo)}}var T=a.wrapper.getBoundingClientRect(),O=0;function E(I){var K=++O,J=Yi(e,I,!0,o.unit=="rectangle");if(J)if($(J,C)!=0){e.curOp.focus=he(Ce(e)),L(J);var X=vs(a,c);(J.line>=X.to||J.line<X.from)&&setTimeout(zt(e,function(){O==K&&E(I)}),150)}else{var rt=I.clientY<T.top?-20:I.clientY>T.bottom?20:0;rt&&setTimeout(zt(e,function(){O==K&&(a.scroller.scrollTop+=rt,E(I))}),50)}}function R(I){e.state.selectingText=!1,O=1/0,I&&(fe(I),a.input.focus()),Me(a.wrapper.ownerDocument,"mousemove",H),Me(a.wrapper.ownerDocument,"mouseup",F),c.history.lastSelOrigin=null}var H=zt(e,function(I){I.buttons===0||!th(I)?R(I):E(I)}),F=zt(e,R);e.state.selectingText=F,Z(a.wrapper.ownerDocument,"mousemove",H),Z(a.wrapper.ownerDocument,"mouseup",F)}function Eg(e,r){var l=r.anchor,o=r.head,a=q(e.doc,l.line);if($(l,o)==0&&l.sticky==o.sticky)return r;var c=si(a);if(!c)return r;var g=Qr(c,l.ch,l.sticky),m=c[g];if(m.from!=l.ch&&m.to!=l.ch)return r;var y=g+(m.from==l.ch==(m.level!=1)?0:1);if(y==0||y==c.length)return r;var w;if(o.line!=l.line)w=(o.line-l.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var k=Qr(c,o.ch,o.sticky),C=k-g||(o.ch-l.ch)*(m.level==1?-1:1);k==y-1||k==y?w=C<0:w=C>0}var L=c[y+(w?-1:0)],T=w==(L.level==1),O=T?L.from:L.to,E=T?"after":"before";return l.ch==O&&l.sticky==E?r:new ft(new B(l.line,O,E),o)}function Yf(e,r,l,o){var a,c;if(r.touches)a=r.touches[0].clientX,c=r.touches[0].clientY;else try{a=r.clientX,c=r.clientY}catch{return!1}if(a>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;o&&fe(r);var g=e.display,m=g.lineDiv.getBoundingClientRect();if(c>m.bottom||!Pe(e,l))return Ao(r);c-=m.top-g.viewOffset;for(var y=0;y<e.display.gutterSpecs.length;++y){var w=g.gutters.childNodes[y];if(w&&w.getBoundingClientRect().right>=a){var k=Gi(e.doc,c),C=e.display.gutterSpecs[y];return Ot(e,l,e,k,C.className,r),Ao(r)}}}function Ml(e,r){return Yf(e,r,"gutterClick",!0)}function Xf(e,r){ai(e.display,r)||Bg(e,r)||Wt(e,r,"contextmenu")||at||e.display.input.onContextMenu(r)}function Bg(e,r){return Pe(e,"gutterContextMenu")?Yf(e,r,"gutterContextMenu",!1):!1}function _f(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),ln(e)}var Or={toString:function(){return"CodeMirror.Init"}},jf={},Ds={};function Rg(e){var r=e.optionHandlers;function l(o,a,c,g){e.defaults[o]=a,c&&(r[o]=g?function(m,y,w){w!=Or&&c(m,y,w)}:c)}e.defineOption=l,e.Init=Or,l("value","",function(o,a){return o.setValue(a)},!0),l("mode",null,function(o,a){o.doc.modeOption=a,gl(o)},!0),l("indentUnit",2,gl,!0),l("indentWithTabs",!1),l("smartIndent",!0),l("tabSize",4,function(o){gn(o),ln(o),ue(o)},!0),l("lineSeparator",null,function(o,a){if(o.doc.lineSep=a,!!a){var c=[],g=o.doc.first;o.doc.iter(function(y){for(var w=0;;){var k=y.text.indexOf(a,w);if(k==-1)break;w=k+a.length,c.push(B(g,k))}g++});for(var m=c.length-1;m>=0;m--)Mr(o.doc,a,c[m],B(c[m].line,c[m].ch+a.length))}}),l("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,function(o,a,c){o.state.specialChars=new RegExp(a.source+(a.test("	")?"":"|	"),"g"),c!=Or&&o.refresh()}),l("specialCharPlaceholder",fp,function(o){return o.refresh()},!0),l("electricChars",!0),l("inputStyle",Y?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),l("spellcheck",!1,function(o,a){return o.getInputField().spellcheck=a},!0),l("autocorrect",!1,function(o,a){return o.getInputField().autocorrect=a},!0),l("autocapitalize",!1,function(o,a){return o.getInputField().autocapitalize=a},!0),l("rtlMoveVisually",!Q),l("wholeLineUpdateBefore",!0),l("theme","default",function(o){_f(o),pn(o)},!0),l("keyMap","default",function(o,a,c){var g=Ls(a),m=c!=Or&&Ls(c);m&&m.detach&&m.detach(o,g),g.attach&&g.attach(o,m||null)}),l("extraKeys",null),l("configureMouse",null),l("lineWrapping",!1,Ig,!0),l("gutters",[],function(o,a){o.display.gutterSpecs=dl(a,o.options.lineNumbers),pn(o)},!0),l("fixedGutter",!0,function(o,a){o.display.gutters.style.left=a?el(o.display)+"px":"0",o.refresh()},!0),l("coverGutterNextToScrollbar",!1,function(o){return xr(o)},!0),l("scrollbarStyle","native",function(o){Jh(o),xr(o),o.display.scrollbars.setScrollTop(o.doc.scrollTop),o.display.scrollbars.setScrollLeft(o.doc.scrollLeft)},!0),l("lineNumbers",!1,function(o,a){o.display.gutterSpecs=dl(o.options.gutters,a),pn(o)},!0),l("firstLineNumber",1,pn,!0),l("lineNumberFormatter",function(o){return o},pn,!0),l("showCursorWhenSelecting",!1,an,!0),l("resetSelectionOnContextMenu",!0),l("lineWiseCopyCut",!0),l("pasteLinesPerSelection",!0),l("selectionsMayTouch",!1),l("readOnly",!1,function(o,a){a=="nocursor"&&(br(o),o.display.input.blur()),o.display.input.readOnlyChanged(a)}),l("screenReaderLabel",null,function(o,a){a=a===""?null:a,o.display.input.screenReaderLabelChanged(a)}),l("disableInput",!1,function(o,a){a||o.display.input.reset()},!0),l("dragDrop",!0,Hg),l("allowDropFileTypes",null),l("cursorBlinkRate",530),l("cursorScrollMargin",0),l("cursorHeight",1,an,!0),l("singleCursorHeightPerLine",!0,an,!0),l("workTime",100),l("workDelay",100),l("flattenSpans",!0,gn,!0),l("addModeClass",!1,gn,!0),l("pollInterval",100),l("undoDepth",200,function(o,a){return o.doc.history.undoDepth=a}),l("historyEventDelay",1250),l("viewportMargin",10,function(o){return o.refresh()},!0),l("maxHighlightLength",1e4,gn,!0),l("moveInputWithCursor",!0,function(o,a){a||o.display.input.resetPosition()}),l("tabindex",null,function(o,a){return o.display.input.getField().tabIndex=a||""}),l("autofocus",null),l("direction","ltr",function(o,a){return o.doc.setDirection(a)},!0),l("phrases",null)}function Hg(e,r,l){var o=l&&l!=Or;if(!r!=!o){var a=e.display.dragFunctions,c=r?Z:Me;c(e.display.scroller,"dragstart",a.start),c(e.display.scroller,"dragenter",a.enter),c(e.display.scroller,"dragover",a.over),c(e.display.scroller,"dragleave",a.leave),c(e.display.scroller,"drop",a.drop)}}function Ig(e){e.options.lineWrapping?(Xt(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(it(e.display.wrapper,"CodeMirror-wrap"),qo(e)),il(e),ue(e),ln(e),setTimeout(function(){return xr(e)},100)}function Ct(e,r){var l=this;if(!(this instanceof Ct))return new Ct(e,r);this.options=r=r?zi(r):{},zi(jf,r,!1);var o=r.value;typeof o=="string"?o=new ce(o,r.mode,null,r.lineSeparator,r.direction):r.mode&&(o.modeOption=r.mode),this.doc=o;var a=new Ct.inputStyles[r.inputStyle](this),c=this.display=new Jp(e,o,a,r);c.wrapper.CodeMirror=this,_f(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Jh(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new vi,keySeq:null,specialChars:null},r.autofocus&&!Y&&c.input.focus(),p&&v<11&&setTimeout(function(){return l.display.input.reset(!0)},20),Wg(this),gg(),Ji(this),this.curOp.forceUpdate=!0,lf(this,o),r.autofocus&&!Y||this.hasFocus()?setTimeout(function(){l.hasFocus()&&!l.state.focused&&ol(l)},20):br(this);for(var g in Ds)Ds.hasOwnProperty(g)&&Ds[g](this,r[g],Or);$h(this),r.finishInit&&r.finishInit(this);for(var m=0;m<Al.length;++m)Al[m](this);Zi(this),b&&r.lineWrapping&&getComputedStyle(c.lineDiv).textRendering=="optimizelegibility"&&(c.lineDiv.style.textRendering="auto")}Ct.defaults=jf,Ct.optionHandlers=Ds;function Wg(e){var r=e.display;Z(r.scroller,"mousedown",zt(e,Vf)),p&&v<11?Z(r.scroller,"dblclick",zt(e,function(y){if(!Wt(e,y)){var w=Yi(e,y);if(!(!w||Ml(e,y)||ai(e.display,y))){fe(y);var k=e.findWordAt(w);ks(e.doc,k.anchor,k.head)}}})):Z(r.scroller,"dblclick",function(y){return Wt(e,y)||fe(y)}),Z(r.scroller,"contextmenu",function(y){return Xf(e,y)}),Z(r.input.getField(),"contextmenu",function(y){r.scroller.contains(y.target)||Xf(e,y)});var l,o={end:0};function a(){r.activeTouch&&(l=setTimeout(function(){return r.activeTouch=null},1e3),o=r.activeTouch,o.end=+new Date)}function c(y){if(y.touches.length!=1)return!1;var w=y.touches[0];return w.radiusX<=1&&w.radiusY<=1}function g(y,w){if(w.left==null)return!0;var k=w.left-y.left,C=w.top-y.top;return k*k+C*C>20*20}Z(r.scroller,"touchstart",function(y){if(!Wt(e,y)&&!c(y)&&!Ml(e,y)){r.input.ensurePolled(),clearTimeout(l);var w=+new Date;r.activeTouch={start:w,moved:!1,prev:w-o.end<=300?o:null},y.touches.length==1&&(r.activeTouch.left=y.touches[0].pageX,r.activeTouch.top=y.touches[0].pageY)}}),Z(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),Z(r.scroller,"touchend",function(y){var w=r.activeTouch;if(w&&!ai(r,y)&&w.left!=null&&!w.moved&&new Date-w.start<300){var k=e.coordsChar(r.activeTouch,"page"),C;!w.prev||g(w,w.prev)?C=new ft(k,k):!w.prev.prev||g(w,w.prev.prev)?C=e.findWordAt(k):C=new ft(B(k.line,0),tt(e.doc,B(k.line+1,0))),e.setSelection(C.anchor,C.head),e.focus(),fe(y)}a()}),Z(r.scroller,"touchcancel",a),Z(r.scroller,"scroll",function(){r.scroller.clientHeight&&(fn(e,r.scroller.scrollTop),_i(e,r.scroller.scrollLeft,!0),Ot(e,"scroll",e))}),Z(r.scroller,"mousewheel",function(y){return rf(e,y)}),Z(r.scroller,"DOMMouseScroll",function(y){return rf(e,y)}),Z(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(y){Wt(e,y)||$r(y)},over:function(y){Wt(e,y)||(pg(e,y),$r(y))},start:function(y){return dg(e,y)},drop:zt(e,cg),leave:function(y){Wt(e,y)||Nf(e)}};var m=r.input.getField();Z(m,"keyup",function(y){return Uf.call(e,y)}),Z(m,"keydown",zt(e,Kf)),Z(m,"keypress",zt(e,Gf)),Z(m,"focus",function(y){return ol(e,y)}),Z(m,"blur",function(y){return br(e,y)})}var Al=[];Ct.defineInitHook=function(e){return Al.push(e)};function Ln(e,r,l,o){var a=e.doc,c;l==null&&(l="add"),l=="smart"&&(a.mode.indent?c=en(e,r).state:l="prev");var g=e.options.tabSize,m=q(a,r),y=Ne(m.text,null,g);m.stateAfter&&(m.stateAfter=null);var w=m.text.match(/^\s*/)[0],k;if(!o&&!/\S/.test(m.text))k=0,l="not";else if(l=="smart"&&(k=a.mode.indent(c,m.text.slice(w.length),m.text),k==Zn||k>150)){if(!o)return;l="prev"}l=="prev"?r>a.first?k=Ne(q(a,r-1).text,null,g):k=0:l=="add"?k=y+e.options.indentUnit:l=="subtract"?k=y-e.options.indentUnit:typeof l=="number"&&(k=y+l),k=Math.max(0,k);var C="",L=0;if(e.options.indentWithTabs)for(var T=Math.floor(k/g);T;--T)L+=g,C+="	";if(L<k&&(C+=So(k-L)),C!=w)return Mr(a,C,B(r,0),B(r,w.length),"+input"),m.stateAfter=null,!0;for(var O=0;O<a.sel.ranges.length;O++){var E=a.sel.ranges[O];if(E.head.line==r&&E.head.ch<w.length){var R=B(r,w.length);bl(a,O,new ft(R,R));break}}}var ze=null;function Ns(e){ze=e}function Tl(e,r,l,o,a){var c=e.doc;e.display.shift=!1,o||(o=c.sel);var g=+new Date-200,m=a=="paste"||e.state.pasteIncoming>g,y=Do(r),w=null;if(m&&o.ranges.length>1)if(ze&&ze.text.join(`
`)==r){if(o.ranges.length%ze.text.length==0){w=[];for(var k=0;k<ze.text.length;k++)w.push(c.splitLines(ze.text[k]))}}else y.length==o.ranges.length&&e.options.pasteLinesPerSelection&&(w=$n(y,function(H){return[H]}));for(var C=e.curOp.updateInput,L=o.ranges.length-1;L>=0;L--){var T=o.ranges[L],O=T.from(),E=T.to();T.empty()&&(l&&l>0?O=B(O.line,O.ch-l):e.state.overwrite&&!m?E=B(E.line,Math.min(q(c,E.line).text.length,E.ch+dt(y).length)):m&&ze&&ze.lineWise&&ze.text.join(`
`)==y.join(`
`)&&(O=E=B(O.line,0)));var R={from:O,to:E,text:w?w[L%w.length]:y,origin:a||(m?"paste":e.state.cutIncoming>g?"cut":"+input")};Cr(e.doc,R),Ft(e,"inputRead",e,R)}r&&!m&&Zf(e,r),wr(e),e.curOp.updateInput<2&&(e.curOp.updateInput=C),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Jf(e,r){var l=e.clipboardData&&e.clipboardData.getData("Text");if(l)return e.preventDefault(),!r.isReadOnly()&&!r.options.disableInput&&r.hasFocus()&&we(r,function(){return Tl(r,l,0,null,"paste")}),!0}function Zf(e,r){if(!(!e.options.electricChars||!e.options.smartIndent))for(var l=e.doc.sel,o=l.ranges.length-1;o>=0;o--){var a=l.ranges[o];if(!(a.head.ch>100||o&&l.ranges[o-1].head.line==a.head.line)){var c=e.getModeAt(a.head),g=!1;if(c.electricChars){for(var m=0;m<c.electricChars.length;m++)if(r.indexOf(c.electricChars.charAt(m))>-1){g=Ln(e,a.head.line,"smart");break}}else c.electricInput&&c.electricInput.test(q(e.doc,a.head.line).text.slice(0,a.head.ch))&&(g=Ln(e,a.head.line,"smart"));g&&Ft(e,"electricInput",e,a.head.line)}}}function Qf(e){for(var r=[],l=[],o=0;o<e.doc.sel.ranges.length;o++){var a=e.doc.sel.ranges[o].head.line,c={anchor:B(a,0),head:B(a+1,0)};l.push(c),r.push(e.getRange(c.anchor,c.head))}return{text:r,ranges:l}}function Ll(e,r,l,o){e.setAttribute("autocorrect",l?"on":"off"),e.setAttribute("autocapitalize",o?"on":"off"),e.setAttribute("spellcheck",!!r)}function $f(){var e=U("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),r=U("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return b?e.style.width="1000px":e.setAttribute("wrap","off"),W&&(e.style.border="1px solid black"),r}function Fg(e){var r=e.optionHandlers,l=e.helpers={};e.prototype={constructor:e,focus:function(){Fi(this).focus(),this.display.input.focus()},setOption:function(o,a){var c=this.options,g=c[o];c[o]==a&&o!="mode"||(c[o]=a,r.hasOwnProperty(o)&&zt(this,r[o])(this,a,g),Ot(this,"optionChange",this,o))},getOption:function(o){return this.options[o]},getDoc:function(){return this.doc},addKeyMap:function(o,a){this.state.keyMaps[a?"push":"unshift"](Ls(o))},removeKeyMap:function(o){for(var a=this.state.keyMaps,c=0;c<a.length;++c)if(a[c]==o||a[c].name==o)return a.splice(c,1),!0},addOverlay:re(function(o,a){var c=o.token?o:e.getMode(this.options,o);if(c.startState)throw new Error("Overlays may not be stateful.");Ed(this.state.overlays,{mode:c,modeSpec:o,opaque:a&&a.opaque,priority:a&&a.priority||0},function(g){return g.priority}),this.state.modeGen++,ue(this)}),removeOverlay:re(function(o){for(var a=this.state.overlays,c=0;c<a.length;++c){var g=a[c].modeSpec;if(g==o||typeof o=="string"&&g.name==o){a.splice(c,1),this.state.modeGen++,ue(this);return}}}),indentLine:re(function(o,a,c){typeof a!="string"&&typeof a!="number"&&(a==null?a=this.options.smartIndent?"smart":"prev":a=a?"add":"subtract"),tn(this.doc,o)&&Ln(this,o,a,c)}),indentSelection:re(function(o){for(var a=this.doc.sel.ranges,c=-1,g=0;g<a.length;g++){var m=a[g];if(m.empty())m.head.line>c&&(Ln(this,m.head.line,o,!0),c=m.head.line,g==this.doc.sel.primIndex&&wr(this));else{var y=m.from(),w=m.to(),k=Math.max(c,y.line);c=Math.min(this.lastLine(),w.line-(w.ch?0:1))+1;for(var C=k;C<c;++C)Ln(this,C,o);var L=this.doc.sel.ranges;y.ch==0&&a.length==L.length&&L[g].from().ch>0&&bl(this.doc,g,new ft(y,L[g].to()),Ge)}}}),getTokenAt:function(o,a){return ah(this,o,a)},getLineTokens:function(o,a){return ah(this,B(o),a,!0)},getTokenTypeAt:function(o){o=tt(this.doc,o);var a=sh(this,q(this.doc,o.line)),c=0,g=(a.length-1)/2,m=o.ch,y;if(m==0)y=a[2];else for(;;){var w=c+g>>1;if((w?a[w*2-1]:0)>=m)g=w;else if(a[w*2+1]<m)c=w+1;else{y=a[w*2+2];break}}var k=y?y.indexOf("overlay "):-1;return k<0?y:k==0?null:y.slice(0,k-1)},getModeAt:function(o){var a=this.doc.mode;return a.innerMode?e.innerMode(a,this.getTokenAt(o).state).mode:a},getHelper:function(o,a){return this.getHelpers(o,a)[0]},getHelpers:function(o,a){var c=[];if(!l.hasOwnProperty(a))return c;var g=l[a],m=this.getModeAt(o);if(typeof m[a]=="string")g[m[a]]&&c.push(g[m[a]]);else if(m[a])for(var y=0;y<m[a].length;y++){var w=g[m[a][y]];w&&c.push(w)}else m.helperType&&g[m.helperType]?c.push(g[m.helperType]):g[m.name]&&c.push(g[m.name]);for(var k=0;k<g._global.length;k++){var C=g._global[k];C.pred(m,this)&&_t(c,C.val)==-1&&c.push(C.val)}return c},getStateAfter:function(o,a){var c=this.doc;return o=ih(c,o??c.first+c.size-1),en(this,o+1,a).state},cursorCoords:function(o,a){var c,g=this.doc.sel.primary();return o==null?c=g.head:typeof o=="object"?c=tt(this.doc,o):c=o?g.from():g.to(),We(this,c,a||"page")},charCoords:function(o,a){return ds(this,tt(this.doc,o),a||"page")},coordsChar:function(o,a){return o=Ih(this,o,a||"page"),Qo(this,o.left,o.top)},lineAtHeight:function(o,a){return o=Ih(this,{top:o,left:0},a||"page").top,Gi(this.doc,o+this.display.viewOffset)},heightAtLine:function(o,a,c){var g=!1,m;if(typeof o=="number"){var y=this.doc.first+this.doc.size-1;o<this.doc.first?o=this.doc.first:o>y&&(o=y,g=!0),m=q(this.doc,o)}else m=o;return cs(this,m,{top:0,left:0},a||"page",c||g).top+(g?this.doc.height-li(m):0)},defaultTextHeight:function(){return vr(this.display)},defaultCharWidth:function(){return yr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(o,a,c,g,m){var y=this.display;o=We(this,tt(this.doc,o));var w=o.bottom,k=o.left;if(a.style.position="absolute",a.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(a),y.sizer.appendChild(a),g=="over")w=o.top;else if(g=="above"||g=="near"){var C=Math.max(y.wrapper.clientHeight,this.doc.height),L=Math.max(y.sizer.clientWidth,y.lineSpace.clientWidth);(g=="above"||o.bottom+a.offsetHeight>C)&&o.top>a.offsetHeight?w=o.top-a.offsetHeight:o.bottom+a.offsetHeight<=C&&(w=o.bottom),k+a.offsetWidth>L&&(k=L-a.offsetWidth)}a.style.top=w+"px",a.style.left=a.style.right="",m=="right"?(k=y.sizer.clientWidth-a.offsetWidth,a.style.right="0px"):(m=="left"?k=0:m=="middle"&&(k=(y.sizer.clientWidth-a.offsetWidth)/2),a.style.left=k+"px"),c&&Hp(this,{left:k,top:w,right:k+a.offsetWidth,bottom:w+a.offsetHeight})},triggerOnKeyDown:re(Kf),triggerOnKeyPress:re(Gf),triggerOnKeyUp:Uf,triggerOnMouseDown:re(Vf),execCommand:function(o){if(Cn.hasOwnProperty(o))return Cn[o].call(null,this)},triggerElectric:re(function(o){Zf(this,o)}),findPosH:function(o,a,c,g){var m=1;a<0&&(m=-1,a=-a);for(var y=tt(this.doc,o),w=0;w<a&&(y=Ol(this.doc,y,m,c,g),!y.hitSide);++w);return y},moveH:re(function(o,a){var c=this;this.extendSelectionsBy(function(g){return c.display.shift||c.doc.extend||g.empty()?Ol(c.doc,g.head,o,a,c.options.rtlMoveVisually):o<0?g.from():g.to()},jr)}),deleteH:re(function(o,a){var c=this.doc.sel,g=this.doc;c.somethingSelected()?g.replaceSelection("",null,"+delete"):Lr(this,function(m){var y=Ol(g,m.head,o,a,!1);return o<0?{from:y,to:m.head}:{from:m.head,to:y}})}),findPosV:function(o,a,c,g){var m=1,y=g;a<0&&(m=-1,a=-a);for(var w=tt(this.doc,o),k=0;k<a;++k){var C=We(this,w,"div");if(y==null?y=C.left:C.left=y,w=tu(this,C,m,c),w.hitSide)break}return w},moveV:re(function(o,a){var c=this,g=this.doc,m=[],y=!this.display.shift&&!g.extend&&g.sel.somethingSelected();if(g.extendSelectionsBy(function(k){if(y)return o<0?k.from():k.to();var C=We(c,k.head,"div");k.goalColumn!=null&&(C.left=k.goalColumn),m.push(C.left);var L=tu(c,C,o,a);return a=="page"&&k==g.sel.primary()&&al(c,ds(c,L,"div").top-C.top),L},jr),m.length)for(var w=0;w<g.sel.ranges.length;w++)g.sel.ranges[w].goalColumn=m[w]}),findWordAt:function(o){var a=this.doc,c=q(a,o.line).text,g=o.ch,m=o.ch;if(c){var y=this.getHelper(o,"wordChars");(o.sticky=="before"||m==c.length)&&g?--g:++m;for(var w=c.charAt(g),k=ts(w,y)?function(C){return ts(C,y)}:/\s/.test(w)?function(C){return/\s/.test(C)}:function(C){return!/\s/.test(C)&&!ts(C)};g>0&&k(c.charAt(g-1));)--g;for(;m<c.length&&k(c.charAt(m));)++m}return new ft(B(o.line,g),B(o.line,m))},toggleOverwrite:function(o){o!=null&&o==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Xt(this.display.cursorDiv,"CodeMirror-overwrite"):it(this.display.cursorDiv,"CodeMirror-overwrite"),Ot(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==he(Ce(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:re(function(o,a){hn(this,o,a)}),getScrollInfo:function(){var o=this.display.scroller;return{left:o.scrollLeft,top:o.scrollTop,height:o.scrollHeight-Ye(this)-this.display.barHeight,width:o.scrollWidth-Ye(this)-this.display.barWidth,clientHeight:_o(this),clientWidth:Vi(this)}},scrollIntoView:re(function(o,a){o==null?(o={from:this.doc.sel.primary().head,to:null},a==null&&(a=this.options.cursorScrollMargin)):typeof o=="number"?o={from:B(o,0),to:null}:o.from==null&&(o={from:o,to:null}),o.to||(o.to=o.from),o.margin=a||0,o.from.line!=null?Ip(this,o):Yh(this,o.from,o.to,o.margin)}),setSize:re(function(o,a){var c=this,g=function(y){return typeof y=="number"||/^\d+$/.test(String(y))?y+"px":y};o!=null&&(this.display.wrapper.style.width=g(o)),a!=null&&(this.display.wrapper.style.height=g(a)),this.options.lineWrapping&&Bh(this);var m=this.display.viewFrom;this.doc.iter(m,this.display.viewTo,function(y){if(y.widgets){for(var w=0;w<y.widgets.length;w++)if(y.widgets[w].noHScroll){bi(c,m,"widget");break}}++m}),this.curOp.forceUpdate=!0,Ot(this,"refresh",this)}),operation:function(o){return we(this,o)},startOperation:function(){return Ji(this)},endOperation:function(){return Zi(this)},refresh:re(function(){var o=this.display.cachedTextHeight;ue(this),this.curOp.forceUpdate=!0,ln(this),hn(this,this.doc.scrollLeft,this.doc.scrollTop),ul(this.display),(o==null||Math.abs(o-vr(this.display))>.5||this.options.lineWrapping)&&il(this),Ot(this,"refresh",this)}),swapDoc:re(function(o){var a=this.doc;return a.cm=null,this.state.selectingText&&this.state.selectingText(),lf(this,o),ln(this),this.display.input.reset(),hn(this,o.scrollLeft,o.scrollTop),this.curOp.forceScroll=!0,Ft(this,"swapDoc",this,a),a}),phrase:function(o){var a=this.options.phrases;return a&&Object.prototype.hasOwnProperty.call(a,o)?a[o]:o},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},ur(e),e.registerHelper=function(o,a,c){l.hasOwnProperty(o)||(l[o]=e[o]={_global:[]}),l[o][a]=c},e.registerGlobalHelper=function(o,a,c,g){e.registerHelper(o,a,g),l[o]._global.push({pred:c,val:g})}}function Ol(e,r,l,o,a){var c=r,g=l,m=q(e,r.line),y=a&&e.direction=="rtl"?-l:l;function w(){var F=r.line+y;return F<e.first||F>=e.first+e.size?!1:(r=new B(F,r.ch,r.sticky),m=q(e,F))}function k(F){var I;if(o=="codepoint"){var K=m.text.charCodeAt(r.ch+(l>0?0:-1));if(isNaN(K))I=null;else{var J=l>0?K>=55296&&K<56320:K>=56320&&K<57343;I=new B(r.line,Math.max(0,Math.min(m.text.length,r.ch+l*(J?2:1))),-l)}}else a?I=wg(e.cm,m,r,l):I=xl(m,r,l);if(I==null)if(!F&&w())r=Sl(a,e.cm,m,r.line,y);else return!1;else r=I;return!0}if(o=="char"||o=="codepoint")k();else if(o=="column")k(!0);else if(o=="word"||o=="group")for(var C=null,L=o=="group",T=e.cm&&e.cm.getHelper(r,"wordChars"),O=!0;!(l<0&&!k(!O));O=!1){var E=m.text.charAt(r.ch)||`
`,R=ts(E,T)?"w":L&&E==`
`?"n":!L||/\s/.test(E)?null:"p";if(L&&!O&&!R&&(R="s"),C&&C!=R){l<0&&(l=1,k(),r.sticky="after");break}if(R&&(C=R),l>0&&!k(!O))break}var H=Ms(e,r,c,g,!0);return Io(c,H)&&(H.hitSide=!0),H}function tu(e,r,l,o){var a=e.doc,c=r.left,g;if(o=="page"){var m=Math.min(e.display.wrapper.clientHeight,Fi(e).innerHeight||a(e).documentElement.clientHeight),y=Math.max(m-.5*vr(e.display),3);g=(l>0?r.bottom:r.top)+l*y}else o=="line"&&(g=l>0?r.bottom+3:r.top-3);for(var w;w=Qo(e,c,g),!!w.outside;){if(l<0?g<=0:g>=a.height){w.hitSide=!0;break}g+=l*5}return w}var mt=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new vi,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};mt.prototype.init=function(e){var r=this,l=this,o=l.cm,a=l.div=e.lineDiv;a.contentEditable=!0,Ll(a,o.options.spellcheck,o.options.autocorrect,o.options.autocapitalize);function c(m){for(var y=m.target;y;y=y.parentNode){if(y==a)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(y.className))break}return!1}Z(a,"paste",function(m){!c(m)||Wt(o,m)||Jf(m,o)||v<=11&&setTimeout(zt(o,function(){return r.updateFromDOM()}),20)}),Z(a,"compositionstart",function(m){r.composing={data:m.data,done:!1}}),Z(a,"compositionupdate",function(m){r.composing||(r.composing={data:m.data,done:!1})}),Z(a,"compositionend",function(m){r.composing&&(m.data!=r.composing.data&&r.readFromDOMSoon(),r.composing.done=!0)}),Z(a,"touchstart",function(){return l.forceCompositionEnd()}),Z(a,"input",function(){r.composing||r.readFromDOMSoon()});function g(m){if(!(!c(m)||Wt(o,m))){if(o.somethingSelected())Ns({lineWise:!1,text:o.getSelections()}),m.type=="cut"&&o.replaceSelection("",null,"cut");else if(o.options.lineWiseCopyCut){var y=Qf(o);Ns({lineWise:!0,text:y.text}),m.type=="cut"&&o.operation(function(){o.setSelections(y.ranges,0,Ge),o.replaceSelection("",null,"cut")})}else return;if(m.clipboardData){m.clipboardData.clearData();var w=ze.text.join(`
`);if(m.clipboardData.setData("Text",w),m.clipboardData.getData("Text")==w){m.preventDefault();return}}var k=$f(),C=k.firstChild;Ll(C),o.display.lineSpace.insertBefore(k,o.display.lineSpace.firstChild),C.value=ze.text.join(`
`);var L=he(De(a));ie(C),setTimeout(function(){o.display.lineSpace.removeChild(k),L.focus(),L==a&&l.showPrimarySelection()},50)}}Z(a,"copy",g),Z(a,"cut",g)},mt.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},mt.prototype.prepareSelection=function(){var e=Gh(this.cm,!1);return e.focus=he(De(this.div))==this.div,e},mt.prototype.showSelection=function(e,r){!e||!this.cm.display.view.length||((e.focus||r)&&this.showPrimarySelection(),this.showMultipleSelections(e))},mt.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},mt.prototype.showPrimarySelection=function(){var e=this.getSelection(),r=this.cm,l=r.doc.sel.primary(),o=l.from(),a=l.to();if(r.display.viewTo==r.display.viewFrom||o.line>=r.display.viewTo||a.line<r.display.viewFrom){e.removeAllRanges();return}var c=Ps(r,e.anchorNode,e.anchorOffset),g=Ps(r,e.focusNode,e.focusOffset);if(!(c&&!c.bad&&g&&!g.bad&&$(rs(c,g),o)==0&&$(is(c,g),a)==0)){var m=r.display.view,y=o.line>=r.display.viewFrom&&eu(r,o)||{node:m[0].measure.map[2],offset:0},w=a.line<r.display.viewTo&&eu(r,a);if(!w){var k=m[m.length-1].measure,C=k.maps?k.maps[k.maps.length-1]:k.map;w={node:C[C.length-1],offset:C[C.length-2]-C[C.length-3]}}if(!y||!w){e.removeAllRanges();return}var L=e.rangeCount&&e.getRangeAt(0),T;try{T=be(y.node,y.offset,w.offset,w.node)}catch{}T&&(!s&&r.state.focused?(e.collapse(y.node,y.offset),T.collapsed||(e.removeAllRanges(),e.addRange(T))):(e.removeAllRanges(),e.addRange(T)),L&&e.anchorNode==null?e.addRange(L):s&&this.startGracePeriod()),this.rememberSelection()}},mt.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},mt.prototype.showMultipleSelections=function(e){lt(this.cm.display.cursorDiv,e.cursors),lt(this.cm.display.selectionDiv,e.selection)},mt.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},mt.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var r=e.getRangeAt(0).commonAncestorContainer;return te(this.div,r)},mt.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||he(De(this.div))!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},mt.prototype.blur=function(){this.div.blur()},mt.prototype.getField=function(){return this.div},mt.prototype.supportsTouch=function(){return!0},mt.prototype.receivedFocus=function(){var e=this,r=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):we(this.cm,function(){return r.cm.curOp.selectionChanged=!0});function l(){r.cm.state.focused&&(r.pollSelection(),r.polling.set(r.cm.options.pollInterval,l))}this.polling.set(this.cm.options.pollInterval,l)},mt.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},mt.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),r=this.cm;if(_&&S&&this.cm.display.gutterSpecs.length&&zg(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var l=Ps(r,e.anchorNode,e.anchorOffset),o=Ps(r,e.focusNode,e.focusOffset);l&&o&&we(r,function(){jt(r.doc,xi(l,o),Ge),(l.bad||o.bad)&&(r.curOp.selectionChanged=!0)})}}},mt.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,r=e.display,l=e.doc.sel.primary(),o=l.from(),a=l.to();if(o.ch==0&&o.line>e.firstLine()&&(o=B(o.line-1,q(e.doc,o.line-1).length)),a.ch==q(e.doc,a.line).text.length&&a.line<e.lastLine()&&(a=B(a.line+1,0)),o.line<r.viewFrom||a.line>r.viewTo-1)return!1;var c,g,m;o.line==r.viewFrom||(c=Xi(e,o.line))==0?(g=gt(r.view[0].line),m=r.view[0].node):(g=gt(r.view[c].line),m=r.view[c-1].node.nextSibling);var y=Xi(e,a.line),w,k;if(y==r.view.length-1?(w=r.viewTo-1,k=r.lineDiv.lastChild):(w=gt(r.view[y+1].line)-1,k=r.view[y+1].node.previousSibling),!m)return!1;for(var C=e.doc.splitLines(Kg(e,m,k,g,w)),L=Ui(e.doc,B(g,0),B(w,q(e.doc,w).text.length));C.length>1&&L.length>1;)if(dt(C)==dt(L))C.pop(),L.pop(),w--;else if(C[0]==L[0])C.shift(),L.shift(),g++;else break;for(var T=0,O=0,E=C[0],R=L[0],H=Math.min(E.length,R.length);T<H&&E.charCodeAt(T)==R.charCodeAt(T);)++T;for(var F=dt(C),I=dt(L),K=Math.min(F.length-(C.length==1?T:0),I.length-(L.length==1?T:0));O<K&&F.charCodeAt(F.length-O-1)==I.charCodeAt(I.length-O-1);)++O;if(C.length==1&&L.length==1&&g==o.line)for(;T&&T>o.ch&&F.charCodeAt(F.length-O-1)==I.charCodeAt(I.length-O-1);)T--,O++;C[C.length-1]=F.slice(0,F.length-O).replace(/^\u200b+/,""),C[0]=C[0].slice(T).replace(/\u200b+$/,"");var J=B(g,T),X=B(w,L.length?dt(L).length-O:0);if(C.length>1||C[0]||$(J,X))return Mr(e.doc,C,J,X,"+input"),!0},mt.prototype.ensurePolled=function(){this.forceCompositionEnd()},mt.prototype.reset=function(){this.forceCompositionEnd()},mt.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},mt.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},mt.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&we(this.cm,function(){return ue(e.cm)})},mt.prototype.setUneditable=function(e){e.contentEditable="false"},mt.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||zt(this.cm,Tl)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},mt.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},mt.prototype.onContextMenu=function(){},mt.prototype.resetPosition=function(){},mt.prototype.needsContentAttribute=!0;function eu(e,r){var l=jo(e,r.line);if(!l||l.hidden)return null;var o=q(e.doc,r.line),a=Oh(l,o,r.line),c=si(o,e.doc.direction),g="left";if(c){var m=Qr(c,r.ch);g=m%2?"right":"left"}var y=Ph(a.map,r.ch,g);return y.offset=y.collapse=="right"?y.end:y.start,y}function zg(e){for(var r=e;r;r=r.parentNode)if(/CodeMirror-gutter-wrapper/.test(r.className))return!0;return!1}function Dr(e,r){return r&&(e.bad=!0),e}function Kg(e,r,l,o,a){var c="",g=!1,m=e.doc.lineSeparator(),y=!1;function w(T){return function(O){return O.id==T}}function k(){g&&(c+=m,y&&(c+=m),g=y=!1)}function C(T){T&&(k(),c+=T)}function L(T){if(T.nodeType==1){var O=T.getAttribute("cm-text");if(O){C(O);return}var E=T.getAttribute("cm-marker"),R;if(E){var H=e.findMarks(B(o,0),B(a+1,0),w(+E));H.length&&(R=H[0].find(0))&&C(Ui(e.doc,R.from,R.to).join(m));return}if(T.getAttribute("contenteditable")=="false")return;var F=/^(pre|div|p|li|table|br)$/i.test(T.nodeName);if(!/^br$/i.test(T.nodeName)&&T.textContent.length==0)return;F&&k();for(var I=0;I<T.childNodes.length;I++)L(T.childNodes[I]);/^(pre|p)$/i.test(T.nodeName)&&(y=!0),F&&(g=!0)}else T.nodeType==3&&C(T.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;L(r),r!=l;)r=r.nextSibling,y=!1;return c}function Ps(e,r,l){var o;if(r==e.display.lineDiv){if(o=e.display.lineDiv.childNodes[l],!o)return Dr(e.clipPos(B(e.display.viewTo-1)),!0);r=null,l=0}else for(o=r;;o=o.parentNode){if(!o||o==e.display.lineDiv)return null;if(o.parentNode&&o.parentNode==e.display.lineDiv)break}for(var a=0;a<e.display.view.length;a++){var c=e.display.view[a];if(c.node==o)return Ug(c,r,l)}}function Ug(e,r,l){var o=e.text.firstChild,a=!1;if(!r||!te(o,r))return Dr(B(gt(e.line),0),!0);if(r==o&&(a=!0,r=o.childNodes[l],l=0,!r)){var c=e.rest?dt(e.rest):e.line;return Dr(B(gt(c),c.text.length),a)}var g=r.nodeType==3?r:null,m=r;for(!g&&r.childNodes.length==1&&r.firstChild.nodeType==3&&(g=r.firstChild,l&&(l=g.nodeValue.length));m.parentNode!=o;)m=m.parentNode;var y=e.measure,w=y.maps;function k(R,H,F){for(var I=-1;I<(w?w.length:0);I++)for(var K=I<0?y.map:w[I],J=0;J<K.length;J+=3){var X=K[J+2];if(X==R||X==H){var rt=gt(I<0?e.line:e.rest[I]),wt=K[J]+F;return(F<0||X!=R)&&(wt=K[J+(F?1:0)]),B(rt,wt)}}}var C=k(g,m,l);if(C)return Dr(C,a);for(var L=m.nextSibling,T=g?g.nodeValue.length-l:0;L;L=L.nextSibling){if(C=k(L,L.firstChild,0),C)return Dr(B(C.line,C.ch-T),a);T+=L.textContent.length}for(var O=m.previousSibling,E=l;O;O=O.previousSibling){if(C=k(O,O.firstChild,-1),C)return Dr(B(C.line,C.ch+E),a);E+=O.textContent.length}}var Lt=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new vi,this.hasSelection=!1,this.composing=null,this.resetting=!1};Lt.prototype.init=function(e){var r=this,l=this,o=this.cm;this.createField(e);var a=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),W&&(a.style.width="0px"),Z(a,"input",function(){p&&v>=9&&r.hasSelection&&(r.hasSelection=null),l.poll()}),Z(a,"paste",function(g){Wt(o,g)||Jf(g,o)||(o.state.pasteIncoming=+new Date,l.fastPoll())});function c(g){if(!Wt(o,g)){if(o.somethingSelected())Ns({lineWise:!1,text:o.getSelections()});else if(o.options.lineWiseCopyCut){var m=Qf(o);Ns({lineWise:!0,text:m.text}),g.type=="cut"?o.setSelections(m.ranges,null,Ge):(l.prevInput="",a.value=m.text.join(`
`),ie(a))}else return;g.type=="cut"&&(o.state.cutIncoming=+new Date)}}Z(a,"cut",c),Z(a,"copy",c),Z(e.scroller,"paste",function(g){if(!(ai(e,g)||Wt(o,g))){if(!a.dispatchEvent){o.state.pasteIncoming=+new Date,l.focus();return}var m=new Event("paste");m.clipboardData=g.clipboardData,a.dispatchEvent(m)}}),Z(e.lineSpace,"selectstart",function(g){ai(e,g)||fe(g)}),Z(a,"compositionstart",function(){var g=o.getCursor("from");l.composing&&l.composing.range.clear(),l.composing={start:g,range:o.markText(g,o.getCursor("to"),{className:"CodeMirror-composing"})}}),Z(a,"compositionend",function(){l.composing&&(l.poll(),l.composing.range.clear(),l.composing=null)})},Lt.prototype.createField=function(e){this.wrapper=$f(),this.textarea=this.wrapper.firstChild;var r=this.cm.options;Ll(this.textarea,r.spellcheck,r.autocorrect,r.autocapitalize)},Lt.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Lt.prototype.prepareSelection=function(){var e=this.cm,r=e.display,l=e.doc,o=Gh(e);if(e.options.moveInputWithCursor){var a=We(e,l.sel.primary().head,"div"),c=r.wrapper.getBoundingClientRect(),g=r.lineDiv.getBoundingClientRect();o.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,a.top+g.top-c.top)),o.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,a.left+g.left-c.left))}return o},Lt.prototype.showSelection=function(e){var r=this.cm,l=r.display;lt(l.cursorDiv,e.cursors),lt(l.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Lt.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var r=this.cm;if(this.resetting=!0,r.somethingSelected()){this.prevInput="";var l=r.getSelection();this.textarea.value=l,r.state.focused&&ie(this.textarea),p&&v>=9&&(this.hasSelection=l)}else e||(this.prevInput=this.textarea.value="",p&&v>=9&&(this.hasSelection=null));this.resetting=!1}},Lt.prototype.getField=function(){return this.textarea},Lt.prototype.supportsTouch=function(){return!1},Lt.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!Y||he(De(this.textarea))!=this.textarea))try{this.textarea.focus()}catch{}},Lt.prototype.blur=function(){this.textarea.blur()},Lt.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Lt.prototype.receivedFocus=function(){this.slowPoll()},Lt.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Lt.prototype.fastPoll=function(){var e=!1,r=this;r.pollingFast=!0;function l(){var o=r.poll();!o&&!e?(e=!0,r.polling.set(60,l)):(r.pollingFast=!1,r.slowPoll())}r.polling.set(20,l)},Lt.prototype.poll=function(){var e=this,r=this.cm,l=this.textarea,o=this.prevInput;if(this.contextMenuPending||this.resetting||!r.state.focused||Kd(l)&&!o&&!this.composing||r.isReadOnly()||r.options.disableInput||r.state.keySeq)return!1;var a=l.value;if(a==o&&!r.somethingSelected())return!1;if(p&&v>=9&&this.hasSelection===a||V&&/[\uf700-\uf7ff]/.test(a))return r.display.input.reset(),!1;if(r.doc.sel==r.display.selForContextMenu){var c=a.charCodeAt(0);if(c==8203&&!o&&(o="​"),c==8666)return this.reset(),this.cm.execCommand("undo")}for(var g=0,m=Math.min(o.length,a.length);g<m&&o.charCodeAt(g)==a.charCodeAt(g);)++g;return we(r,function(){Tl(r,a.slice(g),o.length-g,null,e.composing?"*compose":null),a.length>1e3||a.indexOf(`
`)>-1?l.value=e.prevInput="":e.prevInput=a,e.composing&&(e.composing.range.clear(),e.composing.range=r.markText(e.composing.start,r.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Lt.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Lt.prototype.onKeyPress=function(){p&&v>=9&&(this.hasSelection=null),this.fastPoll()},Lt.prototype.onContextMenu=function(e){var r=this,l=r.cm,o=l.display,a=r.textarea;r.contextMenuPending&&r.contextMenuPending();var c=Yi(l,e),g=o.scroller.scrollTop;if(!c||A)return;var m=l.options.resetSelectionOnContextMenu;m&&l.doc.sel.contains(c)==-1&&zt(l,jt)(l.doc,xi(c),Ge);var y=a.style.cssText,w=r.wrapper.style.cssText,k=r.wrapper.offsetParent.getBoundingClientRect();r.wrapper.style.cssText="position: static",a.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-k.top-5)+"px; left: "+(e.clientX-k.left-5)+`px;
      z-index: 1000; background: `+(p?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var C;b&&(C=a.ownerDocument.defaultView.scrollY),o.input.focus(),b&&a.ownerDocument.defaultView.scrollTo(null,C),o.input.reset(),l.somethingSelected()||(a.value=r.prevInput=" "),r.contextMenuPending=T,o.selForContextMenu=l.doc.sel,clearTimeout(o.detectingSelectAll);function L(){if(a.selectionStart!=null){var E=l.somethingSelected(),R="​"+(E?a.value:"");a.value="⇚",a.value=R,r.prevInput=E?"":"​",a.selectionStart=1,a.selectionEnd=R.length,o.selForContextMenu=l.doc.sel}}function T(){if(r.contextMenuPending==T&&(r.contextMenuPending=!1,r.wrapper.style.cssText=w,a.style.cssText=y,p&&v<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=g),a.selectionStart!=null)){(!p||p&&v<9)&&L();var E=0,R=function(){o.selForContextMenu==l.doc.sel&&a.selectionStart==0&&a.selectionEnd>0&&r.prevInput=="​"?zt(l,wf)(l):E++<10?o.detectingSelectAll=setTimeout(R,500):(o.selForContextMenu=null,o.input.reset())};o.detectingSelectAll=setTimeout(R,200)}}if(p&&v>=9&&L(),at){$r(e);var O=function(){Me(window,"mouseup",O),setTimeout(T,20)};Z(window,"mouseup",O)}else setTimeout(T,50)},Lt.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Lt.prototype.setUneditable=function(){},Lt.prototype.needsContentAttribute=!1;function Gg(e,r){if(r=r?zi(r):{},r.value=e.value,!r.tabindex&&e.tabIndex&&(r.tabindex=e.tabIndex),!r.placeholder&&e.placeholder&&(r.placeholder=e.placeholder),r.autofocus==null){var l=he(De(e));r.autofocus=l==e||e.getAttribute("autofocus")!=null&&l==document.body}function o(){e.value=m.getValue()}var a;if(e.form&&(Z(e.form,"submit",o),!r.leaveSubmitMethodAlone)){var c=e.form;a=c.submit;try{var g=c.submit=function(){o(),c.submit=a,c.submit(),c.submit=g}}catch{}}r.finishInit=function(y){y.save=o,y.getTextArea=function(){return e},y.toTextArea=function(){y.toTextArea=isNaN,o(),e.parentNode.removeChild(y.getWrapperElement()),e.style.display="",e.form&&(Me(e.form,"submit",o),!r.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=a))}},e.style.display="none";var m=Ct(function(y){return e.parentNode.insertBefore(y,e.nextSibling)},r);return m}function Vg(e){e.off=Me,e.on=Z,e.wheelEventPixels=Zp,e.Doc=ce,e.splitLines=Do,e.countColumn=Ne,e.findColumn=xo,e.isWordChar=ko,e.Pass=Zn,e.signal=Ot,e.Line=pr,e.changeEnd=Si,e.scrollbarModel=jh,e.Pos=B,e.cmpPos=$,e.modes=Po,e.mimeModes=cr,e.resolveMode=es,e.getMode=Eo,e.modeExtensions=dr,e.extendMode=Yd,e.copyState=Ki,e.startState=eh,e.innerMode=Bo,e.commands=Cn,e.keyMap=fi,e.keyName=Hf,e.isModifierKey=Bf,e.lookupKey=Tr,e.normalizeKeyMap=bg,e.StringStream=Dt,e.SharedTextMarker=xn,e.TextMarker=Ci,e.LineWidget=wn,e.e_preventDefault=fe,e.e_stopPropagation=$a,e.e_stop=$r,e.addClass=Xt,e.contains=te,e.rmClass=it,e.keyNames=Mi}Rg(Ct),Fg(Ct);var qg="iter insert remove copy getEditor constructor".split(" ");for(var Es in ce.prototype)ce.prototype.hasOwnProperty(Es)&&_t(qg,Es)<0&&(Ct.prototype[Es]=function(e){return function(){return e.apply(this.doc,arguments)}}(ce.prototype[Es]));return ur(ce),Ct.inputStyles={textarea:Lt,contenteditable:mt},Ct.defineMode=function(e){!Ct.defaults.mode&&e!="null"&&(Ct.defaults.mode=e),Vd.apply(this,arguments)},Ct.defineMIME=qd,Ct.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ct.defineMIME("text/plain","null"),Ct.defineExtension=function(e,r){Ct.prototype[e]=r},Ct.defineDocExtension=function(e,r){ce.prototype[e]=r},Ct.fromTextArea=Gg,Vg(Ct),Ct.version="5.65.17",Ct})})(ac);var t0=ac.exports;class vt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,i,n){[t,i]=zr(this,t,i);let s=[];return this.decompose(0,t,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(i,this.length,s,1),ti.from(s,this.length-(i-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,i=this.length){[t,i]=zr(this,t,i);let n=[];return this.decompose(t,i,n,0),ti.from(n,i-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let i=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),s=new Wn(this),h=new Wn(t);for(let u=i,d=i;;){if(s.next(u),h.next(u),u=0,s.lineBreak!=h.lineBreak||s.done!=h.done||s.value!=h.value)return!1;if(d+=s.value.length,s.done||d>=n)return!0}}iter(t=1){return new Wn(this,t)}iterRange(t,i=this.length){return new hc(this,t,i)}iterLines(t,i){let n;if(t==null)n=this.iter();else{i==null&&(i=this.lines+1);let s=this.line(t).from;n=this.iterRange(s,Math.max(s,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to))}return new fc(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?vt.empty:t.length<=32?new Et(t):ti.from(Et.split(t,[]))}}class Et extends vt{constructor(t,i=e0(t)){super(),this.text=t,this.length=i}get lines(){return this.text.length}get children(){return null}lineInner(t,i,n,s){for(let h=0;;h++){let u=this.text[h],d=s+u.length;if((i?n:d)>=t)return new i0(s,d,n,u);s=d+1,n++}}decompose(t,i,n,s){let h=t<=0&&i>=this.length?this:new Et(iu(this.text,t,i),Math.min(i,this.length)-Math.max(0,t));if(s&1){let u=n.pop(),d=Js(h.text,u.text.slice(),0,h.length);if(d.length<=32)n.push(new Et(d,u.length+h.length));else{let p=d.length>>1;n.push(new Et(d.slice(0,p)),new Et(d.slice(p)))}}else n.push(h)}replace(t,i,n){if(!(n instanceof Et))return super.replace(t,i,n);[t,i]=zr(this,t,i);let s=Js(this.text,Js(n.text,iu(this.text,0,t)),i),h=this.length+n.length-(i-t);return s.length<=32?new Et(s,h):ti.from(Et.split(s,[]),h)}sliceString(t,i=this.length,n=`
`){[t,i]=zr(this,t,i);let s="";for(let h=0,u=0;h<=i&&u<this.text.length;u++){let d=this.text[u],p=h+d.length;h>t&&u&&(s+=n),t<p&&i>h&&(s+=d.slice(Math.max(0,t-h),i-h)),h=p+1}return s}flatten(t){for(let i of this.text)t.push(i)}scanIdentical(){return 0}static split(t,i){let n=[],s=-1;for(let h of t)n.push(h),s+=h.length+1,n.length==32&&(i.push(new Et(n,s)),n=[],s=-1);return s>-1&&i.push(new Et(n,s)),i}}class ti extends vt{constructor(t,i){super(),this.children=t,this.length=i,this.lines=0;for(let n of t)this.lines+=n.lines}lineInner(t,i,n,s){for(let h=0;;h++){let u=this.children[h],d=s+u.length,p=n+u.lines-1;if((i?p:d)>=t)return u.lineInner(t,i,n,s);s=d+1,n=p+1}}decompose(t,i,n,s){for(let h=0,u=0;u<=i&&h<this.children.length;h++){let d=this.children[h],p=u+d.length;if(t<=p&&i>=u){let v=s&((u<=t?1:0)|(p>=i?2:0));u>=t&&p<=i&&!v?n.push(d):d.decompose(t-u,i-u,n,v)}u=p+1}}replace(t,i,n){if([t,i]=zr(this,t,i),n.lines<this.lines)for(let s=0,h=0;s<this.children.length;s++){let u=this.children[s],d=h+u.length;if(t>=h&&i<=d){let p=u.replace(t-h,i-h,n),v=this.lines-u.lines+p.lines;if(p.lines<v>>5-1&&p.lines>v>>5+1){let b=this.children.slice();return b[s]=p,new ti(b,this.length-(i-t)+n.length)}return super.replace(h,d,p)}h=d+1}return super.replace(t,i,n)}sliceString(t,i=this.length,n=`
`){[t,i]=zr(this,t,i);let s="";for(let h=0,u=0;h<this.children.length&&u<=i;h++){let d=this.children[h],p=u+d.length;u>t&&h&&(s+=n),t<p&&i>u&&(s+=d.sliceString(t-u,i-u,n)),u=p+1}return s}flatten(t){for(let i of this.children)i.flatten(t)}scanIdentical(t,i){if(!(t instanceof ti))return 0;let n=0,[s,h,u,d]=i>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=i,h+=i){if(s==u||h==d)return n;let p=this.children[s],v=t.children[h];if(p!=v)return n+p.scanIdentical(v,i);n+=p.length+1}}static from(t,i=t.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let M of t)n+=M.lines;if(n<32){let M=[];for(let A of t)A.flatten(M);return new Et(M,i)}let s=Math.max(32,n>>5),h=s<<1,u=s>>1,d=[],p=0,v=-1,b=[];function x(M){let A;if(M.lines>h&&M instanceof ti)for(let D of M.children)x(D);else M.lines>u&&(p>u||!p)?(S(),d.push(M)):M instanceof Et&&p&&(A=b[b.length-1])instanceof Et&&M.lines+A.lines<=32?(p+=M.lines,v+=M.length+1,b[b.length-1]=new Et(A.text.concat(M.text),A.length+1+M.length)):(p+M.lines>s&&S(),p+=M.lines,v+=M.length+1,b.push(M))}function S(){p!=0&&(d.push(b.length==1?b[0]:ti.from(b,v)),v=-1,p=b.length=0)}for(let M of t)x(M);return S(),d.length==1?d[0]:new ti(d,i)}}vt.empty=new Et([""],0);function e0(f){let t=-1;for(let i of f)t+=i.length+1;return t}function Js(f,t,i=0,n=1e9){for(let s=0,h=0,u=!0;h<f.length&&s<=n;h++){let d=f[h],p=s+d.length;p>=i&&(p>n&&(d=d.slice(0,n-s)),s<i&&(d=d.slice(i-s)),u?(t[t.length-1]+=d,u=!1):t.push(d)),s=p+1}return t}function iu(f,t,i){return Js(f,[""],t,i)}class Wn{constructor(t,i=1){this.dir=i,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[i>0?1:(t instanceof Et?t.text.length:t.children.length)<<1]}nextInner(t,i){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],h=this.offsets[n],u=h>>1,d=s instanceof Et?s.text.length:s.children.length;if(u==(i>0?d:0)){if(n==0)return this.done=!0,this.value="",this;i>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((h&1)==(i>0?0:1)){if(this.offsets[n]+=i,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(s instanceof Et){let p=s.text[u+(i<0?-1:0)];if(this.offsets[n]+=i,p.length>Math.max(0,t))return this.value=t==0?p:i>0?p.slice(t):p.slice(0,p.length-t),this;t-=p.length}else{let p=s.children[u+(i<0?-1:0)];t>p.length?(t-=p.length,this.offsets[n]+=i):(i<0&&this.offsets[n]--,this.nodes.push(p),this.offsets.push(i>0?1:(p instanceof Et?p.text.length:p.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class hc{constructor(t,i,n){this.value="",this.done=!1,this.cursor=new Wn(t,i>n?-1:1),this.pos=i>n?t.length:0,this.from=Math.min(i,n),this.to=Math.max(i,n)}nextInner(t,i){if(i<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos);let n=i<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:s}=this.cursor.next(t);return this.pos+=(s.length+t)*i,this.value=s.length<=n?s:i<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class fc{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:i,lineBreak:n,value:s}=this.inner.next(t);return i&&this.afterBreak?(this.value="",this.afterBreak=!1):i?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(vt.prototype[Symbol.iterator]=function(){return this.iter()},Wn.prototype[Symbol.iterator]=hc.prototype[Symbol.iterator]=fc.prototype[Symbol.iterator]=function(){return this});class i0{constructor(t,i,n,s){this.from=t,this.to=i,this.number=n,this.text=s}get length(){return this.to-this.from}}function zr(f,t,i){return t=Math.max(0,Math.min(f.length,t)),[t,Math.max(t,Math.min(f.length,i))]}let Hr="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(f=>f?parseInt(f,36):1);for(let f=1;f<Hr.length;f++)Hr[f]+=Hr[f-1];function r0(f){for(let t=1;t<Hr.length;t+=2)if(Hr[t]>f)return Hr[t-1]<=f;return!1}function ru(f){return f>=127462&&f<=127487}const nu=8205;function ii(f,t,i=!0,n=!0){return(i?uc:n0)(f,t,n)}function uc(f,t,i){if(t==f.length)return t;t&&cc(f.charCodeAt(t))&&dc(f.charCodeAt(t-1))&&t--;let n=Zs(f,t);for(t+=jl(n);t<f.length;){let s=Zs(f,t);if(n==nu||s==nu||i&&r0(s))t+=jl(s),n=s;else if(ru(s)){let h=0,u=t-2;for(;u>=0&&ru(Zs(f,u));)h++,u-=2;if(h%2==0)break;t+=2}else break}return t}function n0(f,t,i){for(;t>0;){let n=uc(f,t-2,i);if(n<t)return n;t--}return 0}function cc(f){return f>=56320&&f<57344}function dc(f){return f>=55296&&f<56320}function Zs(f,t){let i=f.charCodeAt(t);if(!dc(i)||t+1==f.length)return i;let n=f.charCodeAt(t+1);return cc(n)?(i-55296<<10)+(n-56320)+65536:i}function jl(f){return f<65536?1:2}const Jl=/\r\n?|\n/;var Le=function(f){return f[f.Simple=0]="Simple",f[f.TrackDel=1]="TrackDel",f[f.TrackBefore=2]="TrackBefore",f[f.TrackAfter=3]="TrackAfter",f}(Le||(Le={}));class di{constructor(t){this.sections=t}get length(){let t=0;for(let i=0;i<this.sections.length;i+=2)t+=this.sections[i];return t}get newLength(){let t=0;for(let i=0;i<this.sections.length;i+=2){let n=this.sections[i+1];t+=n<0?this.sections[i]:n}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let i=0,n=0,s=0;i<this.sections.length;){let h=this.sections[i++],u=this.sections[i++];u<0?(t(n,s,h),s+=h):s+=u,n+=h}}iterChangedRanges(t,i=!1){Zl(this,t,i)}get invertedDesc(){let t=[];for(let i=0;i<this.sections.length;){let n=this.sections[i++],s=this.sections[i++];s<0?t.push(n,s):t.push(s,n)}return new di(t)}composeDesc(t){return this.empty?t:t.empty?this:pc(this,t)}mapDesc(t,i=!1){return t.empty?this:Ql(this,t,i)}mapPos(t,i=-1,n=Le.Simple){let s=0,h=0;for(let u=0;u<this.sections.length;){let d=this.sections[u++],p=this.sections[u++],v=s+d;if(p<0){if(v>t)return h+(t-s);h+=d}else{if(n!=Le.Simple&&v>=t&&(n==Le.TrackDel&&s<t&&v>t||n==Le.TrackBefore&&s<t||n==Le.TrackAfter&&v>t))return null;if(v>t||v==t&&i<0&&!d)return t==s||i<0?h:h+p;h+=p}s=v}if(t>s)throw new RangeError(`Position ${t} is out of range for changeset of length ${s}`);return h}touchesRange(t,i=t){for(let n=0,s=0;n<this.sections.length&&s<=i;){let h=this.sections[n++],u=this.sections[n++],d=s+h;if(u>=0&&s<=i&&d>=t)return s<t&&d>i?"cover":!0;s=d}return!1}toString(){let t="";for(let i=0;i<this.sections.length;){let n=this.sections[i++],s=this.sections[i++];t+=(t?" ":"")+n+(s>=0?":"+s:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(i=>typeof i!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new di(t)}static create(t){return new di(t)}}class qt extends di{constructor(t,i){super(t),this.inserted=i}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Zl(this,(i,n,s,h,u)=>t=t.replace(s,s+(n-i),u),!1),t}mapDesc(t,i=!1){return Ql(this,t,i,!0)}invert(t){let i=this.sections.slice(),n=[];for(let s=0,h=0;s<i.length;s+=2){let u=i[s],d=i[s+1];if(d>=0){i[s]=d,i[s+1]=u;let p=s>>1;for(;n.length<p;)n.push(vt.empty);n.push(u?t.slice(h,h+u):vt.empty)}h+=u}return new qt(i,n)}compose(t){return this.empty?t:t.empty?this:pc(this,t,!0)}map(t,i=!1){return t.empty?this:Ql(this,t,i,!0)}iterChanges(t,i=!1){Zl(this,t,i)}get desc(){return di.create(this.sections)}filter(t){let i=[],n=[],s=[],h=new Un(this);t:for(let u=0,d=0;;){let p=u==t.length?1e9:t[u++];for(;d<p||d==p&&h.len==0;){if(h.done)break t;let b=Math.min(h.len,p-d);se(s,b,-1);let x=h.ins==-1?-1:h.off==0?h.ins:0;se(i,b,x),x>0&&Pi(n,i,h.text),h.forward(b),d+=b}let v=t[u++];for(;d<v;){if(h.done)break t;let b=Math.min(h.len,v-d);se(i,b,-1),se(s,b,h.ins==-1?-1:h.off==0?h.ins:0),h.forward(b),d+=b}}return{changes:new qt(i,n),filtered:di.create(s)}}toJSON(){let t=[];for(let i=0;i<this.sections.length;i+=2){let n=this.sections[i],s=this.sections[i+1];s<0?t.push(n):s==0?t.push([n]):t.push([n].concat(this.inserted[i>>1].toJSON()))}return t}static of(t,i,n){let s=[],h=[],u=0,d=null;function p(b=!1){if(!b&&!s.length)return;u<i&&se(s,i-u,-1);let x=new qt(s,h);d=d?d.compose(x.map(d)):x,s=[],h=[],u=0}function v(b){if(Array.isArray(b))for(let x of b)v(x);else if(b instanceof qt){if(b.length!=i)throw new RangeError(`Mismatched change set length (got ${b.length}, expected ${i})`);p(),d=d?d.compose(b.map(d)):b}else{let{from:x,to:S=x,insert:M}=b;if(x>S||x<0||S>i)throw new RangeError(`Invalid change range ${x} to ${S} (in doc of length ${i})`);let A=M?typeof M=="string"?vt.of(M.split(n||Jl)):M:vt.empty,D=A.length;if(x==S&&D==0)return;x<u&&p(),x>u&&se(s,x-u,-1),se(s,S-x,D),Pi(h,s,A),u=S}}return v(t),p(!d),d}static empty(t){return new qt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let i=[],n=[];for(let s=0;s<t.length;s++){let h=t[s];if(typeof h=="number")i.push(h,-1);else{if(!Array.isArray(h)||typeof h[0]!="number"||h.some((u,d)=>d&&typeof u!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(h.length==1)i.push(h[0],0);else{for(;n.length<s;)n.push(vt.empty);n[s]=vt.of(h.slice(1)),i.push(h[0],n[s].length)}}}return new qt(i,n)}static createSet(t,i){return new qt(t,i)}}function se(f,t,i,n=!1){if(t==0&&i<=0)return;let s=f.length-2;s>=0&&i<=0&&i==f[s+1]?f[s]+=t:t==0&&f[s]==0?f[s+1]+=i:n?(f[s]+=t,f[s+1]+=i):f.push(t,i)}function Pi(f,t,i){if(i.length==0)return;let n=t.length-2>>1;if(n<f.length)f[f.length-1]=f[f.length-1].append(i);else{for(;f.length<n;)f.push(vt.empty);f.push(i)}}function Zl(f,t,i){let n=f.inserted;for(let s=0,h=0,u=0;u<f.sections.length;){let d=f.sections[u++],p=f.sections[u++];if(p<0)s+=d,h+=d;else{let v=s,b=h,x=vt.empty;for(;v+=d,b+=p,p&&n&&(x=x.append(n[u-2>>1])),!(i||u==f.sections.length||f.sections[u+1]<0);)d=f.sections[u++],p=f.sections[u++];t(s,v,h,b,x),s=v,h=b}}}function Ql(f,t,i,n=!1){let s=[],h=n?[]:null,u=new Un(f),d=new Un(t);for(let p=-1;;)if(u.ins==-1&&d.ins==-1){let v=Math.min(u.len,d.len);se(s,v,-1),u.forward(v),d.forward(v)}else if(d.ins>=0&&(u.ins<0||p==u.i||u.off==0&&(d.len<u.len||d.len==u.len&&!i))){let v=d.len;for(se(s,d.ins,-1);v;){let b=Math.min(u.len,v);u.ins>=0&&p<u.i&&u.len<=b&&(se(s,0,u.ins),h&&Pi(h,s,u.text),p=u.i),u.forward(b),v-=b}d.next()}else if(u.ins>=0){let v=0,b=u.len;for(;b;)if(d.ins==-1){let x=Math.min(b,d.len);v+=x,b-=x,d.forward(x)}else if(d.ins==0&&d.len<b)b-=d.len,d.next();else break;se(s,v,p<u.i?u.ins:0),h&&p<u.i&&Pi(h,s,u.text),p=u.i,u.forward(u.len-b)}else{if(u.done&&d.done)return h?qt.createSet(s,h):di.create(s);throw new Error("Mismatched change set lengths")}}function pc(f,t,i=!1){let n=[],s=i?[]:null,h=new Un(f),u=new Un(t);for(let d=!1;;){if(h.done&&u.done)return s?qt.createSet(n,s):di.create(n);if(h.ins==0)se(n,h.len,0,d),h.next();else if(u.len==0&&!u.done)se(n,0,u.ins,d),s&&Pi(s,n,u.text),u.next();else{if(h.done||u.done)throw new Error("Mismatched change set lengths");{let p=Math.min(h.len2,u.len),v=n.length;if(h.ins==-1){let b=u.ins==-1?-1:u.off?0:u.ins;se(n,p,b,d),s&&b&&Pi(s,n,u.text)}else u.ins==-1?(se(n,h.off?0:h.len,p,d),s&&Pi(s,n,h.textBit(p))):(se(n,h.off?0:h.len,u.off?0:u.ins,d),s&&!u.off&&Pi(s,n,u.text));d=(h.ins>p||u.ins>=0&&u.len>p)&&(d||n.length>v),h.forward2(p),u.forward(p)}}}}class Un{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length?vt.empty:t[i]}textBit(t){let{inserted:i}=this.set,n=this.i-2>>1;return n>=i.length&&!t?vt.empty:i[n].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class rr{constructor(t,i,n){this.from=t,this.to=i,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,i=-1){let n,s;return this.empty?n=s=t.mapPos(this.from,i):(n=t.mapPos(this.from,1),s=t.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new rr(n,s,this.flags)}extend(t,i=t){if(t<=this.anchor&&i>=this.anchor)return j.range(t,i);let n=Math.abs(t-this.anchor)>Math.abs(i-this.anchor)?t:i;return j.range(this.anchor,n)}eq(t,i=!1){return this.anchor==t.anchor&&this.head==t.head&&(!i||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return j.range(t.anchor,t.head)}static create(t,i,n){return new rr(t,i,n)}}class j{constructor(t,i){this.ranges=t,this.mainIndex=i}map(t,i=-1){return t.empty?this:j.create(this.ranges.map(n=>n.map(t,i)),this.mainIndex)}eq(t,i=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(t.ranges[n],i))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new j([this.main],0)}addRange(t,i=!0){return j.create([t].concat(this.ranges),i?0:this.mainIndex+1)}replaceRange(t,i=this.mainIndex){let n=this.ranges.slice();return n[i]=t,j.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new j(t.ranges.map(i=>rr.fromJSON(i)),t.main)}static single(t,i=t){return new j([j.range(t,i)],0)}static create(t,i=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<t.length;s++){let h=t[s];if(h.empty?h.from<=n:h.from<n)return j.normalized(t.slice(),i);n=h.to}return new j(t,i)}static cursor(t,i=0,n,s){return rr.create(t,t,(i==0?0:i<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(t,i,n,s){let h=(n??16777215)<<6|(s==null?7:Math.min(6,s));return i<t?rr.create(i,t,48|h):rr.create(t,i,(i>t?8:0)|h)}static normalized(t,i=0){let n=t[i];t.sort((s,h)=>s.from-h.from),i=t.indexOf(n);for(let s=1;s<t.length;s++){let h=t[s],u=t[s-1];if(h.empty?h.from<=u.to:h.from<u.to){let d=u.from,p=Math.max(h.to,u.to);s<=i&&i--,t.splice(--s,2,h.anchor>h.head?j.range(p,d):j.range(d,p))}}return new j(t,i)}}function gc(f,t){for(let i of f.ranges)if(i.to>t)throw new RangeError("Selection points outside of document")}let Ba=0;class et{constructor(t,i,n,s,h){this.combine=t,this.compareInput=i,this.compare=n,this.isStatic=s,this.id=Ba++,this.default=t([]),this.extensions=typeof h=="function"?h(this):h}get reader(){return this}static define(t={}){return new et(t.combine||(i=>i),t.compareInput||((i,n)=>i===n),t.compare||(t.combine?(i,n)=>i===n:Ra),!!t.static,t.enables)}of(t){return new Qs([],this,0,t)}compute(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new Qs(t,this,1,i)}computeN(t,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new Qs(t,this,2,i)}from(t,i){return i||(i=n=>n),this.compute([t],n=>i(n.field(t)))}}function Ra(f,t){return f==t||f.length==t.length&&f.every((i,n)=>i===t[n])}class Qs{constructor(t,i,n,s){this.dependencies=t,this.facet=i,this.type=n,this.value=s,this.id=Ba++}dynamicSlot(t){var i;let n=this.value,s=this.facet.compareInput,h=this.id,u=t[h]>>1,d=this.type==2,p=!1,v=!1,b=[];for(let x of this.dependencies)x=="doc"?p=!0:x=="selection"?v=!0:((i=t[x.id])!==null&&i!==void 0?i:1)&1||b.push(t[x.id]);return{create(x){return x.values[u]=n(x),1},update(x,S){if(p&&S.docChanged||v&&(S.docChanged||S.selection)||$l(x,b)){let M=n(x);if(d?!su(M,x.values[u],s):!s(M,x.values[u]))return x.values[u]=M,1}return 0},reconfigure:(x,S)=>{let M,A=S.config.address[h];if(A!=null){let D=so(S,A);if(this.dependencies.every(N=>N instanceof et?S.facet(N)===x.facet(N):N instanceof fr?S.field(N,!1)==x.field(N,!1):!0)||(d?su(M=n(x),D,s):s(M=n(x),D)))return x.values[u]=D,0}else M=n(x);return x.values[u]=M,1}}}}function su(f,t,i){if(f.length!=t.length)return!1;for(let n=0;n<f.length;n++)if(!i(f[n],t[n]))return!1;return!0}function $l(f,t){let i=!1;for(let n of t)Fn(f,n)&1&&(i=!0);return i}function s0(f,t,i){let n=i.map(p=>f[p.id]),s=i.map(p=>p.type),h=n.filter(p=>!(p&1)),u=f[t.id]>>1;function d(p){let v=[];for(let b=0;b<n.length;b++){let x=so(p,n[b]);if(s[b]==2)for(let S of x)v.push(S);else v.push(x)}return t.combine(v)}return{create(p){for(let v of n)Fn(p,v);return p.values[u]=d(p),1},update(p,v){if(!$l(p,h))return 0;let b=d(p);return t.compare(b,p.values[u])?0:(p.values[u]=b,1)},reconfigure(p,v){let b=$l(p,n),x=v.config.facets[t.id],S=v.facet(t);if(x&&!b&&Ra(i,x))return p.values[u]=S,0;let M=d(p);return t.compare(M,S)?(p.values[u]=S,0):(p.values[u]=M,1)}}}const ou=et.define({static:!0});class fr{constructor(t,i,n,s,h){this.id=t,this.createF=i,this.updateF=n,this.compareF=s,this.spec=h,this.provides=void 0}static define(t){let i=new fr(Ba++,t.create,t.update,t.compare||((n,s)=>n===s),t);return t.provide&&(i.provides=t.provide(i)),i}create(t){let i=t.facet(ou).find(n=>n.field==this);return((i==null?void 0:i.create)||this.createF)(t)}slot(t){let i=t[this.id]>>1;return{create:n=>(n.values[i]=this.create(n),1),update:(n,s)=>{let h=n.values[i],u=this.updateF(h,s);return this.compareF(h,u)?0:(n.values[i]=u,1)},reconfigure:(n,s)=>s.config.address[this.id]!=null?(n.values[i]=s.field(this),0):(n.values[i]=this.create(n),1)}}init(t){return[this,ou.of({field:this,create:t})]}get extension(){return this}}const er={lowest:4,low:3,default:2,high:1,highest:0};function On(f){return t=>new vc(t,f)}const mc={highest:On(er.highest),high:On(er.high),default:On(er.default),low:On(er.low),lowest:On(er.lowest)};class vc{constructor(t,i){this.inner=t,this.prec=i}}class _n{of(t){return new ta(this,t)}reconfigure(t){return _n.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class ta{constructor(t,i){this.compartment=t,this.inner=i}}class no{constructor(t,i,n,s,h,u){for(this.base=t,this.compartments=i,this.dynamicSlots=n,this.address=s,this.staticValues=h,this.facets=u,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(t){let i=this.address[t.id];return i==null?t.default:this.staticValues[i>>1]}static resolve(t,i,n){let s=[],h=Object.create(null),u=new Map;for(let S of o0(t,i,u))S instanceof fr?s.push(S):(h[S.facet.id]||(h[S.facet.id]=[])).push(S);let d=Object.create(null),p=[],v=[];for(let S of s)d[S.id]=v.length<<1,v.push(M=>S.slot(M));let b=n==null?void 0:n.config.facets;for(let S in h){let M=h[S],A=M[0].facet,D=b&&b[S]||[];if(M.every(N=>N.type==0))if(d[A.id]=p.length<<1|1,Ra(D,M))p.push(n.facet(A));else{let N=A.combine(M.map(P=>P.value));p.push(n&&A.compare(N,n.facet(A))?n.facet(A):N)}else{for(let N of M)N.type==0?(d[N.id]=p.length<<1|1,p.push(N.value)):(d[N.id]=v.length<<1,v.push(P=>N.dynamicSlot(P)));d[A.id]=v.length<<1,v.push(N=>s0(N,A,M))}}let x=v.map(S=>S(d));return new no(t,u,x,d,p,h)}}function o0(f,t,i){let n=[[],[],[],[],[]],s=new Map;function h(u,d){let p=s.get(u);if(p!=null){if(p<=d)return;let v=n[p].indexOf(u);v>-1&&n[p].splice(v,1),u instanceof ta&&i.delete(u.compartment)}if(s.set(u,d),Array.isArray(u))for(let v of u)h(v,d);else if(u instanceof ta){if(i.has(u.compartment))throw new RangeError("Duplicate use of compartment in extensions");let v=t.get(u.compartment)||u.inner;i.set(u.compartment,v),h(v,d)}else if(u instanceof vc)h(u.inner,u.prec);else if(u instanceof fr)n[d].push(u),u.provides&&h(u.provides,d);else if(u instanceof Qs)n[d].push(u),u.facet.extensions&&h(u.facet.extensions,er.default);else{let v=u.extension;if(!v)throw new Error(`Unrecognized extension value in extension set (${u}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);h(v,d)}}return h(f,er.default),n.reduce((u,d)=>u.concat(d))}function Fn(f,t){if(t&1)return 2;let i=t>>1,n=f.status[i];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;f.status[i]=4;let s=f.computeSlot(f,f.config.dynamicSlots[i]);return f.status[i]=2|s}function so(f,t){return t&1?f.config.staticValues[t>>1]:f.values[t>>1]}const yc=et.define(),ea=et.define({combine:f=>f.some(t=>t),static:!0}),bc=et.define({combine:f=>f.length?f[0]:void 0,static:!0}),wc=et.define(),xc=et.define(),Sc=et.define(),kc=et.define({combine:f=>f.length?f[0]:!1});class _r{constructor(t,i){this.type=t,this.value=i}static define(){return new l0}}class l0{of(t){return new _r(this,t)}}class a0{constructor(t){this.map=t}of(t){return new Ht(this,t)}}class Ht{constructor(t,i){this.type=t,this.value=i}map(t){let i=this.type.map(this.value,t);return i===void 0?void 0:i==this.value?this:new Ht(this.type,i)}is(t){return this.type==t}static define(t={}){return new a0(t.map||(i=>i))}static mapEffects(t,i){if(!t.length)return t;let n=[];for(let s of t){let h=s.map(i);h&&n.push(h)}return n}}Ht.reconfigure=Ht.define();Ht.appendConfig=Ht.define();class le{constructor(t,i,n,s,h,u){this.startState=t,this.changes=i,this.selection=n,this.effects=s,this.annotations=h,this.scrollIntoView=u,this._doc=null,this._state=null,n&&gc(n,i.newLength),h.some(d=>d.type==le.time)||(this.annotations=h.concat(le.time.of(Date.now())))}static create(t,i,n,s,h,u){return new le(t,i,n,s,h,u)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let i of this.annotations)if(i.type==t)return i.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let i=this.annotation(le.userEvent);return!!(i&&(i==t||i.length>t.length&&i.slice(0,t.length)==t&&i[t.length]=="."))}}le.time=_r.define();le.userEvent=_r.define();le.addToHistory=_r.define();le.remote=_r.define();function h0(f,t){let i=[];for(let n=0,s=0;;){let h,u;if(n<f.length&&(s==t.length||t[s]>=f[n]))h=f[n++],u=f[n++];else if(s<t.length)h=t[s++],u=t[s++];else return i;!i.length||i[i.length-1]<h?i.push(h,u):i[i.length-1]<u&&(i[i.length-1]=u)}}function Cc(f,t,i){var n;let s,h,u;return i?(s=t.changes,h=qt.empty(t.changes.length),u=f.changes.compose(t.changes)):(s=t.changes.map(f.changes),h=f.changes.mapDesc(t.changes,!0),u=f.changes.compose(s)),{changes:u,selection:t.selection?t.selection.map(h):(n=f.selection)===null||n===void 0?void 0:n.map(s),effects:Ht.mapEffects(f.effects,s).concat(Ht.mapEffects(t.effects,h)),annotations:f.annotations.length?f.annotations.concat(t.annotations):t.annotations,scrollIntoView:f.scrollIntoView||t.scrollIntoView}}function ia(f,t,i){let n=t.selection,s=Ir(t.annotations);return t.userEvent&&(s=s.concat(le.userEvent.of(t.userEvent))),{changes:t.changes instanceof qt?t.changes:qt.of(t.changes||[],i,f.facet(bc)),selection:n&&(n instanceof j?n:j.single(n.anchor,n.head)),effects:Ir(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Mc(f,t,i){let n=ia(f,t.length?t[0]:{},f.doc.length);t.length&&t[0].filter===!1&&(i=!1);for(let h=1;h<t.length;h++){t[h].filter===!1&&(i=!1);let u=!!t[h].sequential;n=Cc(n,ia(f,t[h],u?n.changes.newLength:f.doc.length),u)}let s=le.create(f,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return u0(i?f0(s):s)}function f0(f){let t=f.startState,i=!0;for(let s of t.facet(wc)){let h=s(f);if(h===!1){i=!1;break}Array.isArray(h)&&(i=i===!0?h:h0(i,h))}if(i!==!0){let s,h;if(i===!1)h=f.changes.invertedDesc,s=qt.empty(t.doc.length);else{let u=f.changes.filter(i);s=u.changes,h=u.filtered.mapDesc(u.changes).invertedDesc}f=le.create(t,s,f.selection&&f.selection.map(h),Ht.mapEffects(f.effects,h),f.annotations,f.scrollIntoView)}let n=t.facet(xc);for(let s=n.length-1;s>=0;s--){let h=n[s](f);h instanceof le?f=h:Array.isArray(h)&&h.length==1&&h[0]instanceof le?f=h[0]:f=Mc(t,Ir(h),!1)}return f}function u0(f){let t=f.startState,i=t.facet(Sc),n=f;for(let s=i.length-1;s>=0;s--){let h=i[s](f);h&&Object.keys(h).length&&(n=Cc(n,ia(t,h,f.changes.newLength),!0))}return n==f?f:le.create(t,f.changes,f.selection,n.effects,n.annotations,n.scrollIntoView)}const c0=[];function Ir(f){return f==null?c0:Array.isArray(f)?f:[f]}var ci=function(f){return f[f.Word=0]="Word",f[f.Space=1]="Space",f[f.Other=2]="Other",f}(ci||(ci={}));const d0=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ra;try{ra=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function p0(f){if(ra)return ra.test(f);for(let t=0;t<f.length;t++){let i=f[t];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||d0.test(i)))return!0}return!1}function g0(f){return t=>{if(!/\S/.test(t))return ci.Space;if(p0(t))return ci.Word;for(let i=0;i<f.length;i++)if(t.indexOf(f[i])>-1)return ci.Word;return ci.Other}}class ut{constructor(t,i,n,s,h,u){this.config=t,this.doc=i,this.selection=n,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=h,u&&(u._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)Fn(this,d<<1);this.computeSlot=null}field(t,i=!0){let n=this.config.address[t.id];if(n==null){if(i)throw new RangeError("Field is not present in this state");return}return Fn(this,n),so(this,n)}update(...t){return Mc(this,t,!0)}applyTransaction(t){let i=this.config,{base:n,compartments:s}=i;for(let d of t.effects)d.is(_n.reconfigure)?(i&&(s=new Map,i.compartments.forEach((p,v)=>s.set(v,p)),i=null),s.set(d.value.compartment,d.value.extension)):d.is(Ht.reconfigure)?(i=null,n=d.value):d.is(Ht.appendConfig)&&(i=null,n=Ir(n).concat(d.value));let h;i?h=t.startState.values.slice():(i=no.resolve(n,s,this),h=new ut(i,this.doc,this.selection,i.dynamicSlots.map(()=>null),(p,v)=>v.reconfigure(p,this),null).values);let u=t.startState.facet(ea)?t.newSelection:t.newSelection.asSingle();new ut(i,t.newDoc,u,h,(d,p)=>p.update(d,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:t},range:j.cursor(i.from+t.length)}))}changeByRange(t){let i=this.selection,n=t(i.ranges[0]),s=this.changes(n.changes),h=[n.range],u=Ir(n.effects);for(let d=1;d<i.ranges.length;d++){let p=t(i.ranges[d]),v=this.changes(p.changes),b=v.map(s);for(let S=0;S<d;S++)h[S]=h[S].map(b);let x=s.mapDesc(v,!0);h.push(p.range.map(x)),s=s.compose(b),u=Ht.mapEffects(u,b).concat(Ht.mapEffects(Ir(p.effects),x))}return{changes:s,selection:j.create(h,i.mainIndex),effects:u}}changes(t=[]){return t instanceof qt?t:qt.of(t,this.doc.length,this.facet(ut.lineSeparator))}toText(t){return vt.of(t.split(this.facet(ut.lineSeparator)||Jl))}sliceDoc(t=0,i=this.doc.length){return this.doc.sliceString(t,i,this.lineBreak)}facet(t){let i=this.config.address[t.id];return i==null?t.default:(Fn(this,i),so(this,i))}toJSON(t){let i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let n in t){let s=t[n];s instanceof fr&&this.config.address[s.id]!=null&&(i[n]=s.spec.toJSON(this.field(t[n]),this))}return i}static fromJSON(t,i={},n){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let h in n)if(Object.prototype.hasOwnProperty.call(t,h)){let u=n[h],d=t[h];s.push(u.init(p=>u.spec.fromJSON(d,p)))}}return ut.create({doc:t.doc,selection:j.fromJSON(t.selection),extensions:i.extensions?s.concat([i.extensions]):s})}static create(t={}){let i=no.resolve(t.extensions||[],new Map),n=t.doc instanceof vt?t.doc:vt.of((t.doc||"").split(i.staticFacet(ut.lineSeparator)||Jl)),s=t.selection?t.selection instanceof j?t.selection:j.single(t.selection.anchor,t.selection.head):j.single(0);return gc(s,n.length),i.staticFacet(ea)||(s=s.asSingle()),new ut(i,n,s,i.dynamicSlots.map(()=>null),(h,u)=>u.create(h),null)}get tabSize(){return this.facet(ut.tabSize)}get lineBreak(){return this.facet(ut.lineSeparator)||`
`}get readOnly(){return this.facet(kc)}phrase(t,...i){for(let n of this.facet(ut.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return i.length&&(t=t.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let h=+(s||1);return!h||h>i.length?n:i[h-1]})),t}languageDataAt(t,i,n=-1){let s=[];for(let h of this.facet(yc))for(let u of h(this,i,n))Object.prototype.hasOwnProperty.call(u,t)&&s.push(u[t]);return s}charCategorizer(t){return g0(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:i,from:n,length:s}=this.doc.lineAt(t),h=this.charCategorizer(t),u=t-n,d=t-n;for(;u>0;){let p=ii(i,u,!1);if(h(i.slice(p,u))!=ci.Word)break;u=p}for(;d<s;){let p=ii(i,d);if(h(i.slice(d,p))!=ci.Word)break;d=p}return u==d?null:j.range(u+n,d+n)}}ut.allowMultipleSelections=ea;ut.tabSize=et.define({combine:f=>f.length?f[0]:4});ut.lineSeparator=bc;ut.readOnly=kc;ut.phrases=et.define({compare(f,t){let i=Object.keys(f),n=Object.keys(t);return i.length==n.length&&i.every(s=>f[s]==t[s])}});ut.languageData=yc;ut.changeFilter=wc;ut.transactionFilter=xc;ut.transactionExtender=Sc;_n.reconfigure=Ht.define();function m0(f,t,i={}){let n={};for(let s of f)for(let h of Object.keys(s)){let u=s[h],d=n[h];if(d===void 0)n[h]=u;else if(!(d===u||u===void 0))if(Object.hasOwnProperty.call(i,h))n[h]=i[h](d,u);else throw new Error("Config merge conflict for field "+h)}for(let s in t)n[s]===void 0&&(n[s]=t[s]);return n}class Kr{eq(t){return this==t}range(t,i=t){return na.create(t,i,this)}}Kr.prototype.startSide=Kr.prototype.endSide=0;Kr.prototype.point=!1;Kr.prototype.mapMode=Le.TrackDel;let na=class Ac{constructor(t,i,n){this.from=t,this.to=i,this.value=n}static create(t,i,n){return new Ac(t,i,n)}};function sa(f,t){return f.from-t.from||f.value.startSide-t.value.startSide}class Ha{constructor(t,i,n,s){this.from=t,this.to=i,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(t,i,n,s=0){let h=n?this.to:this.from;for(let u=s,d=h.length;;){if(u==d)return u;let p=u+d>>1,v=h[p]-t||(n?this.value[p].endSide:this.value[p].startSide)-i;if(p==u)return v>=0?u:d;v>=0?d=p:u=p+1}}between(t,i,n,s){for(let h=this.findIndex(i,-1e9,!0),u=this.findIndex(n,1e9,!1,h);h<u;h++)if(s(this.from[h]+t,this.to[h]+t,this.value[h])===!1)return!1}map(t,i){let n=[],s=[],h=[],u=-1,d=-1;for(let p=0;p<this.value.length;p++){let v=this.value[p],b=this.from[p]+t,x=this.to[p]+t,S,M;if(b==x){let A=i.mapPos(b,v.startSide,v.mapMode);if(A==null||(S=M=A,v.startSide!=v.endSide&&(M=i.mapPos(b,v.endSide),M<S)))continue}else if(S=i.mapPos(b,v.startSide),M=i.mapPos(x,v.endSide),S>M||S==M&&v.startSide>0&&v.endSide<=0)continue;(M-S||v.endSide-v.startSide)<0||(u<0&&(u=S),v.point&&(d=Math.max(d,M-S)),n.push(v),s.push(S-u),h.push(M-u))}return{mapped:n.length?new Ha(s,h,n,d):null,pos:u}}}class bt{constructor(t,i,n,s){this.chunkPos=t,this.chunk=i,this.nextLayer=n,this.maxPoint=s}static create(t,i,n,s){return new bt(t,i,n,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let i of this.chunk)t+=i.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:i=[],sort:n=!1,filterFrom:s=0,filterTo:h=this.length}=t,u=t.filter;if(i.length==0&&!u)return this;if(n&&(i=i.slice().sort(sa)),this.isEmpty)return i.length?bt.of(i):this;let d=new Tc(this,null,-1).goto(0),p=0,v=[],b=new oo;for(;d.value||p<i.length;)if(p<i.length&&(d.from-i[p].from||d.startSide-i[p].value.startSide)>=0){let x=i[p++];b.addInner(x.from,x.to,x.value)||v.push(x)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==i.length||this.chunkEnd(d.chunkIndex)<i[p].from)&&(!u||s>this.chunkEnd(d.chunkIndex)||h<this.chunkPos[d.chunkIndex])&&b.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!u||s>d.to||h<d.from||u(d.from,d.to,d.value))&&(b.addInner(d.from,d.to,d.value)||v.push(na.create(d.from,d.to,d.value))),d.next());return b.finishInner(this.nextLayer.isEmpty&&!v.length?bt.empty:this.nextLayer.update({add:v,filter:u,filterFrom:s,filterTo:h}))}map(t){if(t.empty||this.isEmpty)return this;let i=[],n=[],s=-1;for(let u=0;u<this.chunk.length;u++){let d=this.chunkPos[u],p=this.chunk[u],v=t.touchesRange(d,d+p.length);if(v===!1)s=Math.max(s,p.maxPoint),i.push(p),n.push(t.mapPos(d));else if(v===!0){let{mapped:b,pos:x}=p.map(d,t);b&&(s=Math.max(s,b.maxPoint),i.push(b),n.push(x))}}let h=this.nextLayer.map(t);return i.length==0?h:new bt(n,i,h||bt.empty,s)}between(t,i,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let h=this.chunkPos[s],u=this.chunk[s];if(i>=h&&t<=h+u.length&&u.between(h,t-h,i-h,n)===!1)return}this.nextLayer.between(t,i,n)}}iter(t=0){return Gn.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,i=0){return Gn.from(t).goto(i)}static compare(t,i,n,s,h=-1){let u=t.filter(x=>x.maxPoint>0||!x.isEmpty&&x.maxPoint>=h),d=i.filter(x=>x.maxPoint>0||!x.isEmpty&&x.maxPoint>=h),p=lu(u,d,n),v=new Dn(u,p,h),b=new Dn(d,p,h);n.iterGaps((x,S,M)=>au(v,x,b,S,M,s)),n.empty&&n.length==0&&au(v,0,b,0,0,s)}static eq(t,i,n=0,s){s==null&&(s=1e9-1);let h=t.filter(b=>!b.isEmpty&&i.indexOf(b)<0),u=i.filter(b=>!b.isEmpty&&t.indexOf(b)<0);if(h.length!=u.length)return!1;if(!h.length)return!0;let d=lu(h,u),p=new Dn(h,d,0).goto(n),v=new Dn(u,d,0).goto(n);for(;;){if(p.to!=v.to||!oa(p.active,v.active)||p.point&&(!v.point||!p.point.eq(v.point)))return!1;if(p.to>s)return!0;p.next(),v.next()}}static spans(t,i,n,s,h=-1){let u=new Dn(t,null,h).goto(i),d=i,p=u.openStart;for(;;){let v=Math.min(u.to,n);if(u.point){let b=u.activeForPoint(u.to),x=u.pointFrom<i?b.length+1:u.point.startSide<0?b.length:Math.min(b.length,p);s.point(d,v,u.point,b,x,u.pointRank),p=Math.min(u.openEnd(v),b.length)}else v>d&&(s.span(d,v,u.active,p),p=u.openEnd(v));if(u.to>n)return p+(u.point&&u.to>n?1:0);d=u.to,u.next()}}static of(t,i=!1){let n=new oo;for(let s of t instanceof na?[t]:i?v0(t):t)n.add(s.from,s.to,s.value);return n.finish()}static join(t){if(!t.length)return bt.empty;let i=t[t.length-1];for(let n=t.length-2;n>=0;n--)for(let s=t[n];s!=bt.empty;s=s.nextLayer)i=new bt(s.chunkPos,s.chunk,i,Math.max(s.maxPoint,i.maxPoint));return i}}bt.empty=new bt([],[],null,-1);function v0(f){if(f.length>1)for(let t=f[0],i=1;i<f.length;i++){let n=f[i];if(sa(t,n)>0)return f.slice().sort(sa);t=n}return f}bt.empty.nextLayer=bt.empty;class oo{finishChunk(t){this.chunks.push(new Ha(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,i,n){this.addInner(t,i,n)||(this.nextLayer||(this.nextLayer=new oo)).add(t,i,n)}addInner(t,i,n){let s=t-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(i-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=i,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,i-t)),!0)}addChunk(t,i){if((t-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(t);let n=i.value.length-1;return this.last=i.value[n],this.lastFrom=i.from[n]+t,this.lastTo=i.to[n]+t,!0}finish(){return this.finishInner(bt.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let i=bt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,i}}function lu(f,t,i){let n=new Map;for(let h of f)for(let u=0;u<h.chunk.length;u++)h.chunk[u].maxPoint<=0&&n.set(h.chunk[u],h.chunkPos[u]);let s=new Set;for(let h of t)for(let u=0;u<h.chunk.length;u++){let d=n.get(h.chunk[u]);d!=null&&(i?i.mapPos(d):d)==h.chunkPos[u]&&!(i!=null&&i.touchesRange(d,d+h.chunk[u].length))&&s.add(h.chunk[u])}return s}class Tc{constructor(t,i,n,s=0){this.layer=t,this.skip=i,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,i=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,i,!1),this}gotoInner(t,i,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<t||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],i,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(t,i){(this.to-t||this.endSide-i)<0&&this.gotoInner(t,i,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],i=this.layer.chunk[this.chunkIndex],n=t+i.from[this.rangeIndex];if(this.from=n,this.to=t+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Gn{constructor(t){this.heap=t}static from(t,i=null,n=-1){let s=[];for(let h=0;h<t.length;h++)for(let u=t[h];!u.isEmpty;u=u.nextLayer)u.maxPoint>=n&&s.push(new Tc(u,i,n,h));return s.length==1?s[0]:new Gn(s)}get startSide(){return this.value?this.value.startSide:0}goto(t,i=-1e9){for(let n of this.heap)n.goto(t,i);for(let n=this.heap.length>>1;n>=0;n--)El(this.heap,n);return this.next(),this}forward(t,i){for(let n of this.heap)n.forward(t,i);for(let n=this.heap.length>>1;n>=0;n--)El(this.heap,n);(this.to-t||this.value.endSide-i)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),El(this.heap,0)}}}function El(f,t){for(let i=f[t];;){let n=(t<<1)+1;if(n>=f.length)break;let s=f[n];if(n+1<f.length&&s.compare(f[n+1])>=0&&(s=f[n+1],n++),i.compare(s)<0)break;f[n]=i,f[t]=s,t=n}}class Dn{constructor(t,i,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Gn.from(t,i,n)}goto(t,i=-1e9){return this.cursor.goto(t,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=i,this.openStart=-1,this.next(),this}forward(t,i){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(t,i)}removeActive(t){Bs(this.active,t),Bs(this.activeTo,t),Bs(this.activeRank,t),this.minActive=hu(this.active,this.activeTo)}addActive(t){let i=0,{value:n,to:s,rank:h}=this.cursor;for(;i<this.activeRank.length&&(h-this.activeRank[i]||s-this.activeTo[i])>0;)i++;Rs(this.active,i,n),Rs(this.activeTo,i,s),Rs(this.activeRank,i,h),t&&Rs(t,i,this.cursor.from),this.minActive=hu(this.active,this.activeTo)}next(){let t=this.to,i=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>t){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&Bs(n,s)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let h=this.cursor.value;if(!h.point)this.addActive(n),this.cursor.next();else if(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=h,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=h.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<t;s--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let i=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&i.push(this.active[n]);return i.reverse()}openEnd(t){let i=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)i++;return i}}function au(f,t,i,n,s,h){f.goto(t),i.goto(n);let u=n+s,d=n,p=n-t;for(;;){let v=f.to+p-i.to||f.endSide-i.endSide,b=v<0?f.to+p:i.to,x=Math.min(b,u);if(f.point||i.point?f.point&&i.point&&(f.point==i.point||f.point.eq(i.point))&&oa(f.activeForPoint(f.to),i.activeForPoint(i.to))||h.comparePoint(d,x,f.point,i.point):x>d&&!oa(f.active,i.active)&&h.compareRange(d,x,f.active,i.active),b>u)break;d=b,v<=0&&f.next(),v>=0&&i.next()}}function oa(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++)if(f[i]!=t[i]&&!f[i].eq(t[i]))return!1;return!0}function Bs(f,t){for(let i=t,n=f.length-1;i<n;i++)f[i]=f[i+1];f.pop()}function Rs(f,t,i){for(let n=f.length-1;n>=t;n--)f[n+1]=f[n];f[t]=i}function hu(f,t){let i=-1,n=1e9;for(let s=0;s<t.length;s++)(t[s]-n||f[s].endSide-f[i].endSide)<0&&(i=s,n=t[s]);return i}function y0(f,t,i=f.length){let n=0;for(let s=0;s<i;)f.charCodeAt(s)==9?(n+=t-n%t,s++):(n++,s=ii(f,s));return n}function b0(f,t,i,n){for(let s=0,h=0;;){if(h>=t)return s;if(s==f.length)break;h+=f.charCodeAt(s)==9?i-h%i:1,s=ii(f,s)}return n===!0?-1:f.length}const la="ͼ",fu=typeof Symbol>"u"?"__"+la:Symbol.for(la),aa=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),uu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ur{constructor(t,i){this.rules=[];let{finish:n}=i||{};function s(u){return/^@/.test(u)?[u]:u.split(/,\s*/)}function h(u,d,p,v){let b=[],x=/^@(\w+)\b/.exec(u[0]),S=x&&x[1]=="keyframes";if(x&&d==null)return p.push(u[0]+";");for(let M in d){let A=d[M];if(/&/.test(M))h(M.split(/,\s*/).map(D=>u.map(N=>D.replace(/&/,N))).reduce((D,N)=>D.concat(N)),A,p);else if(A&&typeof A=="object"){if(!x)throw new RangeError("The value of a property ("+M+") should be a primitive value.");h(s(M),A,b,S)}else A!=null&&b.push(M.replace(/_.*/,"").replace(/[A-Z]/g,D=>"-"+D.toLowerCase())+": "+A+";")}(b.length||S)&&p.push((n&&!x&&!v?u.map(n):u).join(", ")+" {"+b.join(" ")+"}")}for(let u in t)h(s(u),t[u],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=uu[fu]||1;return uu[fu]=t+1,la+t.toString(36)}static mount(t,i,n){let s=t[aa],h=n&&n.nonce;s?h&&s.setNonce(h):s=new w0(t,h),s.mount(Array.isArray(i)?i:[i],t)}}let cu=new Map;class w0{constructor(t,i){let n=t.ownerDocument||t,s=n.defaultView;if(!t.head&&t.adoptedStyleSheets&&s.CSSStyleSheet){let h=cu.get(n);if(h)return t[aa]=h;this.sheet=new s.CSSStyleSheet,cu.set(n,this)}else this.styleTag=n.createElement("style"),i&&this.styleTag.setAttribute("nonce",i);this.modules=[],t[aa]=this}mount(t,i){let n=this.sheet,s=0,h=0;for(let u=0;u<t.length;u++){let d=t[u],p=this.modules.indexOf(d);if(p<h&&p>-1&&(this.modules.splice(p,1),h--,p=-1),p==-1){if(this.modules.splice(h++,0,d),n)for(let v=0;v<d.rules.length;v++)n.insertRule(d.rules[v],s++)}else{for(;h<p;)s+=this.modules[h++].rules.length;s+=d.rules.length,h++}}if(n)i.adoptedStyleSheets.indexOf(this.sheet)<0&&(i.adoptedStyleSheets=[this.sheet,...i.adoptedStyleSheets]);else{let u="";for(let p=0;p<this.modules.length;p++)u+=this.modules[p].getRules()+`
`;this.styleTag.textContent=u;let d=i.head||i;this.styleTag.parentNode!=d&&d.insertBefore(this.styleTag,d.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var Ri={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Vn={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},x0=typeof navigator<"u"&&/Mac/.test(navigator.platform),S0=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Qt=0;Qt<10;Qt++)Ri[48+Qt]=Ri[96+Qt]=String(Qt);for(var Qt=1;Qt<=24;Qt++)Ri[Qt+111]="F"+Qt;for(var Qt=65;Qt<=90;Qt++)Ri[Qt]=String.fromCharCode(Qt+32),Vn[Qt]=String.fromCharCode(Qt);for(var Bl in Ri)Vn.hasOwnProperty(Bl)||(Vn[Bl]=Ri[Bl]);function k0(f){var t=x0&&f.metaKey&&f.shiftKey&&!f.ctrlKey&&!f.altKey||S0&&f.shiftKey&&f.key&&f.key.length==1||f.key=="Unidentified",i=!t&&f.key||(f.shiftKey?Vn:Ri)[f.keyCode]||f.key||"Unidentified";return i=="Esc"&&(i="Escape"),i=="Del"&&(i="Delete"),i=="Left"&&(i="ArrowLeft"),i=="Up"&&(i="ArrowUp"),i=="Right"&&(i="ArrowRight"),i=="Down"&&(i="ArrowDown"),i}function qn(f){let t;return f.nodeType==11?t=f.getSelection?f:f.ownerDocument:t=f,t.getSelection()}function ha(f,t){return t?f==t||f.contains(t.nodeType!=1?t.parentNode:t):!1}function C0(f){let t=f.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function $s(f,t){if(!t.anchorNode)return!1;try{return ha(f,t.anchorNode)}catch{return!1}}function Gr(f){return f.nodeType==3?lr(f,0,f.nodeValue.length).getClientRects():f.nodeType==1?f.getClientRects():[]}function zn(f,t,i,n){return i?du(f,t,i,n,-1)||du(f,t,i,n,1):!1}function or(f){for(var t=0;;t++)if(f=f.previousSibling,!f)return t}function lo(f){return f.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(f.nodeName)}function du(f,t,i,n,s){for(;;){if(f==i&&t==n)return!0;if(t==(s<0?0:gi(f))){if(f.nodeName=="DIV")return!1;let h=f.parentNode;if(!h||h.nodeType!=1)return!1;t=or(f)+(s<0?0:1),f=h}else if(f.nodeType==1){if(f=f.childNodes[t+(s<0?-1:0)],f.nodeType==1&&f.contentEditable=="false")return!1;t=s<0?gi(f):0}else return!1}}function gi(f){return f.nodeType==3?f.nodeValue.length:f.childNodes.length}function go(f,t){let i=t?f.left:f.right;return{left:i,right:i,top:f.top,bottom:f.bottom}}function M0(f){let t=f.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:f.innerWidth,top:0,bottom:f.innerHeight}}function Lc(f,t){let i=t.width/f.offsetWidth,n=t.height/f.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.width-f.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.height-f.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}function A0(f,t,i,n,s,h,u,d){let p=f.ownerDocument,v=p.defaultView||window;for(let b=f,x=!1;b&&!x;)if(b.nodeType==1){let S,M=b==p.body,A=1,D=1;if(M)S=M0(v);else{if(/^(fixed|sticky)$/.test(getComputedStyle(b).position)&&(x=!0),b.scrollHeight<=b.clientHeight&&b.scrollWidth<=b.clientWidth){b=b.assignedSlot||b.parentNode;continue}let W=b.getBoundingClientRect();({scaleX:A,scaleY:D}=Lc(b,W)),S={left:W.left,right:W.left+b.clientWidth*A,top:W.top,bottom:W.top+b.clientHeight*D}}let N=0,P=0;if(s=="nearest")t.top<S.top?(P=-(S.top-t.top+u),i>0&&t.bottom>S.bottom+P&&(P=t.bottom-S.bottom+P+u)):t.bottom>S.bottom&&(P=t.bottom-S.bottom+u,i<0&&t.top-P<S.top&&(P=-(S.top+P-t.top+u)));else{let W=t.bottom-t.top,_=S.bottom-S.top;P=(s=="center"&&W<=_?t.top+W/2-_/2:s=="start"||s=="center"&&i<0?t.top-u:t.bottom-_+u)-S.top}if(n=="nearest"?t.left<S.left?(N=-(S.left-t.left+h),i>0&&t.right>S.right+N&&(N=t.right-S.right+N+h)):t.right>S.right&&(N=t.right-S.right+h,i<0&&t.left<S.left+N&&(N=-(S.left+N-t.left+h))):N=(n=="center"?t.left+(t.right-t.left)/2-(S.right-S.left)/2:n=="start"==d?t.left-h:t.right-(S.right-S.left)+h)-S.left,N||P)if(M)v.scrollBy(N,P);else{let W=0,_=0;if(P){let Y=b.scrollTop;b.scrollTop+=P/D,_=(b.scrollTop-Y)*D}if(N){let Y=b.scrollLeft;b.scrollLeft+=N/A,W=(b.scrollLeft-Y)*A}t={left:t.left-W,top:t.top-_,right:t.right-W,bottom:t.bottom-_},W&&Math.abs(W-N)<1&&(n="nearest"),_&&Math.abs(_-P)<1&&(s="nearest")}if(M)break;b=b.assignedSlot||b.parentNode}else if(b.nodeType==11)b=b.host;else break}function T0(f){let t=f.ownerDocument,i,n;for(let s=f.parentNode;s&&!(s==t.body||i&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!i&&s.scrollWidth>s.clientWidth&&(i=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:i,y:n}}class L0{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:i,focusNode:n}=t;this.set(i,Math.min(t.anchorOffset,i?gi(i):0),n,Math.min(t.focusOffset,n?gi(n):0))}set(t,i,n,s){this.anchorNode=t,this.anchorOffset=i,this.focusNode=n,this.focusOffset=s}}let Er=null;function Oc(f){if(f.setActive)return f.setActive();if(Er)return f.focus(Er);let t=[];for(let i=f;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(f.focus(Er==null?{get preventScroll(){return Er={preventScroll:!0},!0}}:void 0),!Er){Er=!1;for(let i=0;i<t.length;){let n=t[i++],s=t[i++],h=t[i++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=h&&(n.scrollLeft=h)}}}let pu;function lr(f,t,i=t){let n=pu||(pu=document.createRange());return n.setEnd(f,i),n.setStart(f,t),n}function Wr(f,t,i,n){let s={key:t,code:t,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let h=new KeyboardEvent("keydown",s);h.synthetic=!0,f.dispatchEvent(h);let u=new KeyboardEvent("keyup",s);return u.synthetic=!0,f.dispatchEvent(u),h.defaultPrevented||u.defaultPrevented}function O0(f){for(;f;){if(f&&(f.nodeType==9||f.nodeType==11&&f.host))return f;f=f.assignedSlot||f.parentNode}return null}function Dc(f){for(;f.attributes.length;)f.removeAttributeNode(f.attributes[0])}function D0(f,t){let i=t.focusNode,n=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=n)return!1;for(n=Math.min(n,gi(i));;)if(n){if(i.nodeType!=1)return!1;let s=i.childNodes[n-1];s.contentEditable=="false"?n--:(i=s,n=gi(i))}else{if(i==f)return!0;n=or(i),i=i.parentNode}}function Nc(f){return f.scrollTop>Math.max(1,f.scrollHeight-f.clientHeight-4)}function Pc(f,t){for(let i=f,n=t;;){if(i.nodeType==3&&n>0)return{node:i,offset:n};if(i.nodeType==1&&n>0){if(i.contentEditable=="false")return null;i=i.childNodes[n-1],n=gi(i)}else if(i.parentNode&&!lo(i))n=or(i),i=i.parentNode;else return null}}function Ec(f,t){for(let i=f,n=t;;){if(i.nodeType==3&&n<i.nodeValue.length)return{node:i,offset:n};if(i.nodeType==1&&n<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[n],n=0}else if(i.parentNode&&!lo(i))n=or(i)+1,i=i.parentNode;else return null}}class oe{constructor(t,i,n=!0){this.node=t,this.offset=i,this.precise=n}static before(t,i){return new oe(t.parentNode,or(t),i)}static after(t,i){return new oe(t.parentNode,or(t)+1,i)}}const Ia=[];class St{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let i=this.posAtStart;for(let n of this.children){if(n==t)return i;i+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,i){if(this.flags&2){let n=this.dom,s=null,h;for(let u of this.children){if(u.flags&7){if(!u.dom&&(h=s?s.nextSibling:n.firstChild)){let d=St.get(h);(!d||!d.parent&&d.canReuseDOM(u))&&u.reuseDOM(h)}u.sync(t,i),u.flags&=-8}if(h=s?s.nextSibling:n.firstChild,i&&!i.written&&i.node==n&&h!=u.dom&&(i.written=!0),u.dom.parentNode==n)for(;h&&h!=u.dom;)h=gu(h);else n.insertBefore(u.dom,h);s=u.dom}for(h=s?s.nextSibling:n.firstChild,h&&i&&i.node==n&&(i.written=!0);h;)h=gu(h)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(t,i),n.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,i){let n;if(t==this.dom)n=this.dom.childNodes[i];else{let s=gi(t)==0?0:i==0?-1:1;for(;;){let h=t.parentNode;if(h==this.dom)break;s==0&&h.firstChild!=h.lastChild&&(t==h.firstChild?s=-1:s=1),t=h}s<0?n=t:n=t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!St.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,h=0;;s++){let u=this.children[s];if(u.dom==n)return h;h+=u.length+u.breakAfter}}domBoundsAround(t,i,n=0){let s=-1,h=-1,u=-1,d=-1;for(let p=0,v=n,b=n;p<this.children.length;p++){let x=this.children[p],S=v+x.length;if(v<t&&S>i)return x.domBoundsAround(t,i,v);if(S>=t&&s==-1&&(s=p,h=v),v>i&&x.dom.parentNode==this.dom){u=p,d=b;break}b=S,v=S+x.breakAfter}return{from:h,to:d<0?n+this.length:d,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let i=this.parent;i;i=i.parent){if(t&&(i.flags|=2),i.flags&1)return;i.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let i=t.parent;if(!i)return t;t=i}}replaceChildren(t,i,n=Ia){this.markDirty();for(let s=t;s<i;s++){let h=this.children[s];h.parent==this&&n.indexOf(h)<0&&h.destroy()}this.children.splice(t,i-t,...n);for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Bc(this.children,t,this.children.length)}childPos(t,i=1){return this.childCursor().findPos(t,i)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,i,n,s,h,u){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}St.prototype.breakAfter=0;function gu(f){let t=f.nextSibling;return f.parentNode.removeChild(f),t}class Bc{constructor(t,i,n){this.children=t,this.pos=i,this.i=n,this.off=0}findPos(t,i=1){for(;;){if(t>this.pos||t==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Rc(f,t,i,n,s,h,u,d,p){let{children:v}=f,b=v.length?v[t]:null,x=h.length?h[h.length-1]:null,S=x?x.breakAfter:u;if(!(t==n&&b&&!u&&!S&&h.length<2&&b.merge(i,s,h.length?x:null,i==0,d,p))){if(n<v.length){let M=v[n];M&&(s<M.length||M.breakAfter&&(x!=null&&x.breakAfter))?(t==n&&(M=M.split(s),s=0),!S&&x&&M.merge(0,s,x,!0,0,p)?h[h.length-1]=M:((s||M.children.length&&!M.children[0].length)&&M.merge(0,s,null,!1,0,p),h.push(M))):M!=null&&M.breakAfter&&(x?x.breakAfter=1:u=1),n++}for(b&&(b.breakAfter=u,i>0&&(!u&&h.length&&b.merge(i,b.length,h[0],!1,d,0)?b.breakAfter=h.shift().breakAfter:(i<b.length||b.children.length&&b.children[b.children.length-1].length==0)&&b.merge(i,b.length,null,!1,d,0),t++));t<n&&h.length;)if(v[n-1].become(h[h.length-1]))n--,h.pop(),p=h.length?0:d;else if(v[t].become(h[0]))t++,h.shift(),d=h.length?0:p;else break;!h.length&&t&&n<v.length&&!v[t-1].breakAfter&&v[n].merge(0,0,v[t-1],!1,d,p)&&t--,(t<n||h.length)&&f.replaceChildren(t,n,h)}}function Hc(f,t,i,n,s,h){let u=f.childCursor(),{i:d,off:p}=u.findPos(i,1),{i:v,off:b}=u.findPos(t,-1),x=t-i;for(let S of n)x+=S.length;f.length+=x,Rc(f,v,b,d,p,n,0,s,h)}let Se=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},fa=typeof document<"u"?document:{documentElement:{style:{}}};const ua=/Edge\/(\d+)/.exec(Se.userAgent),Ic=/MSIE \d/.test(Se.userAgent),ca=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Se.userAgent),mo=!!(Ic||ca||ua),mu=!mo&&/gecko\/(\d+)/i.test(Se.userAgent),Rl=!mo&&/Chrome\/(\d+)/.exec(Se.userAgent),vu="webkitFontSmoothing"in fa.documentElement.style,Wc=!mo&&/Apple Computer/.test(Se.vendor),yu=Wc&&(/Mobile\/\w+/.test(Se.userAgent)||Se.maxTouchPoints>2);var G={mac:yu||/Mac/.test(Se.platform),windows:/Win/.test(Se.platform),linux:/Linux|X11/.test(Se.platform),ie:mo,ie_version:Ic?fa.documentMode||6:ca?+ca[1]:ua?+ua[1]:0,gecko:mu,gecko_version:mu?+(/Firefox\/(\d+)/.exec(Se.userAgent)||[0,0])[1]:0,chrome:!!Rl,chrome_version:Rl?+Rl[1]:0,ios:yu,android:/Android\b/.test(Se.userAgent),webkit:vu,safari:Wc,webkit_version:vu?+(/\bAppleWebKit\/(\d+)/.exec(Se.userAgent)||[0,0])[1]:0,tabSize:fa.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const N0=256;class Ke extends St{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,i,n){return this.flags&8||n&&(!(n instanceof Ke)||this.length-(i-t)+n.length>N0||n.flags&8)?!1:(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(i),this.markDirty(),!0)}split(t){let i=new Ke(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(t,i){return t==this.dom?i:i?this.text.length:0}domAtPos(t){return new oe(this.dom,t)}domBoundsAround(t,i,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,i){return P0(this.dom,t,i)}}class mi extends St{constructor(t,i=[],n=0){super(),this.mark=t,this.children=i,this.length=n;for(let s of i)s.setParent(this)}setAttrs(t){if(Dc(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)t.setAttribute(i,this.mark.attrs[i]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,i)}merge(t,i,n,s,h,u){return n&&(!(n instanceof mi&&n.mark.eq(this.mark))||t&&h<=0||i<this.length&&u<=0)?!1:(Hc(this,t,i,n?n.children.slice():[],h-1,u-1),this.markDirty(),!0)}split(t){let i=[],n=0,s=-1,h=0;for(let d of this.children){let p=n+d.length;p>t&&i.push(n<t?d.split(t-n):d),s<0&&n>=t&&(s=h),n=p,h++}let u=this.length-t;return this.length=t,s>-1&&(this.children.length=s,this.markDirty()),new mi(this.mark,i,u)}domAtPos(t){return Fc(this,t)}coordsAt(t,i){return Kc(this,t,i)}}function P0(f,t,i){let n=f.nodeValue.length;t>n&&(t=n);let s=t,h=t,u=0;t==0&&i<0||t==n&&i>=0?G.chrome||G.gecko||(t?(s--,u=1):h<n&&(h++,u=-1)):i<0?s--:h<n&&h++;let d=lr(f,s,h).getClientRects();if(!d.length)return null;let p=d[(u?u<0:i>=0)?0:d.length-1];return G.safari&&!u&&p.width==0&&(p=Array.prototype.find.call(d,v=>v.width)||p),u?go(p,u<0):p||null}class nr extends St{static create(t,i,n){return new nr(t,i,n)}constructor(t,i,n){super(),this.widget=t,this.length=i,this.side=n,this.prevWidget=null}split(t){let i=nr.create(this.widget,this.length-t,this.side);return this.length-=t,i}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,i,n,s,h,u){return n&&(!(n instanceof nr)||!this.widget.compare(n.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-i),!0)}become(t){return t instanceof nr&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return vt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:i}=t,n=i&&i.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):vt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?oe.before(this.dom):oe.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,i){let n=this.widget.coordsAt(this.dom,t,i);if(n)return n;let s=this.dom.getClientRects(),h=null;if(!s.length)return null;let u=this.side?this.side<0:t>0;for(let d=u?s.length-1:0;h=s[d],!(t>0?d==0:d==s.length-1||h.top<h.bottom);d+=u?-1:1);return go(h,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Vr extends St{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Vr&&t.side==this.side}split(){return new Vr(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?oe.before(this.dom):oe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return vt.empty}get isHidden(){return!0}}Ke.prototype.children=nr.prototype.children=Vr.prototype.children=Ia;function Fc(f,t){let i=f.dom,{children:n}=f,s=0;for(let h=0;s<n.length;s++){let u=n[s],d=h+u.length;if(!(d==h&&u.getSide()<=0)){if(t>h&&t<d&&u.dom.parentNode==i)return u.domAtPos(t-h);if(t<=h)break;h=d}}for(let h=s;h>0;h--){let u=n[h-1];if(u.dom.parentNode==i)return u.domAtPos(u.length)}for(let h=s;h<n.length;h++){let u=n[h];if(u.dom.parentNode==i)return u.domAtPos(0)}return new oe(i,0)}function zc(f,t,i){let n,{children:s}=f;i>0&&t instanceof mi&&s.length&&(n=s[s.length-1])instanceof mi&&n.mark.eq(t.mark)?zc(n,t.children[0],i-1):(s.push(t),t.setParent(f)),f.length+=t.length}function Kc(f,t,i){let n=null,s=-1,h=null,u=-1;function d(v,b){for(let x=0,S=0;x<v.children.length&&S<=b;x++){let M=v.children[x],A=S+M.length;A>=b&&(M.children.length?d(M,b-S):(!h||h.isHidden&&i>0)&&(A>b||S==A&&M.getSide()>0)?(h=M,u=b-S):(S<b||S==A&&M.getSide()<0&&!M.isHidden)&&(n=M,s=b-S)),S=A}}d(f,t);let p=(i<0?n:h)||n||h;return p?p.coordsAt(Math.max(0,p==n?s:u),i):E0(f)}function E0(f){let t=f.dom.lastChild;if(!t)return f.dom.getBoundingClientRect();let i=Gr(t);return i[i.length-1]||null}function da(f,t){for(let i in f)i=="class"&&t.class?t.class+=" "+f.class:i=="style"&&t.style?t.style+=";"+f.style:t[i]=f[i];return t}const bu=Object.create(null);function ao(f,t,i){if(f==t)return!0;f||(f=bu),t||(t=bu);let n=Object.keys(f),s=Object.keys(t);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let h of n)if(h!=i&&(s.indexOf(h)==-1||f[h]!==t[h]))return!1;return!0}function pa(f,t,i){let n=!1;if(t)for(let s in t)i&&s in i||(n=!0,s=="style"?f.style.cssText="":f.removeAttribute(s));if(i)for(let s in i)t&&t[s]==i[s]||(n=!0,s=="style"?f.style.cssText=i[s]:f.setAttribute(s,i[s]));return n}function B0(f){let t=Object.create(null);for(let i=0;i<f.attributes.length;i++){let n=f.attributes[i];t[n.name]=n.value}return t}class Rt extends St{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,i,n,s,h,u){if(n){if(!(n instanceof Rt))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),Hc(this,t,i,n?n.children.slice():[],h,u),!0}split(t){let i=new Rt;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:n,off:s}=this.childPos(t);s&&(i.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let h=n;h<this.children.length;h++)i.append(this.children[h],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,i}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){ao(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,i){zc(this,t,i)}addLineDeco(t){let i=t.spec.attributes,n=t.spec.class;i&&(this.attrs=da(i,this.attrs||{})),n&&(this.attrs=da({class:n},this.attrs||{}))}domAtPos(t){return Fc(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,i){var n;this.dom?this.flags&4&&(Dc(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(pa(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,i);let s=this.dom.lastChild;for(;s&&St.get(s)instanceof mi;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=St.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!G.ios||!this.children.some(h=>h instanceof Ke))){let h=document.createElement("BR");h.cmIgnore=!0,this.dom.appendChild(h)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,i;for(let n of this.children){if(!(n instanceof Ke)||/[^ -~]/.test(n.text))return null;let s=Gr(n.dom);if(s.length!=1)return null;t+=s[0].width,i=s[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:i}:null}coordsAt(t,i){let n=Kc(this,t,i);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,h=n.bottom-n.top;if(Math.abs(h-s.lineHeight)<2&&s.textHeight<h){let u=(h-s.textHeight)/2;return{top:n.top+u,bottom:n.bottom-u,left:n.left,right:n.left}}}return n}become(t){return t instanceof Rt&&this.children.length==0&&t.children.length==0&&ao(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,i){for(let n=0,s=0;n<t.children.length;n++){let h=t.children[n],u=s+h.length;if(u>=i){if(h instanceof Rt)return h;if(u>i)break}s=u+h.breakAfter}return null}}class pi extends St{constructor(t,i,n){super(),this.widget=t,this.length=i,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(t,i,n,s,h,u){return n&&(!(n instanceof pi)||!this.widget.compare(n.widget)||t>0&&h<=0||i<this.length&&u<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-i),!0)}domAtPos(t){return t==0?oe.before(this.dom):oe.after(this.dom,t==this.length)}split(t){let i=this.length-t;this.length=t;let n=new pi(this.widget,i,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Ia}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):vt.empty}domBoundsAround(){return null}become(t){return t instanceof pi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,i){return this.widget.coordsAt(this.dom,t,i)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:i,endSide:n}=this.deco;return i==n?!1:t<0?i<0:n>0}}class vo{eq(t){return!1}updateDOM(t,i){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,i,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Ee=function(f){return f[f.Text=0]="Text",f[f.WidgetBefore=1]="WidgetBefore",f[f.WidgetAfter=2]="WidgetAfter",f[f.WidgetRange=3]="WidgetRange",f}(Ee||(Ee={}));class It extends Kr{constructor(t,i,n,s){super(),this.startSide=t,this.endSide=i,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(t){return new jn(t)}static widget(t){let i=Math.max(-1e4,Math.min(1e4,t.side||0)),n=!!t.block;return i+=n&&!t.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new Hi(t,i,i,n,t.widget||null,!1)}static replace(t){let i=!!t.block,n,s;if(t.isBlockGap)n=-5e8,s=4e8;else{let{start:h,end:u}=Uc(t,i);n=(h?i?-3e8:-1:5e8)-1,s=(u?i?2e8:1:-6e8)+1}return new Hi(t,n,s,i,t.widget||null,!0)}static line(t){return new Jn(t)}static set(t,i=!1){return bt.of(t,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}It.none=bt.empty;class jn extends It{constructor(t){let{start:i,end:n}=Uc(t);super(i?-1:5e8,n?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var i,n;return this==t||t instanceof jn&&this.tagName==t.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(t.class||((n=t.attrs)===null||n===void 0?void 0:n.class))&&ao(this.attrs,t.attrs,"class")}range(t,i=t){if(t>=i)throw new RangeError("Mark decorations may not be empty");return super.range(t,i)}}jn.prototype.point=!1;class Jn extends It{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Jn&&this.spec.class==t.spec.class&&ao(this.spec.attributes,t.spec.attributes)}range(t,i=t){if(i!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,i)}}Jn.prototype.mapMode=Le.TrackBefore;Jn.prototype.point=!0;class Hi extends It{constructor(t,i,n,s,h,u){super(i,n,h,t),this.block=s,this.isReplace=u,this.mapMode=s?i<=0?Le.TrackBefore:Le.TrackAfter:Le.TrackDel}get type(){return this.startSide!=this.endSide?Ee.WidgetRange:this.startSide<=0?Ee.WidgetBefore:Ee.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Hi&&R0(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,i=t){if(this.isReplace&&(t>i||t==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,i)}}Hi.prototype.point=!0;function Uc(f,t=!1){let{inclusiveStart:i,inclusiveEnd:n}=f;return i==null&&(i=f.inclusive),n==null&&(n=f.inclusive),{start:i??t,end:n??t}}function R0(f,t){return f==t||!!(f&&t&&f.compare(t))}function ga(f,t,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=f?i[s]=Math.max(i[s],t):i.push(f,t)}class Kn{constructor(t,i,n,s){this.doc=t,this.pos=i,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof pi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Rt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Hs(new Vr(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof pi)&&this.getLine()}buildText(t,i,n){for(;t>0;){if(this.textOff==this.text.length){let{value:h,lineBreak:u,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=h,this.textOff=0}let s=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(i.slice(i.length-n)),this.getLine().append(Hs(new Ke(this.text.slice(this.textOff,this.textOff+s)),i),n),this.atCursorPos=!0,this.textOff+=s,t-=s,n=0}}span(t,i,n,s){this.buildText(i-t,n,s),this.pos=i,this.openStart<0&&(this.openStart=s)}point(t,i,n,s,h,u){if(this.disallowBlockEffectsFor[u]&&n instanceof Hi){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=i-t;if(n instanceof Hi)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new pi(n.widget||qr.block,d,n));else{let p=nr.create(n.widget||qr.inline,d,d?0:n.startSide),v=this.atCursorPos&&!p.isEditable&&h<=s.length&&(t<i||n.startSide>0),b=!p.isEditable&&(t<i||h>s.length||n.startSide<=0),x=this.getLine();this.pendingBuffer==2&&!v&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),v&&(x.append(Hs(new Vr(1),s),h),h=s.length+Math.max(0,h-s.length)),x.append(Hs(p,s),h),this.atCursorPos=b,this.pendingBuffer=b?t<i||h>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=h)}static build(t,i,n,s,h){let u=new Kn(t,i,n,h);return u.openEnd=bt.spans(s,i,n,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function Hs(f,t){for(let i of t)f=new mi(i,[f],f.length);return f}class qr extends vo{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}qr.inline=new qr("span");qr.block=new qr("div");var Yt=function(f){return f[f.LTR=0]="LTR",f[f.RTL=1]="RTL",f}(Yt||(Yt={}));const ar=Yt.LTR,Wa=Yt.RTL;function Gc(f){let t=[];for(let i=0;i<f.length;i++)t.push(1<<+f[i]);return t}const H0=Gc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),I0=Gc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ma=Object.create(null),je=[];for(let f of["()","[]","{}"]){let t=f.charCodeAt(0),i=f.charCodeAt(1);ma[t]=i,ma[i]=-t}function Vc(f){return f<=247?H0[f]:1424<=f&&f<=1524?2:1536<=f&&f<=1785?I0[f-1536]:1774<=f&&f<=2220?4:8192<=f&&f<=8204?256:64336<=f&&f<=65023?4:1}const W0=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ei{get dir(){return this.level%2?Wa:ar}constructor(t,i,n){this.from=t,this.to=i,this.level=n}side(t,i){return this.dir==i==t?this.to:this.from}forward(t,i){return t==(this.dir==i)}static find(t,i,n,s){let h=-1;for(let u=0;u<t.length;u++){let d=t[u];if(d.from<=i&&d.to>=i){if(d.level==n)return u;(h<0||(s!=0?s<0?d.from<i:d.to>i:t[h].level>d.level))&&(h=u)}}if(h<0)throw new RangeError("Index out of range");return h}}function qc(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++){let n=f[i],s=t[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!qc(n.inner,s.inner))return!1}return!0}const xt=[];function F0(f,t,i,n,s){for(let h=0;h<=n.length;h++){let u=h?n[h-1].to:t,d=h<n.length?n[h].from:i,p=h?256:s;for(let v=u,b=p,x=p;v<d;v++){let S=Vc(f.charCodeAt(v));S==512?S=b:S==8&&x==4&&(S=16),xt[v]=S==4?2:S,S&7&&(x=S),b=S}for(let v=u,b=p,x=p;v<d;v++){let S=xt[v];if(S==128)v<d-1&&b==xt[v+1]&&b&24?S=xt[v]=b:xt[v]=256;else if(S==64){let M=v+1;for(;M<d&&xt[M]==64;)M++;let A=v&&b==8||M<i&&xt[M]==8?x==1?1:8:256;for(let D=v;D<M;D++)xt[D]=A;v=M-1}else S==8&&x==1&&(xt[v]=1);b=S,S&7&&(x=S)}}}function z0(f,t,i,n,s){let h=s==1?2:1;for(let u=0,d=0,p=0;u<=n.length;u++){let v=u?n[u-1].to:t,b=u<n.length?n[u].from:i;for(let x=v,S,M,A;x<b;x++)if(M=ma[S=f.charCodeAt(x)])if(M<0){for(let D=d-3;D>=0;D-=3)if(je[D+1]==-M){let N=je[D+2],P=N&2?s:N&4?N&1?h:s:0;P&&(xt[x]=xt[je[D]]=P),d=D;break}}else{if(je.length==189)break;je[d++]=x,je[d++]=S,je[d++]=p}else if((A=xt[x])==2||A==1){let D=A==s;p=D?0:1;for(let N=d-3;N>=0;N-=3){let P=je[N+2];if(P&2)break;if(D)je[N+2]|=2;else{if(P&4)break;je[N+2]|=4}}}}}function K0(f,t,i,n){for(let s=0,h=n;s<=i.length;s++){let u=s?i[s-1].to:f,d=s<i.length?i[s].from:t;for(let p=u;p<d;){let v=xt[p];if(v==256){let b=p+1;for(;;)if(b==d){if(s==i.length)break;b=i[s++].to,d=s<i.length?i[s].from:t}else if(xt[b]==256)b++;else break;let x=h==1,S=(b<t?xt[b]:n)==1,M=x==S?x?1:2:n;for(let A=b,D=s,N=D?i[D-1].to:f;A>p;)A==N&&(A=i[--D].from,N=D?i[D-1].to:f),xt[--A]=M;p=b}else h=v,p++}}}function va(f,t,i,n,s,h,u){let d=n%2?2:1;if(n%2==s%2)for(let p=t,v=0;p<i;){let b=!0,x=!1;if(v==h.length||p<h[v].from){let D=xt[p];D!=d&&(b=!1,x=D==16)}let S=!b&&d==1?[]:null,M=b?n:n+1,A=p;t:for(;;)if(v<h.length&&A==h[v].from){if(x)break t;let D=h[v];if(!b)for(let N=D.to,P=v+1;;){if(N==i)break t;if(P<h.length&&h[P].from==N)N=h[P++].to;else{if(xt[N]==d)break t;break}}if(v++,S)S.push(D);else{D.from>p&&u.push(new Ei(p,D.from,M));let N=D.direction==ar!=!(M%2);ya(f,N?n+1:n,s,D.inner,D.from,D.to,u),p=D.to}A=D.to}else{if(A==i||(b?xt[A]!=d:xt[A]==d))break;A++}S?va(f,p,A,n+1,s,S,u):p<A&&u.push(new Ei(p,A,M)),p=A}else for(let p=i,v=h.length;p>t;){let b=!0,x=!1;if(!v||p>h[v-1].to){let D=xt[p-1];D!=d&&(b=!1,x=D==16)}let S=!b&&d==1?[]:null,M=b?n:n+1,A=p;t:for(;;)if(v&&A==h[v-1].to){if(x)break t;let D=h[--v];if(!b)for(let N=D.from,P=v;;){if(N==t)break t;if(P&&h[P-1].to==N)N=h[--P].from;else{if(xt[N-1]==d)break t;break}}if(S)S.push(D);else{D.to<p&&u.push(new Ei(D.to,p,M));let N=D.direction==ar!=!(M%2);ya(f,N?n+1:n,s,D.inner,D.from,D.to,u),p=D.from}A=D.from}else{if(A==t||(b?xt[A-1]!=d:xt[A-1]==d))break;A--}S?va(f,A,p,n+1,s,S,u):A<p&&u.push(new Ei(A,p,M)),p=A}}function ya(f,t,i,n,s,h,u){let d=t%2?2:1;F0(f,s,h,n,d),z0(f,s,h,n,d),K0(s,h,n,d),va(f,s,h,t,i,n,u)}function U0(f,t,i){if(!f)return[new Ei(0,0,t==Wa?1:0)];if(t==ar&&!i.length&&!W0.test(f))return Yc(f.length);if(i.length)for(;f.length>xt.length;)xt[xt.length]=256;let n=[],s=t==ar?0:1;return ya(f,s,s,i,0,f.length,n),n}function Yc(f){return[new Ei(0,f,0)]}let Xc="";function G0(f,t,i,n,s){var h;let u=n.head-f.from,d=Ei.find(t,u,(h=n.bidiLevel)!==null&&h!==void 0?h:-1,n.assoc),p=t[d],v=p.side(s,i);if(u==v){let S=d+=s?1:-1;if(S<0||S>=t.length)return null;p=t[d=S],u=p.side(!s,i),v=p.side(s,i)}let b=ii(f.text,u,p.forward(s,i));(b<p.from||b>p.to)&&(b=v),Xc=f.text.slice(Math.min(u,b),Math.max(u,b));let x=d==(s?t.length-1:0)?null:t[d+(s?1:-1)];return x&&b==v&&x.level+(s?0:1)<p.level?j.cursor(x.side(!s,i)+f.from,x.forward(s,i)?1:-1,x.level):j.cursor(b+f.from,p.forward(s,i)?-1:1,p.level)}function V0(f,t,i){for(let n=t;n<i;n++){let s=Vc(f.charCodeAt(n));if(s==1)return ar;if(s==2||s==4)return Wa}return ar}const _c=et.define(),jc=et.define(),Jc=et.define(),Zc=et.define(),ba=et.define(),Qc=et.define(),$c=et.define(),td=et.define({combine:f=>f.some(t=>t)}),q0=et.define({combine:f=>f.some(t=>t)}),ed=et.define();class Fr{constructor(t,i="nearest",n="nearest",s=5,h=5,u=!1){this.range=t,this.y=i,this.x=n,this.yMargin=s,this.xMargin=h,this.isSnapshot=u}map(t){return t.empty?this:new Fr(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Fr(j.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Is=Ht.define({map:(f,t)=>f.map(t)}),id=Ht.define();function ri(f,t,i){let n=f.facet(Zc);n.length?n[0](t):window.onerror?window.onerror(String(t),i,void 0,void 0,t):i?console.error(i+":",t):console.error(t)}const Di=et.define({combine:f=>f.length?f[0]:!0});let Y0=0;const En=et.define();class Ii{constructor(t,i,n,s,h){this.id=t,this.create=i,this.domEventHandlers=n,this.domEventObservers=s,this.extension=h(this)}static define(t,i){const{eventHandlers:n,eventObservers:s,provide:h,decorations:u}=i||{};return new Ii(Y0++,t,n,s,d=>{let p=[En.of(d)];return u&&p.push(Yn.of(v=>{let b=v.plugin(d);return b?u(b):It.none})),h&&p.push(h(d)),p})}static fromClass(t,i){return Ii.define(n=>new t(n),i)}}class Hl{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(n){if(ri(i.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(i){ri(t.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(n){ri(t.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const rd=et.define(),Fa=et.define(),Yn=et.define(),nd=et.define(),za=et.define(),sd=et.define();function wu(f,t){let i=f.state.facet(sd);if(!i.length)return i;let n=i.map(h=>h instanceof Function?h(f):h),s=[];return bt.spans(n,t.from,t.to,{point(){},span(h,u,d,p){let v=h-t.from,b=u-t.from,x=s;for(let S=d.length-1;S>=0;S--,p--){let M=d[S].spec.bidiIsolate,A;if(M==null&&(M=V0(t.text,v,b)),p>0&&x.length&&(A=x[x.length-1]).to==v&&A.direction==M)A.to=b,x=A.inner;else{let D={from:v,to:b,direction:M,inner:[]};x.push(D),x=D.inner}}}}),s}const od=et.define();function ld(f){let t=0,i=0,n=0,s=0;for(let h of f.state.facet(od)){let u=h(f);u&&(u.left!=null&&(t=Math.max(t,u.left)),u.right!=null&&(i=Math.max(i,u.right)),u.top!=null&&(n=Math.max(n,u.top)),u.bottom!=null&&(s=Math.max(s,u.bottom)))}return{left:t,right:i,top:n,bottom:s}}const Bn=et.define();class Be{constructor(t,i,n,s){this.fromA=t,this.toA=i,this.fromB=n,this.toB=s}join(t){return new Be(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let i=t.length,n=this;for(;i>0;i--){let s=t[i-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),t.splice(i-1,1)}}return t.splice(i,0,n),t}static extendWithRanges(t,i){if(i.length==0)return t;let n=[];for(let s=0,h=0,u=0,d=0;;s++){let p=s==t.length?null:t[s],v=u-d,b=p?p.fromB:1e9;for(;h<i.length&&i[h]<b;){let x=i[h],S=i[h+1],M=Math.max(d,x),A=Math.min(b,S);if(M<=A&&new Be(M+v,A+v,M,A).addToSet(n),S>b)break;h+=2}if(!p)return n;new Be(p.fromA,p.toA,p.fromB,p.toB).addToSet(n),u=p.toA,d=p.toB}}}class ho{constructor(t,i,n){this.view=t,this.state=i,this.transactions=n,this.flags=0,this.startState=t.state,this.changes=qt.empty(this.startState.doc.length);for(let h of n)this.changes=this.changes.compose(h.changes);let s=[];this.changes.iterChangedRanges((h,u,d,p)=>s.push(new Be(h,u,d,p))),this.changedRanges=s}static create(t,i,n){return new ho(t,i,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class xu extends St{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=It.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Rt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Be(0,0,0,t.state.doc.length)],0,null)}update(t){var i;let n=t.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:v,toA:b})=>b<this.minWidthFrom||v>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?s=this.domChanged.newSel.head:!$0(t.changes,this.hasComposition)&&!t.selectionSet&&(s=t.state.selection.main.head));let h=s>-1?_0(this.view,t.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:v,to:b}=this.hasComposition;n=new Be(v,b,t.changes.mapPos(v,-1),t.changes.mapPos(b,1)).addToSet(n.slice())}this.hasComposition=h?{from:h.range.fromB,to:h.range.toB}:null,(G.ie||G.chrome)&&!h&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,d=this.updateDeco(),p=Z0(u,d,t.changes);return n=Be.extendWithRanges(n,p),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,t.startState.doc.length,h),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,i,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,i,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=G.chrome||G.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||s.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let h=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof pi&&u.widget instanceof Su&&h.push(u.dom);s.updateGaps(h)}updateChildren(t,i,n){let s=n?n.range.addToSet(t.slice()):t,h=this.childCursor(i);for(let u=s.length-1;;u--){let d=u>=0?s[u]:null;if(!d)break;let{fromA:p,toA:v,fromB:b,toB:x}=d,S,M,A,D;if(n&&n.range.fromB<x&&n.range.toB>b){let Y=Kn.build(this.view.state.doc,b,n.range.fromB,this.decorations,this.dynamicDecorationMap),V=Kn.build(this.view.state.doc,n.range.toB,x,this.decorations,this.dynamicDecorationMap);M=Y.breakAtStart,A=Y.openStart,D=V.openEnd;let st=this.compositionView(n);V.breakAtStart?st.breakAfter=1:V.content.length&&st.merge(st.length,st.length,V.content[0],!1,V.openStart,0)&&(st.breakAfter=V.content[0].breakAfter,V.content.shift()),Y.content.length&&st.merge(0,0,Y.content[Y.content.length-1],!0,0,Y.openEnd)&&Y.content.pop(),S=Y.content.concat(st).concat(V.content)}else({content:S,breakAtStart:M,openStart:A,openEnd:D}=Kn.build(this.view.state.doc,b,x,this.decorations,this.dynamicDecorationMap));let{i:N,off:P}=h.findPos(v,1),{i:W,off:_}=h.findPos(p,-1);Rc(this,W,_,N,P,S,M,A,D)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let i of t.transactions)for(let n of i.effects)n.is(id)&&(this.editContextFormatting=n.value)}compositionView(t){let i=new Ke(t.text.nodeValue);i.flags|=8;for(let{deco:s}of t.marks)i=new mi(s,[i],i.length);let n=new Rt;return n.append(i,0),n}fixCompositionDOM(t){let i=(h,u)=>{u.flags|=8|(u.children.some(p=>p.flags&7)?1:0),this.markedForComposition.add(u);let d=St.get(h);d&&d!=u&&(d.dom=null),u.setDOM(h)},n=this.childPos(t.range.fromB,1),s=this.children[n.i];i(t.line,s);for(let h=t.marks.length-1;h>=-1;h--)n=s.childPos(n.off,1),s=s.children[n.i],i(h>=0?t.marks[h].node:t.text,s)}updateSelection(t=!1,i=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,h=!s&&$s(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||i||h))return;let u=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.moveToLine(this.domAtPos(d.anchor)),v=d.empty?p:this.moveToLine(this.domAtPos(d.head));if(G.gecko&&d.empty&&!this.hasComposition&&X0(p)){let x=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(x,p.node.childNodes[p.offset]||null)),p=v=new oe(x,0),u=!0}let b=this.view.observer.selectionRange;(u||!b.focusNode||(!zn(p.node,p.offset,b.anchorNode,b.anchorOffset)||!zn(v.node,v.offset,b.focusNode,b.focusOffset))&&!this.suppressWidgetCursorChange(b,d))&&(this.view.observer.ignore(()=>{G.android&&G.chrome&&this.dom.contains(b.focusNode)&&Q0(b.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let x=qn(this.view.root);if(x)if(d.empty){if(G.gecko){let S=j0(p.node,p.offset);if(S&&S!=3){let M=(S==1?Pc:Ec)(p.node,p.offset);M&&(p=new oe(M.node,M.offset))}}x.collapse(p.node,p.offset),d.bidiLevel!=null&&x.caretBidiLevel!==void 0&&(x.caretBidiLevel=d.bidiLevel)}else if(x.extend){x.collapse(p.node,p.offset);try{x.extend(v.node,v.offset)}catch{}}else{let S=document.createRange();d.anchor>d.head&&([p,v]=[v,p]),S.setEnd(v.node,v.offset),S.setStart(p.node,p.offset),x.removeAllRanges(),x.addRange(S)}h&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(p,v)),this.impreciseAnchor=p.precise?null:new oe(b.anchorNode,b.anchorOffset),this.impreciseHead=v.precise?null:new oe(b.focusNode,b.focusOffset)}suppressWidgetCursorChange(t,i){return this.hasComposition&&i.empty&&zn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,i=t.state.selection.main,n=qn(t.root),{anchorNode:s,anchorOffset:h}=t.observer.selectionRange;if(!n||!i.empty||!i.assoc||!n.modify)return;let u=Rt.find(this,i.head);if(!u)return;let d=u.posAtStart;if(i.head==d||i.head==d+u.length)return;let p=this.coordsAt(i.head,-1),v=this.coordsAt(i.head,1);if(!p||!v||p.bottom>v.top)return;let b=this.domAtPos(i.head+i.assoc);n.collapse(b.node,b.offset),n.modify("move",i.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let x=t.observer.selectionRange;t.docView.posFromDOM(x.anchorNode,x.anchorOffset)!=i.from&&n.collapse(s,h)}moveToLine(t){let i=this.dom,n;if(t.node!=i)return t;for(let s=t.offset;!n&&s<i.childNodes.length;s++){let h=St.get(i.childNodes[s]);h instanceof Rt&&(n=h.domAtPos(0))}for(let s=t.offset-1;!n&&s>=0;s--){let h=St.get(i.childNodes[s]);h instanceof Rt&&(n=h.domAtPos(h.length))}return n?new oe(n.node,n.offset,!0):t}nearest(t){for(let i=t;i;){let n=St.get(i);if(n&&n.rootView==this)return n;i=i.parentNode}return null}posFromDOM(t,i){let n=this.nearest(t);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(t,i)+n.posAtStart}domAtPos(t){let{i,off:n}=this.childCursor().findPos(t,-1);for(;i<this.children.length-1;){let s=this.children[i];if(n<s.length||s instanceof Rt)break;i++,n=0}return this.children[i].domAtPos(n)}coordsAt(t,i){let n=null,s=0;for(let h=this.length,u=this.children.length-1;u>=0;u--){let d=this.children[u],p=h-d.breakAfter,v=p-d.length;if(p<t)break;if(v<=t&&(v<t||d.covers(-1))&&(p>t||d.covers(1))&&(!n||d instanceof Rt&&!(n instanceof Rt&&i>=0)))n=d,s=v;else if(n&&v==t&&p==t&&d instanceof pi&&Math.abs(i)<2){if(d.deco.startSide<0)break;u&&(n=null)}h=v}return n?n.coordsAt(t-s,i):null}coordsForChar(t){let{i,off:n}=this.childPos(t,1),s=this.children[i];if(!(s instanceof Rt))return null;for(;s.children.length;){let{i:d,off:p}=s.childPos(n,1);for(;;d++){if(d==s.children.length)return null;if((s=s.children[d]).length)break}n=p}if(!(s instanceof Ke))return null;let h=ii(s.text,n);if(h==n)return null;let u=lr(s.dom,n,h).getClientRects();for(let d=0;d<u.length;d++){let p=u[d];if(d==u.length-1||p.top<p.bottom&&p.left<p.right)return p}return null}measureVisibleLineHeights(t){let i=[],{from:n,to:s}=t,h=this.view.contentDOM.clientWidth,u=h>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==Yt.LTR;for(let v=0,b=0;b<this.children.length;b++){let x=this.children[b],S=v+x.length;if(S>s)break;if(v>=n){let M=x.dom.getBoundingClientRect();if(i.push(M.height),u){let A=x.dom.lastChild,D=A?Gr(A):[];if(D.length){let N=D[D.length-1],P=p?N.right-M.left:M.right-N.left;P>d&&(d=P,this.minWidth=h,this.minWidthFrom=v,this.minWidthTo=S)}}}v=S+x.breakAfter}return i}textDirectionAt(t){let{i}=this.childPos(t,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?Yt.RTL:Yt.LTR}measureTextSize(){for(let h of this.children)if(h instanceof Rt){let u=h.measureTextSize();if(u)return u}let t=document.createElement("div"),i,n,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let h=Gr(t.firstChild)[0];i=t.getBoundingClientRect().height,n=h?h.width/27:7,s=h?h.height:i,t.remove()}),{lineHeight:i,charWidth:n,textHeight:s}}childCursor(t=this.length){let i=this.children.length;return i&&(t-=this.children[--i].length),new Bc(this.children,t,i)}computeBlockGapDeco(){let t=[],i=this.view.viewState;for(let n=0,s=0;;s++){let h=s==i.viewports.length?null:i.viewports[s],u=h?h.from-1:this.length;if(u>n){let d=(i.lineBlockAt(u).bottom-i.lineBlockAt(n).top)/this.view.scaleY;t.push(It.replace({widget:new Su(d),block:!0,inclusive:!0,isBlockGap:!0}).range(n,u))}if(!h)break;n=h.to+1}return It.set(t)}updateDeco(){let t=1,i=this.view.state.facet(Yn).map(h=>(this.dynamicDecorationMap[t++]=typeof h=="function")?h(this.view):h),n=!1,s=this.view.state.facet(nd).map((h,u)=>{let d=typeof h=="function";return d&&(n=!0),d?h(this.view):h});for(s.length&&(this.dynamicDecorationMap[t++]=n,i.push(bt.join(s))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let v=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=v.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let v of this.view.state.facet(ed))try{if(v(this.view,t.range,t))return!0}catch(b){ri(this.view.state,b,"scroll handler")}let{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),s;if(!n)return;!i.empty&&(s=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let h=ld(this.view),u={left:n.left-h.left,top:n.top-h.top,right:n.right+h.right,bottom:n.bottom+h.bottom},{offsetWidth:d,offsetHeight:p}=this.view.scrollDOM;A0(this.view.scrollDOM,u,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,d),-d),Math.max(Math.min(t.yMargin,p),-p),this.view.textDirection==Yt.LTR)}}function X0(f){return f.node.nodeType==1&&f.node.firstChild&&(f.offset==0||f.node.childNodes[f.offset-1].contentEditable=="false")&&(f.offset==f.node.childNodes.length||f.node.childNodes[f.offset].contentEditable=="false")}class Su extends vo{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function ad(f,t){let i=f.observer.selectionRange;if(!i.focusNode)return null;let n=Pc(i.focusNode,i.focusOffset),s=Ec(i.focusNode,i.focusOffset),h=n||s;if(s&&n&&s.node!=n.node){let d=St.get(s.node);if(!d||d instanceof Ke&&d.text!=s.node.nodeValue)h=s;else if(f.docView.lastCompositionAfterCursor){let p=St.get(n.node);!p||p instanceof Ke&&p.text!=n.node.nodeValue||(h=s)}}if(f.docView.lastCompositionAfterCursor=h!=n,!h)return null;let u=t-h.offset;return{from:u,to:u+h.node.nodeValue.length,node:h.node}}function _0(f,t,i){let n=ad(f,i);if(!n)return null;let{node:s,from:h,to:u}=n,d=s.nodeValue;if(/[\n\r]/.test(d)||f.state.doc.sliceString(n.from,n.to)!=d)return null;let p=t.invertedDesc,v=new Be(p.mapPos(h),p.mapPos(u),h,u),b=[];for(let x=s.parentNode;;x=x.parentNode){let S=St.get(x);if(S instanceof mi)b.push({node:x,deco:S.mark});else{if(S instanceof Rt||x.nodeName=="DIV"&&x.parentNode==f.contentDOM)return{range:v,text:s,marks:b,line:x};if(x!=f.contentDOM)b.push({node:x,deco:new jn({inclusive:!0,attributes:B0(x),tagName:x.tagName.toLowerCase()})});else return null}}}function j0(f,t){return f.nodeType!=1?0:(t&&f.childNodes[t-1].contentEditable=="false"?1:0)|(t<f.childNodes.length&&f.childNodes[t].contentEditable=="false"?2:0)}let J0=class{constructor(){this.changes=[]}compareRange(t,i){ga(t,i,this.changes)}comparePoint(t,i){ga(t,i,this.changes)}};function Z0(f,t,i){let n=new J0;return bt.compare(f,t,i,n),n.changes}function Q0(f,t){for(let i=f;i&&i!=t;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function $0(f,t){let i=!1;return t&&f.iterChangedRanges((n,s)=>{n<t.to&&s>t.from&&(i=!0)}),i}function tm(f,t,i=1){let n=f.charCategorizer(t),s=f.doc.lineAt(t),h=t-s.from;if(s.length==0)return j.cursor(t);h==0?i=1:h==s.length&&(i=-1);let u=h,d=h;i<0?u=ii(s.text,h,!1):d=ii(s.text,h);let p=n(s.text.slice(u,d));for(;u>0;){let v=ii(s.text,u,!1);if(n(s.text.slice(v,u))!=p)break;u=v}for(;d<s.length;){let v=ii(s.text,d);if(n(s.text.slice(d,v))!=p)break;d=v}return j.range(u+s.from,d+s.from)}function em(f,t){return t.left>f?t.left-f:Math.max(0,f-t.right)}function im(f,t){return t.top>f?t.top-f:Math.max(0,f-t.bottom)}function Il(f,t){return f.top<t.bottom-1&&f.bottom>t.top+1}function ku(f,t){return t<f.top?{top:t,left:f.left,right:f.right,bottom:f.bottom}:f}function Cu(f,t){return t>f.bottom?{top:f.top,left:f.left,right:f.right,bottom:t}:f}function wa(f,t,i){let n,s,h,u,d=!1,p,v,b,x;for(let A=f.firstChild;A;A=A.nextSibling){let D=Gr(A);for(let N=0;N<D.length;N++){let P=D[N];s&&Il(s,P)&&(P=ku(Cu(P,s.bottom),s.top));let W=em(t,P),_=im(i,P);if(W==0&&_==0)return A.nodeType==3?Mu(A,t,i):wa(A,t,i);if(!n||u>_||u==_&&h>W){n=A,s=P,h=W,u=_;let Y=_?i<P.top?-1:1:W?t<P.left?-1:1:0;d=!Y||(Y>0?N<D.length-1:N>0)}W==0?i>P.bottom&&(!b||b.bottom<P.bottom)?(p=A,b=P):i<P.top&&(!x||x.top>P.top)&&(v=A,x=P):b&&Il(b,P)?b=Cu(b,P.bottom):x&&Il(x,P)&&(x=ku(x,P.top))}}if(b&&b.bottom>=i?(n=p,s=b):x&&x.top<=i&&(n=v,s=x),!n)return{node:f,offset:0};let S=Math.max(s.left,Math.min(s.right,t));if(n.nodeType==3)return Mu(n,S,i);if(d&&n.contentEditable!="false")return wa(n,S,i);let M=Array.prototype.indexOf.call(f.childNodes,n)+(t>=(s.left+s.right)/2?1:0);return{node:f,offset:M}}function Mu(f,t,i){let n=f.nodeValue.length,s=-1,h=1e9,u=0;for(let d=0;d<n;d++){let p=lr(f,d,d+1).getClientRects();for(let v=0;v<p.length;v++){let b=p[v];if(b.top==b.bottom)continue;u||(u=t-b.left);let x=(b.top>i?b.top-i:i-b.bottom)-1;if(b.left-1<=t&&b.right+1>=t&&x<h){let S=t>=(b.left+b.right)/2,M=S;if((G.chrome||G.gecko)&&lr(f,d).getBoundingClientRect().left==b.right&&(M=!S),x<=0)return{node:f,offset:d+(M?1:0)};s=d+(M?1:0),h=x}}}return{node:f,offset:s>-1?s:u>0?f.nodeValue.length:0}}function hd(f,t,i,n=-1){var s,h;let u=f.contentDOM.getBoundingClientRect(),d=u.top+f.viewState.paddingTop,p,{docHeight:v}=f.viewState,{x:b,y:x}=t,S=x-d;if(S<0)return 0;if(S>v)return f.state.doc.length;for(let Y=f.viewState.heightOracle.textHeight/2,V=!1;p=f.elementAtHeight(S),p.type!=Ee.Text;)for(;S=n>0?p.bottom+Y:p.top-Y,!(S>=0&&S<=v);){if(V)return i?null:0;V=!0,n=-n}x=d+S;let M=p.from;if(M<f.viewport.from)return f.viewport.from==0?0:i?null:Au(f,u,p,b,x);if(M>f.viewport.to)return f.viewport.to==f.state.doc.length?f.state.doc.length:i?null:Au(f,u,p,b,x);let A=f.dom.ownerDocument,D=f.root.elementFromPoint?f.root:A,N=D.elementFromPoint(b,x);N&&!f.contentDOM.contains(N)&&(N=null),N||(b=Math.max(u.left+1,Math.min(u.right-1,b)),N=D.elementFromPoint(b,x),N&&!f.contentDOM.contains(N)&&(N=null));let P,W=-1;if(N&&((s=f.docView.nearest(N))===null||s===void 0?void 0:s.isEditable)!=!1){if(A.caretPositionFromPoint){let Y=A.caretPositionFromPoint(b,x);Y&&({offsetNode:P,offset:W}=Y)}else if(A.caretRangeFromPoint){let Y=A.caretRangeFromPoint(b,x);Y&&({startContainer:P,startOffset:W}=Y,(!f.contentDOM.contains(P)||G.safari&&rm(P,W,b)||G.chrome&&nm(P,W,b))&&(P=void 0))}}if(!P||!f.docView.dom.contains(P)){let Y=Rt.find(f.docView,M);if(!Y)return S>p.top+p.height/2?p.to:p.from;({node:P,offset:W}=wa(Y.dom,b,x))}let _=f.docView.nearest(P);if(!_)return null;if(_.isWidget&&((h=_.dom)===null||h===void 0?void 0:h.nodeType)==1){let Y=_.dom.getBoundingClientRect();return t.y<Y.top||t.y<=Y.bottom&&t.x<=(Y.left+Y.right)/2?_.posAtStart:_.posAtEnd}else return _.localPosFromDOM(P,W)+_.posAtStart}function Au(f,t,i,n,s){let h=Math.round((n-t.left)*f.defaultCharacterWidth);if(f.lineWrapping&&i.height>f.defaultLineHeight*1.5){let d=f.viewState.heightOracle.textHeight,p=Math.floor((s-i.top-(f.defaultLineHeight-d)*.5)/d);h+=p*f.viewState.heightOracle.lineLength}let u=f.state.sliceDoc(i.from,i.to);return i.from+b0(u,h,f.state.tabSize)}function rm(f,t,i){let n;if(f.nodeType!=3||t!=(n=f.nodeValue.length))return!1;for(let s=f.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return lr(f,n-1,n).getBoundingClientRect().left>i}function nm(f,t,i){if(t!=0)return!1;for(let s=f;;){let h=s.parentNode;if(!h||h.nodeType!=1||h.firstChild!=s)return!1;if(h.classList.contains("cm-line"))break;s=h}let n=f.nodeType==1?f.getBoundingClientRect():lr(f,0,Math.max(f.nodeValue.length,1)).getBoundingClientRect();return i-n.left>5}function sm(f,t){let i=f.lineBlockAt(t);if(Array.isArray(i.type)){for(let n of i.type)if(n.to>t||n.to==t&&(n.to==i.to||n.type==Ee.Text))return n}return i}function om(f,t,i,n){let s=sm(f,t.head),h=!n||s.type!=Ee.Text||!(f.lineWrapping||s.widgetLineBreaks)?null:f.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(h){let u=f.dom.getBoundingClientRect(),d=f.textDirectionAt(s.from),p=f.posAtCoords({x:i==(d==Yt.LTR)?u.right-1:u.left+1,y:(h.top+h.bottom)/2});if(p!=null)return j.cursor(p,i?-1:1)}return j.cursor(i?s.to:s.from,i?-1:1)}function Tu(f,t,i,n){let s=f.state.doc.lineAt(t.head),h=f.bidiSpans(s),u=f.textDirectionAt(s.from);for(let d=t,p=null;;){let v=G0(s,h,u,d,i),b=Xc;if(!v){if(s.number==(i?f.state.doc.lines:1))return d;b=`
`,s=f.state.doc.line(s.number+(i?1:-1)),h=f.bidiSpans(s),v=f.visualLineSide(s,!i)}if(p){if(!p(b))return d}else{if(!n)return v;p=n(b)}d=v}}function lm(f,t,i){let n=f.state.charCategorizer(t),s=n(i);return h=>{let u=n(h);return s==ci.Space&&(s=u),s==u}}function am(f,t,i,n){let s=t.head,h=i?1:-1;if(s==(i?f.state.doc.length:0))return j.cursor(s,t.assoc);let u=t.goalColumn,d,p=f.contentDOM.getBoundingClientRect(),v=f.coordsAtPos(s,t.assoc||-1),b=f.documentTop;if(v)u==null&&(u=v.left-p.left),d=h<0?v.top:v.bottom;else{let M=f.viewState.lineBlockAt(s);u==null&&(u=Math.min(p.right-p.left,f.defaultCharacterWidth*(s-M.from))),d=(h<0?M.top:M.bottom)+b}let x=p.left+u,S=n??f.viewState.heightOracle.textHeight>>1;for(let M=0;;M+=10){let A=d+(S+M)*h,D=hd(f,{x,y:A},!1,h);if(A<p.top||A>p.bottom||(h<0?D<s:D>s)){let N=f.docView.coordsForChar(D),P=!N||A<N.top?-1:1;return j.cursor(D,P,void 0,u)}}}function to(f,t,i){for(;;){let n=0;for(let s of f)s.between(t-1,t+1,(h,u,d)=>{if(t>h&&t<u){let p=n||i||(t-h<u-t?-1:1);t=p<0?h:u,n=p}});if(!n)return t}}function Wl(f,t,i){let n=to(f.state.facet(za).map(s=>s(f)),i.from,t.head>i.from?-1:1);return n==i.from?i:j.cursor(n,n<i.from?1:-1)}class hm{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,G.safari&&t.contentDOM.addEventListener("input",()=>null),G.gecko&&Mm(t.contentDOM.ownerDocument)}handleEvent(t){!vm(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||this.runHandlers(t.type,t)}runHandlers(t,i){let n=this.handlers[t];if(n){for(let s of n.observers)s(this.view,i);for(let s of n.handlers){if(i.defaultPrevented)break;if(s(this.view,i)){i.preventDefault();break}}}}ensureHandlers(t){let i=fm(t),n=this.handlers,s=this.view.contentDOM;for(let h in i)if(h!="scroll"){let u=!i[h].handlers.length,d=n[h];d&&u!=!d.handlers.length&&(s.removeEventListener(h,this.handleEvent),d=null),d||s.addEventListener(h,this.handleEvent,{passive:u})}for(let h in n)h!="scroll"&&!i[h]&&s.removeEventListener(h,this.handleEvent);this.handlers=i}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&ud.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),G.android&&G.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return G.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=fd.find(n=>n.keyCode==t.keyCode))&&!t.ctrlKey||um.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Wr(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:G.safari&&!G.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Lu(f,t){return(i,n)=>{try{return t.call(f,n,i)}catch(s){ri(i.state,s)}}}function fm(f){let t=Object.create(null);function i(n){return t[n]||(t[n]={observers:[],handlers:[]})}for(let n of f){let s=n.spec;if(s&&s.domEventHandlers)for(let h in s.domEventHandlers){let u=s.domEventHandlers[h];u&&i(h).handlers.push(Lu(n.value,u))}if(s&&s.domEventObservers)for(let h in s.domEventObservers){let u=s.domEventObservers[h];u&&i(h).observers.push(Lu(n.value,u))}}for(let n in Ue)i(n).handlers.push(Ue[n]);for(let n in He)i(n).observers.push(He[n]);return t}const fd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],um="dthko",ud=[16,17,18,20,91,92,224,225],Ws=6;function Fs(f){return Math.max(0,f)*.7+8}function cm(f,t){return Math.max(Math.abs(f.clientX-t.clientX),Math.abs(f.clientY-t.clientY))}class dm{constructor(t,i,n,s){this.view=t,this.startEvent=i,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=T0(t.contentDOM),this.atoms=t.state.facet(za).map(u=>u(t));let h=t.contentDOM.ownerDocument;h.addEventListener("mousemove",this.move=this.move.bind(this)),h.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=t.state.facet(ut.allowMultipleSelections)&&pm(t,i),this.dragging=mm(t,i)&&pd(i)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&cm(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let i=0,n=0,s=0,h=0,u=this.view.win.innerWidth,d=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:u}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:h,bottom:d}=this.scrollParents.y.getBoundingClientRect());let p=ld(this.view);t.clientX-p.left<=s+Ws?i=-Fs(s-t.clientX):t.clientX+p.right>=u-Ws&&(i=Fs(t.clientX-u)),t.clientY-p.top<=h+Ws?n=-Fs(h-t.clientY):t.clientY+p.bottom>=d-Ws&&(n=Fs(t.clientY-d)),this.setScrollSpeed(i,n)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,i){this.scrollSpeed={x:t,y:i},t||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:i}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(t||i)&&this.view.win.scrollBy(t,i),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let i=null;for(let n=0;n<t.ranges.length;n++){let s=t.ranges[n],h=null;if(s.empty){let u=to(this.atoms,s.from,0);u!=s.from&&(h=j.cursor(u,-1))}else{let u=to(this.atoms,s.from,-1),d=to(this.atoms,s.to,1);(u!=s.from||d!=s.to)&&(h=j.range(s.from==s.anchor?u:d,s.from==s.head?u:d))}h&&(i||(i=t.ranges.slice()),i[n]=h)}return i?j.create(i,t.mainIndex):t}select(t){let{view:i}=this,n=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!n.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function pm(f,t){let i=f.state.facet(_c);return i.length?i[0](t):G.mac?t.metaKey:t.ctrlKey}function gm(f,t){let i=f.state.facet(jc);return i.length?i[0](t):G.mac?!t.altKey:!t.ctrlKey}function mm(f,t){let{main:i}=f.state.selection;if(i.empty)return!1;let n=qn(f.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let h=0;h<s.length;h++){let u=s[h];if(u.left<=t.clientX&&u.right>=t.clientX&&u.top<=t.clientY&&u.bottom>=t.clientY)return!0}return!1}function vm(f,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target,n;i!=f.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(n=St.get(i))&&n.ignoreEvent(t))return!1;return!0}const Ue=Object.create(null),He=Object.create(null),cd=G.ie&&G.ie_version<15||G.ios&&G.webkit_version<604;function ym(f){let t=f.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{f.focus(),i.remove(),dd(f,i.value)},50)}function dd(f,t){let{state:i}=f,n,s=1,h=i.toText(t),u=h.lines==i.selection.ranges.length;if(xa!=null&&i.selection.ranges.every(p=>p.empty)&&xa==h.toString()){let p=-1;n=i.changeByRange(v=>{let b=i.doc.lineAt(v.from);if(b.from==p)return{range:v};p=b.from;let x=i.toText((u?h.line(s++).text:t)+i.lineBreak);return{changes:{from:b.from,insert:x},range:j.cursor(v.from+x.length)}})}else u?n=i.changeByRange(p=>{let v=h.line(s++);return{changes:{from:p.from,to:p.to,insert:v.text},range:j.cursor(p.from+v.length)}}):n=i.replaceSelection(h);f.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}He.scroll=f=>{f.inputState.lastScrollTop=f.scrollDOM.scrollTop,f.inputState.lastScrollLeft=f.scrollDOM.scrollLeft};Ue.keydown=(f,t)=>(f.inputState.setSelectionOrigin("select"),t.keyCode==27&&f.inputState.tabFocusMode!=0&&(f.inputState.tabFocusMode=Date.now()+2e3),!1);He.touchstart=(f,t)=>{f.inputState.lastTouchTime=Date.now(),f.inputState.setSelectionOrigin("select.pointer")};He.touchmove=f=>{f.inputState.setSelectionOrigin("select.pointer")};Ue.mousedown=(f,t)=>{if(f.observer.flush(),f.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of f.state.facet(Jc))if(i=n(f,t),i)break;if(!i&&t.button==0&&(i=xm(f,t)),i){let n=!f.hasFocus;f.inputState.startMouseSelection(new dm(f,t,i,n)),n&&f.observer.ignore(()=>{Oc(f.contentDOM);let h=f.root.activeElement;h&&!h.contains(f.contentDOM)&&h.blur()});let s=f.inputState.mouseSelection;if(s)return s.start(t),s.dragging===!1}return!1};function Ou(f,t,i,n){if(n==1)return j.cursor(t,i);if(n==2)return tm(f.state,t,i);{let s=Rt.find(f.docView,t),h=f.state.doc.lineAt(s?s.posAtEnd:t),u=s?s.posAtStart:h.from,d=s?s.posAtEnd:h.to;return d<f.state.doc.length&&d==h.to&&d++,j.range(u,d)}}let Du=(f,t,i)=>t>=i.top&&t<=i.bottom&&f>=i.left&&f<=i.right;function bm(f,t,i,n){let s=Rt.find(f.docView,t);if(!s)return 1;let h=t-s.posAtStart;if(h==0)return 1;if(h==s.length)return-1;let u=s.coordsAt(h,-1);if(u&&Du(i,n,u))return-1;let d=s.coordsAt(h,1);return d&&Du(i,n,d)?1:u&&u.bottom>=n?-1:1}function Nu(f,t){let i=f.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:bm(f,i,t.clientX,t.clientY)}}const wm=G.ie&&G.ie_version<=11;let Pu=null,Eu=0,Bu=0;function pd(f){if(!wm)return f.detail;let t=Pu,i=Bu;return Pu=f,Bu=Date.now(),Eu=!t||i>Date.now()-400&&Math.abs(t.clientX-f.clientX)<2&&Math.abs(t.clientY-f.clientY)<2?(Eu+1)%3:1}function xm(f,t){let i=Nu(f,t),n=pd(t),s=f.state.selection;return{update(h){h.docChanged&&(i.pos=h.changes.mapPos(i.pos),s=s.map(h.changes))},get(h,u,d){let p=Nu(f,h),v,b=Ou(f,p.pos,p.bias,n);if(i.pos!=p.pos&&!u){let x=Ou(f,i.pos,i.bias,n),S=Math.min(x.from,b.from),M=Math.max(x.to,b.to);b=S<b.from?j.range(S,M):j.range(M,S)}return u?s.replaceRange(s.main.extend(b.from,b.to)):d&&n==1&&s.ranges.length>1&&(v=Sm(s,p.pos))?v:d?s.addRange(b):j.create([b])}}}function Sm(f,t){for(let i=0;i<f.ranges.length;i++){let{from:n,to:s}=f.ranges[i];if(n<=t&&s>=t)return j.create(f.ranges.slice(0,i).concat(f.ranges.slice(i+1)),f.mainIndex==i?0:f.mainIndex-(f.mainIndex>i?1:0))}return null}Ue.dragstart=(f,t)=>{let{selection:{main:i}}=f.state;if(t.target.draggable){let s=f.docView.nearest(t.target);if(s&&s.isWidget){let h=s.posAtStart,u=h+s.length;(h>=i.to||u<=i.from)&&(i=j.range(h,u))}}let{inputState:n}=f;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,t.dataTransfer&&(t.dataTransfer.setData("Text",f.state.sliceDoc(i.from,i.to)),t.dataTransfer.effectAllowed="copyMove"),!1};Ue.dragend=f=>(f.inputState.draggedContent=null,!1);function Ru(f,t,i,n){if(!i)return;let s=f.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:h}=f.inputState,u=n&&h&&gm(f,t)?{from:h.from,to:h.to}:null,d={from:s,insert:i},p=f.state.changes(u?[u,d]:d);f.focus(),f.dispatch({changes:p,selection:{anchor:p.mapPos(s,-1),head:p.mapPos(s,1)},userEvent:u?"move.drop":"input.drop"}),f.inputState.draggedContent=null}Ue.drop=(f,t)=>{if(!t.dataTransfer)return!1;if(f.state.readOnly)return!0;let i=t.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,h=()=>{++s==i.length&&Ru(f,t,n.filter(u=>u!=null).join(f.state.lineBreak),!1)};for(let u=0;u<i.length;u++){let d=new FileReader;d.onerror=h,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(n[u]=d.result),h()},d.readAsText(i[u])}return!0}else{let n=t.dataTransfer.getData("Text");if(n)return Ru(f,t,n,!0),!0}return!1};Ue.paste=(f,t)=>{if(f.state.readOnly)return!0;f.observer.flush();let i=cd?null:t.clipboardData;return i?(dd(f,i.getData("text/plain")||i.getData("text/uri-list")),!0):(ym(f),!1)};function km(f,t){let i=f.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),f.focus()},50)}function Cm(f){let t=[],i=[],n=!1;for(let s of f.selection.ranges)s.empty||(t.push(f.sliceDoc(s.from,s.to)),i.push(s));if(!t.length){let s=-1;for(let{from:h}of f.selection.ranges){let u=f.doc.lineAt(h);u.number>s&&(t.push(u.text),i.push({from:u.from,to:Math.min(f.doc.length,u.to+1)})),s=u.number}n=!0}return{text:t.join(f.lineBreak),ranges:i,linewise:n}}let xa=null;Ue.copy=Ue.cut=(f,t)=>{let{text:i,ranges:n,linewise:s}=Cm(f.state);if(!i&&!s)return!1;xa=s?i:null,t.type=="cut"&&!f.state.readOnly&&f.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let h=cd?null:t.clipboardData;return h?(h.clearData(),h.setData("text/plain",i),!0):(km(f,i),!1)};const gd=_r.define();function md(f,t){let i=[];for(let n of f.facet($c)){let s=n(f,t);s&&i.push(s)}return i?f.update({effects:i,annotations:gd.of(!0)}):null}function vd(f){setTimeout(()=>{let t=f.hasFocus;if(t!=f.inputState.notifiedFocused){let i=md(f.state,t);i?f.dispatch(i):f.update([])}},10)}He.focus=f=>{f.inputState.lastFocusTime=Date.now(),!f.scrollDOM.scrollTop&&(f.inputState.lastScrollTop||f.inputState.lastScrollLeft)&&(f.scrollDOM.scrollTop=f.inputState.lastScrollTop,f.scrollDOM.scrollLeft=f.inputState.lastScrollLeft),vd(f)};He.blur=f=>{f.observer.clearSelectionRange(),vd(f)};He.compositionstart=He.compositionupdate=f=>{f.observer.editContext||(f.inputState.compositionFirstChange==null&&(f.inputState.compositionFirstChange=!0),f.inputState.composing<0&&(f.inputState.composing=0))};He.compositionend=f=>{f.observer.editContext||(f.inputState.composing=-1,f.inputState.compositionEndedAt=Date.now(),f.inputState.compositionPendingKey=!0,f.inputState.compositionPendingChange=f.observer.pendingRecords().length>0,f.inputState.compositionFirstChange=null,G.chrome&&G.android?f.observer.flushSoon():f.inputState.compositionPendingChange?Promise.resolve().then(()=>f.observer.flush()):setTimeout(()=>{f.inputState.composing<0&&f.docView.hasComposition&&f.update([])},50))};He.contextmenu=f=>{f.inputState.lastContextMenu=Date.now()};Ue.beforeinput=(f,t)=>{var i;let n;if(G.chrome&&G.android&&(n=fd.find(s=>s.inputType==t.inputType))&&(f.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let s=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var h;(((h=window.visualViewport)===null||h===void 0?void 0:h.height)||0)>s+10&&f.hasFocus&&(f.contentDOM.blur(),f.focus())},100)}return G.ios&&t.inputType=="deleteContentForward"&&f.observer.flushSoon(),G.safari&&t.inputType=="insertText"&&f.inputState.composing>=0&&setTimeout(()=>He.compositionend(f,t),20),!1};const Hu=new Set;function Mm(f){Hu.has(f)||(Hu.add(f),f.addEventListener("copy",()=>{}),f.addEventListener("cut",()=>{}))}const Iu=["pre-wrap","normal","pre-line","break-spaces"];class Am{constructor(t){this.lineWrapping=t,this.doc=vt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,i){let n=this.doc.lineAt(i).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((i-t-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Iu.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let i=!1;for(let n=0;n<t.length;n++){let s=t[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(i=!0,this.heightSamples[Math.floor(s*10)]=!0)}return i}refresh(t,i,n,s,h,u){let d=Iu.indexOf(t)>-1,p=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=i,this.charWidth=n,this.textHeight=s,this.lineLength=h,p){this.heightSamples={};for(let v=0;v<u.length;v++){let b=u[v];b<0?v++:this.heightSamples[Math.floor(b*10)]=!0}}return p}}class Tm{constructor(t,i){this.from=t,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class ei{constructor(t,i,n,s,h){this.from=t,this.length=i,this.top=n,this.height=s,this._content=h}get type(){return typeof this._content=="number"?Ee.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Hi?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new ei(this.from,this.length+t.length,this.top,this.height+t.height,i)}}var Mt=function(f){return f[f.ByPos=0]="ByPos",f[f.ByHeight=1]="ByHeight",f[f.ByPosNoHeight=2]="ByPosNoHeight",f}(Mt||(Mt={}));const eo=.001;class ve{constructor(t,i,n=2){this.length=t,this.height=i,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,i){this.height!=i&&(Math.abs(this.height-i)>eo&&(t.heightChanged=!0),this.height=i)}replace(t,i,n){return ve.of(n)}decomposeLeft(t,i){i.push(this)}decomposeRight(t,i){i.push(this)}applyChanges(t,i,n,s){let h=this,u=n.doc;for(let d=s.length-1;d>=0;d--){let{fromA:p,toA:v,fromB:b,toB:x}=s[d],S=h.lineAt(p,Mt.ByPosNoHeight,n.setDoc(i),0,0),M=S.to>=v?S:h.lineAt(v,Mt.ByPosNoHeight,n,0,0);for(x+=M.to-v,v=M.to;d>0&&S.from<=s[d-1].toA;)p=s[d-1].fromA,b=s[d-1].fromB,d--,p<S.from&&(S=h.lineAt(p,Mt.ByPosNoHeight,n,0,0));b+=S.from-p,p=S.from;let A=Ka.build(n.setDoc(u),t,b,x);h=h.replace(p,v,A)}return h.updateHeight(n,0)}static empty(){return new Te(0,0)}static of(t){if(t.length==1)return t[0];let i=0,n=t.length,s=0,h=0;for(;;)if(i==n)if(s>h*2){let d=t[i-1];d.break?t.splice(--i,1,d.left,null,d.right):t.splice(--i,1,d.left,d.right),n+=1+d.break,s-=d.size}else if(h>s*2){let d=t[n];d.break?t.splice(n,1,d.left,null,d.right):t.splice(n,1,d.left,d.right),n+=2+d.break,h-=d.size}else break;else if(s<h){let d=t[i++];d&&(s+=d.size)}else{let d=t[--n];d&&(h+=d.size)}let u=0;return t[i-1]==null?(u=1,i--):t[i]==null&&(u=1,n++),new Lm(ve.of(t.slice(0,i)),u,ve.of(t.slice(n)))}}ve.prototype.size=1;class yd extends ve{constructor(t,i,n){super(t,i),this.deco=n}blockAt(t,i,n,s){return new ei(s,this.length,n,this.height,this.deco||0)}lineAt(t,i,n,s,h){return this.blockAt(0,n,s,h)}forEachLine(t,i,n,s,h,u){t<=h+this.length&&i>=h&&u(this.blockAt(0,n,s,h))}updateHeight(t,i=0,n=!1,s){return s&&s.from<=i&&s.more&&this.setHeight(t,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Te extends yd{constructor(t,i){super(t,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,i,n,s){return new ei(s,this.length,n,this.height,this.breaks)}replace(t,i,n){let s=n[0];return n.length==1&&(s instanceof Te||s instanceof Zt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Zt?s=new Te(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):ve.of(n)}updateHeight(t,i=0,n=!1,s){return s&&s.from<=i&&s.more?this.setHeight(t,s.heights[s.index++]):(n||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends ve{constructor(t){super(t,0)}heightMetrics(t,i){let n=t.doc.lineAt(i).number,s=t.doc.lineAt(i+this.length).number,h=s-n+1,u,d=0;if(t.lineWrapping){let p=Math.min(this.height,t.lineHeight*h);u=p/h,this.length>h+1&&(d=(this.height-p)/(this.length-h-1))}else u=this.height/h;return{firstLine:n,lastLine:s,perLine:u,perChar:d}}blockAt(t,i,n,s){let{firstLine:h,lastLine:u,perLine:d,perChar:p}=this.heightMetrics(i,s);if(i.lineWrapping){let v=s+(t<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-n)/this.height))*this.length)),b=i.doc.lineAt(v),x=d+b.length*p,S=Math.max(n,t-x/2);return new ei(b.from,b.length,S,x,0)}else{let v=Math.max(0,Math.min(u-h,Math.floor((t-n)/d))),{from:b,length:x}=i.doc.line(h+v);return new ei(b,x,n+d*v,d,0)}}lineAt(t,i,n,s,h){if(i==Mt.ByHeight)return this.blockAt(t,n,s,h);if(i==Mt.ByPosNoHeight){let{from:M,to:A}=n.doc.lineAt(t);return new ei(M,A-M,0,0,0)}let{firstLine:u,perLine:d,perChar:p}=this.heightMetrics(n,h),v=n.doc.lineAt(t),b=d+v.length*p,x=v.number-u,S=s+d*x+p*(v.from-h-x);return new ei(v.from,v.length,Math.max(s,Math.min(S,s+this.height-b)),b,0)}forEachLine(t,i,n,s,h,u){t=Math.max(t,h),i=Math.min(i,h+this.length);let{firstLine:d,perLine:p,perChar:v}=this.heightMetrics(n,h);for(let b=t,x=s;b<=i;){let S=n.doc.lineAt(b);if(b==t){let A=S.number-d;x+=p*A+v*(t-h-A)}let M=p+v*S.length;u(new ei(S.from,S.length,x,M,0)),x+=M,b=S.to+1}}replace(t,i,n){let s=this.length-i;if(s>0){let h=n[n.length-1];h instanceof Zt?n[n.length-1]=new Zt(h.length+s):n.push(null,new Zt(s-1))}if(t>0){let h=n[0];h instanceof Zt?n[0]=new Zt(t+h.length):n.unshift(new Zt(t-1),null)}return ve.of(n)}decomposeLeft(t,i){i.push(new Zt(t-1),null)}decomposeRight(t,i){i.push(null,new Zt(this.length-t-1))}updateHeight(t,i=0,n=!1,s){let h=i+this.length;if(s&&s.from<=i+this.length&&s.more){let u=[],d=Math.max(i,s.from),p=-1;for(s.from>i&&u.push(new Zt(s.from-i-1).updateHeight(t,i));d<=h&&s.more;){let b=t.doc.lineAt(d).length;u.length&&u.push(null);let x=s.heights[s.index++];p==-1?p=x:Math.abs(x-p)>=eo&&(p=-2);let S=new Te(b,x);S.outdated=!1,u.push(S),d+=b+1}d<=h&&u.push(null,new Zt(h-d).updateHeight(t,d));let v=ve.of(u);return(p<0||Math.abs(v.height-this.height)>=eo||Math.abs(p-this.heightMetrics(t,i).perLine)>=eo)&&(t.heightChanged=!0),v}else(n||this.outdated)&&(this.setHeight(t,t.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Lm extends ve{constructor(t,i,n){super(t.length+i+n.length,t.height+n.height,i|(t.outdated||n.outdated?2:0)),this.left=t,this.right=n,this.size=t.size+n.size}get break(){return this.flags&1}blockAt(t,i,n,s){let h=n+this.left.height;return t<h?this.left.blockAt(t,i,n,s):this.right.blockAt(t,i,h,s+this.left.length+this.break)}lineAt(t,i,n,s,h){let u=s+this.left.height,d=h+this.left.length+this.break,p=i==Mt.ByHeight?t<u:t<d,v=p?this.left.lineAt(t,i,n,s,h):this.right.lineAt(t,i,n,u,d);if(this.break||(p?v.to<d:v.from>d))return v;let b=i==Mt.ByPosNoHeight?Mt.ByPosNoHeight:Mt.ByPos;return p?v.join(this.right.lineAt(d,b,n,u,d)):this.left.lineAt(d,b,n,s,h).join(v)}forEachLine(t,i,n,s,h,u){let d=s+this.left.height,p=h+this.left.length+this.break;if(this.break)t<p&&this.left.forEachLine(t,i,n,s,h,u),i>=p&&this.right.forEachLine(t,i,n,d,p,u);else{let v=this.lineAt(p,Mt.ByPos,n,s,h);t<v.from&&this.left.forEachLine(t,v.from-1,n,s,h,u),v.to>=t&&v.from<=i&&u(v),i>v.to&&this.right.forEachLine(v.to+1,i,n,d,p,u)}}replace(t,i,n){let s=this.left.length+this.break;if(i<s)return this.balanced(this.left.replace(t,i,n),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-s,i-s,n));let h=[];t>0&&this.decomposeLeft(t,h);let u=h.length;for(let d of n)h.push(d);if(t>0&&Wu(h,u-1),i<this.length){let d=h.length;this.decomposeRight(i,h),Wu(h,d)}return ve.of(h)}decomposeLeft(t,i){let n=this.left.length;if(t<=n)return this.left.decomposeLeft(t,i);i.push(this.left),this.break&&(n++,t>=n&&i.push(null)),t>n&&this.right.decomposeLeft(t-n,i)}decomposeRight(t,i){let n=this.left.length,s=n+this.break;if(t>=s)return this.right.decomposeRight(t-s,i);t<n&&this.left.decomposeRight(t,i),this.break&&t<s&&i.push(null),i.push(this.right)}balanced(t,i){return t.size>2*i.size||i.size>2*t.size?ve.of(this.break?[t,null,i]:[t,i]):(this.left=t,this.right=i,this.height=t.height+i.height,this.outdated=t.outdated||i.outdated,this.size=t.size+i.size,this.length=t.length+this.break+i.length,this)}updateHeight(t,i=0,n=!1,s){let{left:h,right:u}=this,d=i+h.length+this.break,p=null;return s&&s.from<=i+h.length&&s.more?p=h=h.updateHeight(t,i,n,s):h.updateHeight(t,i,n),s&&s.from<=d+u.length&&s.more?p=u=u.updateHeight(t,d,n,s):u.updateHeight(t,d,n),p?this.balanced(h,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Wu(f,t){let i,n;f[t]==null&&(i=f[t-1])instanceof Zt&&(n=f[t+1])instanceof Zt&&f.splice(t-1,3,new Zt(i.length+1+n.length))}const Om=5;class Ka{constructor(t,i){this.pos=t,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,i){if(this.lineStart>-1){let n=Math.min(i,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Te?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Te(n-this.pos,-1)),this.writtenTo=n,i>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(t,i,n){if(t<i||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,h=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let u=i-t;n.block?this.addBlock(new yd(u,s,n)):(u||h||s>=Om)&&this.addLineDeco(s,h,u)}else i>t&&this.span(t,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=i,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Te(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,i){let n=new Zt(i-t);return this.oracle.doc.lineAt(t).to==i&&(n.flags|=4),n}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Te)return t;let i=new Te(0,-1);return this.nodes.push(i),i}addBlock(t){this.enterLine();let i=t.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i&&i.endSide>0&&(this.covering=t)}addLineDeco(t,i,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,t),s.breaks+=i,this.writtenTo=this.pos=this.pos+n}finish(t){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof Te)&&!this.isCovered?this.nodes.push(new Te(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=t;for(let s of this.nodes)s instanceof Te&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(t,i,n,s){let h=new Ka(n,t);return bt.spans(i,n,s,h,0),h.finish(n)}}function Dm(f,t,i){let n=new Nm;return bt.compare(f,t,i,n,0),n.changes}class Nm{constructor(){this.changes=[]}compareRange(){}comparePoint(t,i,n,s){(t<i||n&&n.heightRelevant||s&&s.heightRelevant)&&ga(t,i,this.changes,5)}}function Pm(f,t){let i=f.getBoundingClientRect(),n=f.ownerDocument,s=n.defaultView||window,h=Math.max(0,i.left),u=Math.min(s.innerWidth,i.right),d=Math.max(0,i.top),p=Math.min(s.innerHeight,i.bottom);for(let v=f.parentNode;v&&v!=n.body;)if(v.nodeType==1){let b=v,x=window.getComputedStyle(b);if((b.scrollHeight>b.clientHeight||b.scrollWidth>b.clientWidth)&&x.overflow!="visible"){let S=b.getBoundingClientRect();h=Math.max(h,S.left),u=Math.min(u,S.right),d=Math.max(d,S.top),p=v==f.parentNode?S.bottom:Math.min(p,S.bottom)}v=x.position=="absolute"||x.position=="fixed"?b.offsetParent:b.parentNode}else if(v.nodeType==11)v=v.host;else break;return{left:h-i.left,right:Math.max(h,u)-i.left,top:d-(i.top+t),bottom:Math.max(d,p)-(i.top+t)}}function Em(f,t){let i=f.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class Fl{constructor(t,i,n){this.from=t,this.to=i,this.size=n}static same(t,i){if(t.length!=i.length)return!1;for(let n=0;n<t.length;n++){let s=t[n],h=i[n];if(s.from!=h.from||s.to!=h.to||s.size!=h.size)return!1}return!0}draw(t,i){return It.replace({widget:new Bm(this.size*(i?t.scaleY:t.scaleX),i)}).range(this.from,this.to)}}class Bm extends vo{constructor(t,i){super(),this.size=t,this.vertical=i}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Fu{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=zu,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Yt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=t.facet(Fa).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Am(i),this.stateDeco=t.facet(Yn).filter(n=>typeof n!="function"),this.heightMap=ve.empty().applyChanges(this.stateDeco,vt.empty,this.heightOracle.setDoc(t.doc),[new Be(0,0,0,t.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=It.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:i}=this.state.selection;for(let n=0;n<=1;n++){let s=n?i.head:i.anchor;if(!t.some(({from:h,to:u})=>s>=h&&s<=u)){let{from:h,to:u}=this.lineBlockAt(s);t.push(new zs(h,u))}}return this.viewports=t.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?zu:new Ua(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Rn(t,this.scaler))})}update(t,i=null){this.state=t.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Yn).filter(b=>typeof b!="function");let s=t.changedRanges,h=Be.extendWithRanges(s,Dm(n,this.stateDeco,t?t.changes:qt.empty(this.state.doc.length))),u=this.heightMap.height,d=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),h),this.heightMap.height!=u&&(t.flags|=2),d?(this.scrollAnchorPos=t.changes.mapPos(d.from,-1),this.scrollAnchorHeight=d.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let p=h.length?this.mapViewport(this.viewport,t.changes):this.viewport;(i&&(i.range.head<p.from||i.range.head>p.to)||!this.viewportIsAppropriate(p))&&(p=this.getViewport(0,i));let v=p.from!=this.viewport.from||p.to!=this.viewport.to;this.viewport=p,t.flags|=this.updateForViewport(),(v||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(q0)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let i=t.contentDOM,n=window.getComputedStyle(i),s=this.heightOracle,h=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Yt.RTL:Yt.LTR;let u=this.heightOracle.mustRefreshForWrapping(h),d=i.getBoundingClientRect(),p=u||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let v=0,b=0;if(d.width&&d.height){let{scaleX:Y,scaleY:V}=Lc(i,d);(Y>.005&&Math.abs(this.scaleX-Y)>.005||V>.005&&Math.abs(this.scaleY-V)>.005)&&(this.scaleX=Y,this.scaleY=V,v|=8,u=p=!0)}let x=(parseInt(n.paddingTop)||0)*this.scaleY,S=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=x||this.paddingBottom!=S)&&(this.paddingTop=x,this.paddingBottom=S,v|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(s.lineWrapping&&(p=!0),this.editorWidth=t.scrollDOM.clientWidth,v|=8);let M=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=M&&(this.scrollAnchorHeight=-1,this.scrollTop=M),this.scrolledToBottom=Nc(t.scrollDOM);let A=(this.printing?Em:Pm)(i,this.paddingTop),D=A.top-this.pixelViewport.top,N=A.bottom-this.pixelViewport.bottom;this.pixelViewport=A;let P=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(P!=this.inView&&(this.inView=P,P&&(p=!0)),!this.inView&&!this.scrollTarget)return 0;let W=d.width;if((this.contentDOMWidth!=W||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=t.scrollDOM.clientHeight,v|=8),p){let Y=t.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(Y)&&(u=!0),u||s.lineWrapping&&Math.abs(W-this.contentDOMWidth)>s.charWidth){let{lineHeight:V,charWidth:st,textHeight:Q}=t.docView.measureTextSize();u=V>0&&s.refresh(h,V,st,Q,W/st,Y),u&&(t.docView.minWidth=0,v|=8)}D>0&&N>0?b=Math.max(D,N):D<0&&N<0&&(b=Math.min(D,N)),s.heightChanged=!1;for(let V of this.viewports){let st=V.from==this.viewport.from?Y:t.docView.measureVisibleLineHeights(V);this.heightMap=(u?ve.empty().applyChanges(this.stateDeco,vt.empty,this.heightOracle,[new Be(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(s,0,u,new Tm(V.from,st))}s.heightChanged&&(v|=2)}let _=!this.viewportIsAppropriate(this.viewport,b)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return _&&(v&2&&(v|=this.updateScaler()),this.viewport=this.getViewport(b,this.scrollTarget),v|=this.updateForViewport()),(v&2||_)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,t)),v|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),v}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,i){let n=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),s=this.heightMap,h=this.heightOracle,{visibleTop:u,visibleBottom:d}=this,p=new zs(s.lineAt(u-n*1e3,Mt.ByHeight,h,0,0).from,s.lineAt(d+(1-n)*1e3,Mt.ByHeight,h,0,0).to);if(i){let{head:v}=i.range;if(v<p.from||v>p.to){let b=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),x=s.lineAt(v,Mt.ByPos,h,0,0),S;i.y=="center"?S=(x.top+x.bottom)/2-b/2:i.y=="start"||i.y=="nearest"&&v<p.from?S=x.top:S=x.bottom-b,p=new zs(s.lineAt(S-1e3/2,Mt.ByHeight,h,0,0).from,s.lineAt(S+b+1e3/2,Mt.ByHeight,h,0,0).to)}}return p}mapViewport(t,i){let n=i.mapPos(t.from,-1),s=i.mapPos(t.to,1);return new zs(this.heightMap.lineAt(n,Mt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Mt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:i},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(t,Mt.ByPos,this.heightOracle,0,0),{bottom:h}=this.heightMap.lineAt(i,Mt.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:d}=this;return(t==0||s<=u-Math.max(10,Math.min(-n,250)))&&(i==this.state.doc.length||h>=d+Math.max(10,Math.min(n,250)))&&s>u-2*1e3&&h<d+2*1e3}mapLineGaps(t,i){if(!t.length||i.empty)return t;let n=[];for(let s of t)i.touchesRange(s.from,s.to)||n.push(new Fl(i.mapPos(s.from),i.mapPos(s.to),s.size));return n}ensureLineGaps(t,i){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,h=s>>1,u=s<<1;if(this.defaultTextDirection!=Yt.LTR&&!n)return[];let d=[],p=(b,x,S,M)=>{if(x-b<h)return;let A=this.state.selection.main,D=[A.from];A.empty||D.push(A.to);for(let P of D)if(P>b&&P<x){p(b,P-10,S,M),p(P+10,x,S,M);return}let N=Hm(t,P=>P.from>=S.from&&P.to<=S.to&&Math.abs(P.from-b)<h&&Math.abs(P.to-x)<h&&!D.some(W=>P.from<W&&P.to>W));if(!N){if(x<S.to&&i&&n&&i.visibleRanges.some(P=>P.from<=x&&P.to>=x)){let P=i.moveToLineBoundary(j.cursor(x),!1,!0).head;P>b&&(x=P)}N=new Fl(b,x,this.gapSize(S,b,x,M))}d.push(N)},v=b=>{if(b.length<u||b.type!=Ee.Text)return;let x=Rm(b.from,b.to,this.stateDeco);if(x.total<u)return;let S=this.scrollTarget?this.scrollTarget.range.head:null,M,A;if(n){let D=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,N,P;if(S!=null){let W=Us(x,S),_=((this.visibleBottom-this.visibleTop)/2+D)/b.height;N=W-_,P=W+_}else N=(this.visibleTop-b.top-D)/b.height,P=(this.visibleBottom-b.top+D)/b.height;M=Ks(x,N),A=Ks(x,P)}else{let D=x.total*this.heightOracle.charWidth,N=s*this.heightOracle.charWidth,P,W;if(S!=null){let _=Us(x,S),Y=((this.pixelViewport.right-this.pixelViewport.left)/2+N)/D;P=_-Y,W=_+Y}else P=(this.pixelViewport.left-N)/D,W=(this.pixelViewport.right+N)/D;M=Ks(x,P),A=Ks(x,W)}M>b.from&&p(b.from,M,b,x),A<b.to&&p(A,b.to,b,x)};for(let b of this.viewportLines)Array.isArray(b.type)?b.type.forEach(v):v(b);return d}gapSize(t,i,n,s){let h=Us(s,n)-Us(s,i);return this.heightOracle.lineWrapping?t.height*h:s.total*this.heightOracle.charWidth*h}updateLineGaps(t){Fl.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=It.set(t.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];bt.spans(t,this.viewport.from,this.viewport.to,{span(s,h){i.push({from:s,to:h})},point(){}},20);let n=i.length!=this.visibleRanges.length||this.visibleRanges.some((s,h)=>s.from!=i[h].from||s.to!=i[h].to);return this.visibleRanges=i,n?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(i=>i.from<=t&&i.to>=t)||Rn(this.heightMap.lineAt(t,Mt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=t&&i.bottom>=t)||Rn(this.heightMap.lineAt(this.scaler.fromDOM(t),Mt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let i=this.lineBlockAtHeight(t+8);return i.from>=this.viewport.from||this.viewportLines[0].top-t>200?i:this.viewportLines[0]}elementAtHeight(t){return Rn(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class zs{constructor(t,i){this.from=t,this.to=i}}function Rm(f,t,i){let n=[],s=f,h=0;return bt.spans(i,f,t,{span(){},point(u,d){u>s&&(n.push({from:s,to:u}),h+=u-s),s=d}},20),s<t&&(n.push({from:s,to:t}),h+=t-s),{total:h,ranges:n}}function Ks({total:f,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let n=Math.floor(f*i);for(let s=0;;s++){let{from:h,to:u}=t[s],d=u-h;if(n<=d)return h+n;n-=d}}function Us(f,t){let i=0;for(let{from:n,to:s}of f.ranges){if(t<=s){i+=t-n;break}i+=s-n}return i/f.total}function Hm(f,t){for(let i of f)if(t(i))return i}const zu={toDOM(f){return f},fromDOM(f){return f},scale:1,eq(f){return f==this}};class Ua{constructor(t,i,n){let s=0,h=0,u=0;this.viewports=n.map(({from:d,to:p})=>{let v=i.lineAt(d,Mt.ByPos,t,0,0).top,b=i.lineAt(p,Mt.ByPos,t,0,0).bottom;return s+=b-v,{from:d,to:p,top:v,bottom:b,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(i.height-s);for(let d of this.viewports)d.domTop=u+(d.top-h)*this.scale,u=d.domBottom=d.domTop+(d.bottom-d.top),h=d.bottom}toDOM(t){for(let i=0,n=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.top)return s+(t-n)*this.scale;if(t<=h.bottom)return h.domTop+(t-h.top);n=h.bottom,s=h.domBottom}}fromDOM(t){for(let i=0,n=0,s=0;;i++){let h=i<this.viewports.length?this.viewports[i]:null;if(!h||t<h.domTop)return n+(t-s)/this.scale;if(t<=h.domBottom)return h.top+(t-h.domTop);n=h.bottom,s=h.domBottom}}eq(t){return t instanceof Ua?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((i,n)=>i.from==t.viewports[n].from&&i.to==t.viewports[n].to):!1}}function Rn(f,t){if(t.scale==1)return f;let i=t.toDOM(f.top),n=t.toDOM(f.bottom);return new ei(f.from,f.length,i,n-i,Array.isArray(f._content)?f._content.map(s=>Rn(s,t)):f._content)}const Gs=et.define({combine:f=>f.join(" ")}),Sa=et.define({combine:f=>f.indexOf(!0)>-1}),ka=Ur.newName(),bd=Ur.newName(),wd=Ur.newName(),xd={"&light":"."+bd,"&dark":"."+wd};function Ca(f,t,i){return new Ur(t,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return f;if(!i||!i[s])throw new RangeError(`Unsupported selector: ${s}`);return i[s]}):f+" "+n}})}const Im=Ca("."+ka,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},xd),Hn="￿";class Wm{constructor(t,i){this.points=t,this.text="",this.lineSeparator=i.facet(ut.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Hn}readRange(t,i){if(!t)return this;let n=t.parentNode;for(let s=t;;){this.findPointBefore(n,s);let h=this.text.length;this.readNode(s);let u=s.nextSibling;if(u==i)break;let d=St.get(s),p=St.get(u);(d&&p?d.breakAfter:(d?d.breakAfter:lo(s))||lo(u)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>h)&&this.lineBreak(),s=u}return this.findPointBefore(n,i),this}readTextNode(t){let i=t.nodeValue;for(let n of this.points)n.node==t&&(n.pos=this.text.length+Math.min(n.offset,i.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let h=-1,u=1,d;if(this.lineSeparator?(h=i.indexOf(this.lineSeparator,n),u=this.lineSeparator.length):(d=s.exec(i))&&(h=d.index,u=d[0].length),this.append(i.slice(n,h<0?i.length:h)),h<0)break;if(this.lineBreak(),u>1)for(let p of this.points)p.node==t&&p.pos>this.text.length&&(p.pos-=u-1);n=h+u}}readNode(t){if(t.cmIgnore)return;let i=St.get(t),n=i&&i.overrideDOMText;if(n!=null){this.findPointInside(t,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,i){for(let n of this.points)n.node==t&&t.childNodes[n.offset]==i&&(n.pos=this.text.length)}findPointInside(t,i){for(let n of this.points)(t.nodeType==3?n.node==t:t.contains(n.node))&&(n.pos=this.text.length+(Fm(t,n.node,n.offset)?i:0))}}function Fm(f,t,i){for(;;){if(!t||i<gi(t))return!1;if(t==f)return!0;i=or(t)+1,t=t.parentNode}}class Ku{constructor(t,i){this.node=t,this.offset=i,this.pos=-1}}class zm{constructor(t,i,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:h,impreciseAnchor:u}=t.docView;if(t.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=t.docView.domBoundsAround(i,n,0))){let d=h||u?[]:Gm(t),p=new Wm(d,t.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=Vm(d,this.bounds.from)}else{let d=t.observer.selectionRange,p=h&&h.node==d.focusNode&&h.offset==d.focusOffset||!ha(t.contentDOM,d.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(d.focusNode,d.focusOffset),v=u&&u.node==d.anchorNode&&u.offset==d.anchorOffset||!ha(t.contentDOM,d.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(d.anchorNode,d.anchorOffset),b=t.viewport;if((G.ios||G.chrome)&&t.state.selection.main.empty&&p!=v&&(b.from>0||b.to<t.state.doc.length)){let x=Math.min(p,v),S=Math.max(p,v),M=b.from-x,A=b.to-S;(M==0||M==1||x==0)&&(A==0||A==-1||S==t.state.doc.length)&&(p=0,v=t.state.doc.length)}this.newSel=j.single(v,p)}}}function Sd(f,t){let i,{newSel:n}=t,s=f.state.selection.main,h=f.inputState.lastKeyTime>Date.now()-100?f.inputState.lastKeyCode:-1;if(t.bounds){let{from:u,to:d}=t.bounds,p=s.from,v=null;(h===8||G.android&&t.text.length<d-u)&&(p=s.to,v="end");let b=Um(f.state.doc.sliceString(u,d,Hn),t.text,p-u,v);b&&(G.chrome&&h==13&&b.toB==b.from+2&&t.text.slice(b.from,b.toB)==Hn+Hn&&b.toB--,i={from:u+b.from,to:u+b.toA,insert:vt.of(t.text.slice(b.from,b.toB).split(Hn))})}else n&&(!f.hasFocus&&f.state.facet(Di)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&t.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,s.to)}:i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:f.state.doc.slice(s.from,i.from).append(i.insert).append(f.state.doc.slice(i.to,s.to))}:(G.mac||G.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&f.contentDOM.getAttribute("autocorrect")=="off"?(n&&i.insert.length==2&&(n=j.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:vt.of([" "])}):G.chrome&&i&&i.from==i.to&&i.from==s.head&&i.insert.toString()==`
 `&&f.lineWrapping&&(n&&(n=j.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:vt.of([" "])}),i)return kd(f,i,n,h);if(n&&!n.main.eq(s)){let u=!1,d="select";return f.inputState.lastSelectionTime>Date.now()-50&&(f.inputState.lastSelectionOrigin=="select"&&(u=!0),d=f.inputState.lastSelectionOrigin),f.dispatch({selection:n,scrollIntoView:u,userEvent:d}),!0}else return!1}function kd(f,t,i,n=-1){if(G.ios&&f.inputState.flushIOSKey(t))return!0;let s=f.state.selection.main;if(G.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&f.state.sliceDoc(t.from,s.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Wr(f.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||n==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&Wr(f.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&Wr(f.contentDOM,"Delete",46)))return!0;let h=t.insert.toString();f.inputState.composing>=0&&f.inputState.composing++;let u,d=()=>u||(u=Km(f,t,i));return f.state.facet(Qc).some(p=>p(f,t.from,t.to,h,d))||f.dispatch(d()),!0}function Km(f,t,i){let n,s=f.state,h=s.selection.main;if(t.from>=h.from&&t.to<=h.to&&t.to-t.from>=(h.to-h.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&f.inputState.composing<0){let d=h.from<t.from?s.sliceDoc(h.from,t.from):"",p=h.to>t.to?s.sliceDoc(t.to,h.to):"";n=s.replaceSelection(f.state.toText(d+t.insert.sliceString(0,void 0,f.state.lineBreak)+p))}else{let d=s.changes(t),p=i&&i.main.to<=d.newLength?i.main:void 0;if(s.selection.ranges.length>1&&f.inputState.composing>=0&&t.to<=h.to&&t.to>=h.to-10){let v=f.state.sliceDoc(t.from,t.to),b,x=i&&ad(f,i.main.head);if(x){let A=t.insert.length-(t.to-t.from);b={from:x.from,to:x.to-A}}else b=f.state.doc.lineAt(h.head);let S=h.to-t.to,M=h.to-h.from;n=s.changeByRange(A=>{if(A.from==h.from&&A.to==h.to)return{changes:d,range:p||A.map(d)};let D=A.to-S,N=D-v.length;if(A.to-A.from!=M||f.state.sliceDoc(N,D)!=v||A.to>=b.from&&A.from<=b.to)return{range:A};let P=s.changes({from:N,to:D,insert:t.insert}),W=A.to-h.to;return{changes:P,range:p?j.range(Math.max(0,p.anchor+W),Math.max(0,p.head+W)):A.map(P)}})}else n={changes:d,selection:p&&s.selection.replaceRange(p)}}let u="input.type";return(f.composing||f.inputState.compositionPendingChange&&f.inputState.compositionEndedAt>Date.now()-50)&&(f.inputState.compositionPendingChange=!1,u+=".compose",f.inputState.compositionFirstChange&&(u+=".start",f.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:u,scrollIntoView:!0})}function Um(f,t,i,n){let s=Math.min(f.length,t.length),h=0;for(;h<s&&f.charCodeAt(h)==t.charCodeAt(h);)h++;if(h==s&&f.length==t.length)return null;let u=f.length,d=t.length;for(;u>0&&d>0&&f.charCodeAt(u-1)==t.charCodeAt(d-1);)u--,d--;if(n=="end"){let p=Math.max(0,h-Math.min(u,d));i-=u+p-h}if(u<h&&f.length<t.length){let p=i<=h&&i>=u?h-i:0;h-=p,d=h+(d-u),u=h}else if(d<h){let p=i<=h&&i>=d?h-i:0;h-=p,u=h+(u-d),d=h}return{from:h,toA:u,toB:d}}function Gm(f){let t=[];if(f.root.activeElement!=f.contentDOM)return t;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:h}=f.observer.selectionRange;return i&&(t.push(new Ku(i,n)),(s!=i||h!=n)&&t.push(new Ku(s,h))),t}function Vm(f,t){if(f.length==0)return null;let i=f[0].pos,n=f.length==2?f[1].pos:i;return i>-1&&n>-1?j.single(i+t,n+t):null}const qm={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},zl=G.ie&&G.ie_version<=11;class Ym{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new L0,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(i=>{for(let n of i)this.queue.push(n);(G.ie&&G.ie_version<=11||G.ios&&t.composing)&&i.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&t.constructor.EDIT_CONTEXT!==!1&&!(G.chrome&&G.chrome_version<126)&&(this.editContext=new _m(t),t.state.facet(Di)&&(t.contentDOM.editContext=this.editContext.editContext)),zl&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){t.type=="change"&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((i,n)=>i!=t[n]))){this.gapIntersection.disconnect();for(let i of t)this.gapIntersection.observe(i);this.gaps=t}}onSelectionChange(t){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(Di)?n.root.activeElement!=this.dom:!$s(n.dom,s))return;let h=s.anchorNode&&n.docView.nearest(s.anchorNode);if(h&&h.ignoreEvent(t)){i||(this.selectionChanged=!1);return}(G.ie&&G.ie_version<=11||G.android&&G.chrome)&&!n.state.selection.main.empty&&s.focusNode&&zn(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,i=qn(t.root);if(!i)return!1;let n=G.safari&&t.root.nodeType==11&&C0(this.dom.ownerDocument)==this.dom&&Xm(this.view,i)||i;if(!n||this.selectionRange.eq(n))return!1;let s=$s(this.dom,n);return s&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&D0(this.dom,n)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(t,i){this.selectionRange.set(t.node,t.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,i=null;for(let n=this.dom;n;)if(n.nodeType==1)!i&&t<this.scrollTargets.length&&this.scrollTargets[t]==n?t++:i||(i=this.scrollTargets.slice(0,t)),i&&i.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(t<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,t)),i){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=i)n.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,qm),zl&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),zl&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,i){var n;if(!this.delayedAndroidKey){let s=()=>{let h=this.delayedAndroidKey;h&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=h.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&h.force&&Wr(this.dom,h.key,h.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let i=-1,n=-1,s=!1;for(let h of t){let u=this.readMutation(h);u&&(u.typeOver&&(s=!0),i==-1?{from:i,to:n}=u:(i=Math.min(u.from,i),n=Math.max(u.to,n)))}return{from:i,to:n,typeOver:s}}readChange(){let{from:t,to:i,typeOver:n}=this.processRecords(),s=this.selectionChanged&&$s(this.dom,this.selectionRange);if(t<0&&!s)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let h=new zm(this.view,t,i,n);return this.view.docView.domChanged={newSel:h.newSel?h.newSel.main:null},h}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let n=this.view.state,s=Sd(this.view,i);return this.view.state==n&&(i.domChanged||i.newSel&&!i.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(t){let i=this.view.docView.nearest(t.target);if(!i||i.ignoreMutation(t))return null;if(i.markDirty(t.type=="attributes"),t.type=="attributes"&&(i.flags|=4),t.type=="childList"){let n=Uu(i,t.previousSibling||t.target.previousSibling,-1),s=Uu(i,t.nextSibling||t.target.nextSibling,1);return{from:n?i.posAfter(n):i.posAtStart,to:s?i.posBefore(s):i.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Di)!=t.state.facet(Di)&&(t.view.contentDOM.editContext=t.state.facet(Di)?this.editContext.editContext:null))}destroy(){var t,i,n;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Uu(f,t,i){for(;t;){let n=St.get(t);if(n&&n.parent==f)return n;let s=t.parentNode;t=s!=f.dom?s:i>0?t.nextSibling:t.previousSibling}return null}function Gu(f,t){let i=t.startContainer,n=t.startOffset,s=t.endContainer,h=t.endOffset,u=f.docView.domAtPos(f.state.selection.main.anchor);return zn(u.node,u.offset,s,h)&&([i,n,s,h]=[s,h,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:h}}function Xm(f,t){if(t.getComposedRanges){let s=t.getComposedRanges(f.root)[0];if(s)return Gu(f,s)}let i=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),i=s.getTargetRanges()[0]}return f.contentDOM.addEventListener("beforeinput",n,!0),f.dom.ownerDocument.execCommand("indent"),f.contentDOM.removeEventListener("beforeinput",n,!0),i?Gu(f,i):null}class _m{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(t.state);let i=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=n=>{let{anchor:s}=t.state.selection.main,h={from:this.toEditorPos(n.updateRangeStart),to:this.toEditorPos(n.updateRangeEnd),insert:vt.of(n.text.split(`
`))};h.from==this.from&&s<this.from?h.from=s:h.to==this.to&&s>this.to&&(h.to=s),!(h.from==h.to&&!h.insert.length)&&(this.pendingContextChange=h,t.state.readOnly||kd(t,h,j.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd))),this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state)))},this.handlers.characterboundsupdate=n=>{let s=[],h=null;for(let u=this.toEditorPos(n.rangeStart),d=this.toEditorPos(n.rangeEnd);u<d;u++){let p=t.coordsForChar(u);h=p&&new DOMRect(p.left,p.top,p.right-p.left,p.bottom-p.top)||h||new DOMRect,s.push(h)}i.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let h of n.getTextFormats()){let u=h.underlineStyle,d=h.underlineThickness;if(u!="None"&&d!="None"){let p=`text-decoration: underline ${u=="Dashed"?"dashed ":u=="Squiggle"?"wavy ":""}${d=="Thin"?1:2}px`;s.push(It.mark({attributes:{style:p}}).range(this.toEditorPos(h.rangeStart),this.toEditorPos(h.rangeEnd)))}}t.dispatch({effects:id.of(It.set(s))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{t.inputState.composing=-1,t.inputState.compositionFirstChange=null};for(let n in this.handlers)i.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=qn(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let i=0,n=!1,s=this.pendingContextChange;return t.changes.iterChanges((h,u,d,p,v)=>{if(n)return;let b=v.length-(u-h);if(s&&u>=s.to)if(s.from==h&&s.to==u&&s.insert.eq(v)){s=this.pendingContextChange=null,i+=b,this.to+=b;return}else s=null,this.revertPending(t.state);if(h+=i,u+=i,u<=this.from)this.from+=b,this.to+=b;else if(h<this.to){if(h<this.from||u>this.to||this.to-this.from+v.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(h),this.toContextPos(u),v.toString()),this.to+=b}i+=b}),s&&!n&&this.revertPending(t.state),!n}update(t){let i=this.pendingContextChange;!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.resetRange(t.state),this.editContext.updateText(0,this.editContext.text.length,t.state.doc.sliceString(this.from,this.to)),this.setSelection(t.state)):(t.docChanged||t.selectionSet||i)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:i}=t.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(t.doc.length,i+1e4)}revertPending(t){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),t.doc.sliceString(i.from,i.to))}setSelection(t){let{main:i}=t.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),s=this.toContextPos(i.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(t){let{head:i}=t.selection.main;return!(this.from>0&&i-this.from<500||this.to<t.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(t){return t+this.from}toContextPos(t){return t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class ht{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(n=>n.forEach(s=>i(s,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||O0(t.parent)||document,this.viewState=new Fu(t.state||ut.create(t)),t.scrollTo&&t.scrollTo.is(Is)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(En).map(n=>new Hl(n));for(let n of this.plugins)n.update(this);this.observer=new Ym(this),this.inputState=new hm(this),this.inputState.ensureHandlers(this.plugins),this.docView=new xu(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...t){let i=t.length==1&&t[0]instanceof le?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,n=!1,s,h=this.state;for(let S of t){if(S.startState!=h)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");h=S.state}if(this.destroyed){this.viewState.state=h;return}let u=this.hasFocus,d=0,p=null;t.some(S=>S.annotation(gd))?(this.inputState.notifiedFocused=u,d=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,p=md(h,u),p||(d=1));let v=this.observer.delayedAndroidKey,b=null;if(v?(this.observer.clearDelayedAndroidKey(),b=this.observer.readChange(),(b&&!this.state.doc.eq(h.doc)||!this.state.selection.eq(h.selection))&&(b=null)):this.observer.clear(),h.facet(ut.phrases)!=this.state.facet(ut.phrases))return this.setState(h);s=ho.create(this,h,t),s.flags|=d;let x=this.viewState.scrollTarget;try{this.updateState=2;for(let S of t){if(x&&(x=x.map(S.changes)),S.scrollIntoView){let{main:M}=S.state.selection;x=new Fr(M.empty?M:j.cursor(M.head,M.head>M.anchor?-1:1))}for(let M of S.effects)M.is(Is)&&(x=M.value.clip(this.state))}this.viewState.update(s,x),this.bidiCache=fo.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),i=this.docView.update(s),this.state.facet(Bn)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some(S=>S.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Gs)!=s.state.facet(Gs)&&(this.viewState.mustMeasureContent=!0),(i||n||x||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!s.empty)for(let S of this.state.facet(ba))try{S(s)}catch(M){ri(this.state,M,"update listener")}(p||b)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),b&&!Sd(this,b)&&v.force&&Wr(this.contentDOM,v.key,v.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let i=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Fu(t),this.plugins=t.facet(En).map(n=>new Hl(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new xu(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(t){let i=t.startState.facet(En),n=t.state.facet(En);if(i!=n){let s=[];for(let h of n){let u=i.indexOf(h);if(u<0)s.push(new Hl(h));else{let d=this.plugins[u];d.mustUpdate=t,s.push(d)}}for(let h of this.plugins)h.mustUpdate!=t&&h.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);i!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let i=t.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(n){ri(this.state,n,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let i=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:h,scrollAnchorHeight:u}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let d=0;;d++){if(u<0)if(Nc(n))h=-1,u=this.viewState.heightMap.height;else{let M=this.viewState.scrollAnchorAt(s);h=M.from,u=M.top}this.updateState=1;let p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let v=[];p&4||([this.measureRequests,v]=[v,this.measureRequests]);let b=v.map(M=>{try{return M.read(this)}catch(A){return ri(this.state,A),Vu}}),x=ho.create(this,this.state,[]),S=!1;x.flags|=p,i?i.flags|=p:i=x,this.updateState=2,x.empty||(this.updatePlugins(x),this.inputState.update(x),this.updateAttrs(),S=this.docView.update(x),S&&this.docViewUpdate());for(let M=0;M<v.length;M++)if(b[M]!=Vu)try{let A=v[M];A.write&&A.write(b[M],this)}catch(A){ri(this.state,A)}if(S&&this.docView.updateSelection(!0),!x.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let A=(h<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(h).top)-u;if(A>1||A<-1){s=s+A,n.scrollTop=s/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let d of this.state.facet(ba))d(i)}get themeClasses(){return ka+" "+(this.state.facet(Sa)?wd:bd)+" "+this.state.facet(Gs)}updateAttrs(){let t=qu(this,rd,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Di)?"true":"false",class:"cm-content",style:`${G.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),qu(this,Fa,i);let n=this.observer.ignore(()=>{let s=pa(this.contentDOM,this.contentAttrs,i),h=pa(this.dom,this.editorAttrs,t);return s||h});return this.editorAttrs=t,this.contentAttrs=i,n}showAnnouncements(t){let i=!0;for(let n of t)for(let s of n.effects)if(s.is(ht.announce)){i&&(this.announceDOM.textContent=""),i=!1;let h=this.announceDOM.appendChild(document.createElement("div"));h.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Bn);let t=this.state.facet(ht.cspNonce);Ur.mount(this.root,this.styleModules.concat(Im).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===t.key){this.measureRequests[i]=t;return}}this.measureRequests.push(t)}}plugin(t){let i=this.pluginMap.get(t);return(i===void 0||i&&i.spec!=t)&&this.pluginMap.set(t,i=this.plugins.find(n=>n.spec==t)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,i,n){return Wl(this,t,Tu(this,t,i,n))}moveByGroup(t,i){return Wl(this,t,Tu(this,t,i,n=>lm(this,t.head,n)))}visualLineSide(t,i){let n=this.bidiSpans(t),s=this.textDirectionAt(t.from),h=n[i?n.length-1:0];return j.cursor(h.side(i,s)+t.from,h.forward(!i,s)?1:-1)}moveToLineBoundary(t,i,n=!0){return om(this,t,i,n)}moveVertically(t,i,n){return Wl(this,t,am(this,t,i,n))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,i=0){return this.docView.posFromDOM(t,i)}posAtCoords(t,i=!0){return this.readMeasured(),hd(this,t,i)}coordsAtPos(t,i=1){this.readMeasured();let n=this.docView.coordsAt(t,i);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(t),h=this.bidiSpans(s),u=h[Ei.find(h,t-s.from,-1,i)];return go(n,u.dir==Yt.LTR==i>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(td)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>jm)return Yc(t.length);let i=this.textDirectionAt(t.from),n;for(let h of this.bidiCache)if(h.from==t.from&&h.dir==i&&(h.fresh||qc(h.isolates,n=wu(this,t))))return h.order;n||(n=wu(this,t));let s=U0(t.text,i,n);return this.bidiCache.push(new fo(t.from,t.to,i,n,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||G.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Oc(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,i={}){return Is.of(new Fr(typeof t=="number"?j.cursor(t):t,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:i}=this.scrollDOM,n=this.viewState.scrollAnchorAt(t);return Is.of(new Fr(j.cursor(n.from),"start","start",n.top-t,i,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Ii.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Ii.define(()=>({}),{eventObservers:t})}static theme(t,i){let n=Ur.newName(),s=[Gs.of(n),Bn.of(Ca(`.${n}`,t))];return i&&i.dark&&s.push(Sa.of(!0)),s}static baseTheme(t){return mc.lowest(Bn.of(Ca("."+ka,t,xd)))}static findFromDOM(t){var i;let n=t.querySelector(".cm-content"),s=n&&St.get(n)||St.get(t);return((i=s==null?void 0:s.rootView)===null||i===void 0?void 0:i.view)||null}}ht.styleModule=Bn;ht.inputHandler=Qc;ht.scrollHandler=ed;ht.focusChangeEffect=$c;ht.perLineTextDirection=td;ht.exceptionSink=Zc;ht.updateListener=ba;ht.editable=Di;ht.mouseSelectionStyle=Jc;ht.dragMovesSelection=jc;ht.clickAddsSelectionRange=_c;ht.decorations=Yn;ht.outerDecorations=nd;ht.atomicRanges=za;ht.bidiIsolatedRanges=sd;ht.scrollMargins=od;ht.darkTheme=Sa;ht.cspNonce=et.define({combine:f=>f.length?f[0]:""});ht.contentAttributes=Fa;ht.editorAttributes=rd;ht.lineWrapping=ht.contentAttributes.of({class:"cm-lineWrapping"});ht.announce=Ht.define();const jm=4096,Vu={};class fo{constructor(t,i,n,s,h,u){this.from=t,this.to=i,this.dir=n,this.isolates=s,this.fresh=h,this.order=u}static update(t,i){if(i.empty&&!t.some(h=>h.fresh))return t;let n=[],s=t.length?t[t.length-1].dir:Yt.LTR;for(let h=Math.max(0,t.length-10);h<t.length;h++){let u=t[h];u.dir==s&&!i.touchesRange(u.from,u.to)&&n.push(new fo(i.mapPos(u.from,1),i.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return n}}function qu(f,t,i){for(let n=f.state.facet(t),s=n.length-1;s>=0;s--){let h=n[s],u=typeof h=="function"?h(f):h;u&&da(u,i)}return i}const Jm=G.mac?"mac":G.windows?"win":G.linux?"linux":"key";function Zm(f,t){const i=f.split(/-(?!$)/);let n=i[i.length-1];n=="Space"&&(n=" ");let s,h,u,d;for(let p=0;p<i.length-1;++p){const v=i[p];if(/^(cmd|meta|m)$/i.test(v))d=!0;else if(/^a(lt)?$/i.test(v))s=!0;else if(/^(c|ctrl|control)$/i.test(v))h=!0;else if(/^s(hift)?$/i.test(v))u=!0;else if(/^mod$/i.test(v))t=="mac"?d=!0:h=!0;else throw new Error("Unrecognized modifier name: "+v)}return s&&(n="Alt-"+n),h&&(n="Ctrl-"+n),d&&(n="Meta-"+n),u&&(n="Shift-"+n),n}function Vs(f,t,i){return t.altKey&&(f="Alt-"+f),t.ctrlKey&&(f="Ctrl-"+f),t.metaKey&&(f="Meta-"+f),i!==!1&&t.shiftKey&&(f="Shift-"+f),f}const Qm=mc.default(ht.domEventHandlers({keydown(f,t){return iv($m(t.state),f,t,"editor")}})),Cd=et.define({enables:Qm}),Yu=new WeakMap;function $m(f){let t=f.facet(Cd),i=Yu.get(t);return i||Yu.set(t,i=ev(t.reduce((n,s)=>n.concat(s),[]))),i}let Ni=null;const tv=4e3;function ev(f,t=Jm){let i=Object.create(null),n=Object.create(null),s=(u,d)=>{let p=n[u];if(p==null)n[u]=d;else if(p!=d)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},h=(u,d,p,v,b)=>{var x,S;let M=i[u]||(i[u]=Object.create(null)),A=d.split(/ (?!$)/).map(P=>Zm(P,t));for(let P=1;P<A.length;P++){let W=A.slice(0,P).join(" ");s(W,!0),M[W]||(M[W]={preventDefault:!0,stopPropagation:!1,run:[_=>{let Y=Ni={view:_,prefix:W,scope:u};return setTimeout(()=>{Ni==Y&&(Ni=null)},tv),!0}]})}let D=A.join(" ");s(D,!1);let N=M[D]||(M[D]={preventDefault:!1,stopPropagation:!1,run:((S=(x=M._any)===null||x===void 0?void 0:x.run)===null||S===void 0?void 0:S.slice())||[]});p&&N.run.push(p),v&&(N.preventDefault=!0),b&&(N.stopPropagation=!0)};for(let u of f){let d=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let v of d){let b=i[v]||(i[v]=Object.create(null));b._any||(b._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:x}=u;for(let S in b)b[S].run.push(M=>x(M,Ma))}let p=u[t]||u.key;if(p)for(let v of d)h(v,p,u.run,u.preventDefault,u.stopPropagation),u.shift&&h(v,"Shift-"+p,u.shift,u.preventDefault,u.stopPropagation)}return i}let Ma=null;function iv(f,t,i,n){Ma=t;let s=k0(t),h=Zs(s,0),u=jl(h)==s.length&&s!=" ",d="",p=!1,v=!1,b=!1;Ni&&Ni.view==i&&Ni.scope==n&&(d=Ni.prefix+" ",ud.indexOf(t.keyCode)<0&&(v=!0,Ni=null));let x=new Set,S=N=>{if(N){for(let P of N.run)if(!x.has(P)&&(x.add(P),P(i)))return N.stopPropagation&&(b=!0),!0;N.preventDefault&&(N.stopPropagation&&(b=!0),v=!0)}return!1},M=f[n],A,D;return M&&(S(M[d+Vs(s,t,!u)])?p=!0:u&&(t.altKey||t.metaKey||t.ctrlKey)&&!(G.windows&&t.ctrlKey&&t.altKey)&&(A=Ri[t.keyCode])&&A!=s?(S(M[d+Vs(A,t,!0)])||t.shiftKey&&(D=Vn[t.keyCode])!=s&&D!=A&&S(M[d+Vs(D,t,!1)]))&&(p=!0):u&&t.shiftKey&&S(M[d+Vs(s,t,!0)])&&(p=!0),!p&&S(M._any)&&(p=!0)),v&&(p=!0),p&&b&&t.stopPropagation(),Ma=null,p}const rv=!G.ios,Xu={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};rv&&(Xu[".cm-line"].caretColor=Xu[".cm-content"].caretColor="transparent !important");class nv extends vo{constructor(t){super(),this.content=t}toDOM(){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(t){let i=t.firstChild?Gr(t.firstChild):[];if(!i.length)return null;let n=window.getComputedStyle(t.parentNode),s=go(i[0],n.direction!="rtl"),h=parseInt(n.lineHeight);return s.bottom-s.top>h*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+h}:s}ignoreEvent(){return!1}}function sv(f){return Ii.fromClass(class{constructor(t){this.view=t,this.placeholder=f?It.set([It.widget({widget:new nv(f),side:1}).range(0)]):It.none}get decorations(){return this.view.state.doc.length?It.none:this.placeholder}},{decorations:t=>t.decorations})}class hr extends Kr{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}hr.prototype.elementClass="";hr.prototype.toDOM=void 0;hr.prototype.mapMode=Le.TrackBefore;hr.prototype.startSide=hr.prototype.endSide=-1;hr.prototype.point=!0;const Kl=et.define(),io=et.define(),Aa=et.define({combine:f=>f.some(t=>t)});function ov(f){let t=[lv];return f&&f.fixed===!1&&t.push(Aa.of(!0)),t}const lv=Ii.fromClass(class{constructor(f){this.view=f,this.prevViewport=f.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=f.state.facet(io).map(t=>new ju(f,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!f.state.facet(Aa),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),f.scrollDOM.insertBefore(this.dom,f.contentDOM)}update(f){if(this.updateGutters(f)){let t=this.prevViewport,i=f.view.viewport,n=Math.min(t.to,i.to)-Math.max(t.from,i.from);this.syncGutters(n<(i.to-i.from)*.8)}f.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Aa)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=f.view.viewport}syncGutters(f){let t=this.dom.nextSibling;f&&this.dom.remove();let i=bt.iter(this.view.state.facet(Kl),this.view.viewport.from),n=[],s=this.gutters.map(h=>new av(h,this.view.viewport,-this.view.documentPadding.top));for(let h of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(h.type)){let u=!0;for(let d of h.type)if(d.type==Ee.Text&&u){Ta(i,n,d.from);for(let p of s)p.line(this.view,d,n);u=!1}else if(d.widget)for(let p of s)p.widget(this.view,d)}else if(h.type==Ee.Text){Ta(i,n,h.from);for(let u of s)u.line(this.view,h,n)}else if(h.widget)for(let u of s)u.widget(this.view,h);for(let h of s)h.finish();f&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(f){let t=f.startState.facet(io),i=f.state.facet(io),n=f.docChanged||f.heightChanged||f.viewportChanged||!bt.eq(f.startState.facet(Kl),f.state.facet(Kl),f.view.viewport.from,f.view.viewport.to);if(t==i)for(let s of this.gutters)s.update(f)&&(n=!0);else{n=!0;let s=[];for(let h of i){let u=t.indexOf(h);u<0?s.push(new ju(this.view,h)):(this.gutters[u].update(f),s.push(this.gutters[u]))}for(let h of this.gutters)h.dom.remove(),s.indexOf(h)<0&&h.destroy();for(let h of s)this.dom.appendChild(h.dom);this.gutters=s}return n}destroy(){for(let f of this.gutters)f.destroy();this.dom.remove()}},{provide:f=>ht.scrollMargins.of(t=>{let i=t.plugin(f);return!i||i.gutters.length==0||!i.fixed?null:t.textDirection==Yt.LTR?{left:i.dom.offsetWidth*t.scaleX}:{right:i.dom.offsetWidth*t.scaleX}})});function _u(f){return Array.isArray(f)?f:[f]}function Ta(f,t,i){for(;f.value&&f.from<=i;)f.from==i&&t.push(f.value),f.next()}class av{constructor(t,i,n){this.gutter=t,this.height=n,this.i=0,this.cursor=bt.iter(t.markers,i.from)}addElement(t,i,n){let{gutter:s}=this,h=(i.top-this.height)/t.scaleY,u=i.height/t.scaleY;if(this.i==s.elements.length){let d=new Md(t,u,h,n);s.elements.push(d),s.dom.appendChild(d.dom)}else s.elements[this.i].update(t,u,h,n);this.height=i.bottom,this.i++}line(t,i,n){let s=[];Ta(this.cursor,s,i.from),n.length&&(s=s.concat(n));let h=this.gutter.config.lineMarker(t,i,s);h&&s.unshift(h);let u=this.gutter;s.length==0&&!u.config.renderEmptyElements||this.addElement(t,i,s)}widget(t,i){let n=this.gutter.config.widgetMarker(t,i.widget,i);n&&this.addElement(t,i,[n])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let i=t.elements.pop();t.dom.removeChild(i.dom),i.destroy()}}}class ju{constructor(t,i){this.view=t,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in i.domEventHandlers)this.dom.addEventListener(n,s=>{let h=s.target,u;if(h!=this.dom&&this.dom.contains(h)){for(;h.parentNode!=this.dom;)h=h.parentNode;let p=h.getBoundingClientRect();u=(p.top+p.bottom)/2}else u=s.clientY;let d=t.lineBlockAtHeight(u-t.documentTop);i.domEventHandlers[n](t,d,s)&&s.preventDefault()});this.markers=_u(i.markers(t)),i.initialSpacer&&(this.spacer=new Md(t,0,0,[i.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let i=this.markers;if(this.markers=_u(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],t);s!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[s])}let n=t.view.viewport;return!bt.eq(this.markers,i,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class Md{constructor(t,i,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,i,n,s)}update(t,i,n,s){this.height!=i&&(this.height=i,this.dom.style.height=i+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),hv(this.markers,s)||this.setMarkers(t,s)}setMarkers(t,i){let n="cm-gutterElement",s=this.dom.firstChild;for(let h=0,u=0;;){let d=u,p=h<i.length?i[h++]:null,v=!1;if(p){let b=p.elementClass;b&&(n+=" "+b);for(let x=u;x<this.markers.length;x++)if(this.markers[x].compare(p)){d=x,v=!0;break}}else d=this.markers.length;for(;u<d;){let b=this.markers[u++];if(b.toDOM){b.destroy(s);let x=s.nextSibling;s.remove(),s=x}}if(!p)break;p.toDOM&&(v?s=s.nextSibling:this.dom.insertBefore(p.toDOM(t),s)),v&&u++}this.dom.className=n,this.markers=i}destroy(){this.setMarkers(null,[])}}function hv(f,t){if(f.length!=t.length)return!1;for(let i=0;i<f.length;i++)if(!f[i].compare(t[i]))return!1;return!0}const fv=et.define(),Rr=et.define({combine(f){return m0(f,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,i){let n=Object.assign({},t);for(let s in i){let h=n[s],u=i[s];n[s]=h?(d,p,v)=>h(d,p,v)||u(d,p,v):u}return n}})}});class Ul extends hr{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Gl(f,t){return f.state.facet(Rr).formatNumber(t,f.state)}const uv=io.compute([Rr],f=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(fv)},lineMarker(t,i,n){return n.some(s=>s.toDOM)?null:new Ul(Gl(t,t.state.doc.lineAt(i.from).number))},widgetMarker:()=>null,lineMarkerChange:t=>t.startState.facet(Rr)!=t.state.facet(Rr),initialSpacer(t){return new Ul(Gl(t,Ju(t.state.doc.lines)))},updateSpacer(t,i){let n=Gl(i.view,Ju(i.view.state.doc.lines));return n==t.number?t:new Ul(n)},domEventHandlers:f.facet(Rr).domEventHandlers}));function Jv(f={}){return[Rr.of(f),ov(),uv]}function Ju(f){let t=9;for(;t<f;)t=t*10+9;return t}const cv=1024;let dv=0;class Vl{constructor(t,i){this.from=t,this.to=i}}class kt{constructor(t={}){this.id=dv++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Oe.match(t)),i=>{let n=t(i);return n===void 0?null:[this,n]}}}kt.closedBy=new kt({deserialize:f=>f.split(" ")});kt.openedBy=new kt({deserialize:f=>f.split(" ")});kt.group=new kt({deserialize:f=>f.split(" ")});kt.isolate=new kt({deserialize:f=>{if(f&&f!="rtl"&&f!="ltr"&&f!="auto")throw new RangeError("Invalid value for isolate: "+f);return f||"auto"}});kt.contextHash=new kt({perNode:!0});kt.lookAhead=new kt({perNode:!0});kt.mounted=new kt({perNode:!0});class uo{constructor(t,i,n){this.tree=t,this.overlay=i,this.parser=n}static get(t){return t&&t.props&&t.props[kt.mounted.id]}}const pv=Object.create(null);class Oe{constructor(t,i,n,s=0){this.name=t,this.props=i,this.id=n,this.flags=s}static define(t){let i=t.props&&t.props.length?Object.create(null):pv,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),s=new Oe(t.name||"",i,t.id,n);if(t.props){for(let h of t.props)if(Array.isArray(h)||(h=h(s)),h){if(h[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[h[0].id]=h[1]}}return s}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let i=this.prop(kt.group);return i?i.indexOf(t)>-1:!1}return this.id==t}static match(t){let i=Object.create(null);for(let n in t)for(let s of n.split(" "))i[s]=t[n];return n=>{for(let s=n.prop(kt.group),h=-1;h<(s?s.length:0);h++){let u=i[h<0?n.name:s[h]];if(u)return u}}}}Oe.none=new Oe("",Object.create(null),0,8);class Ad{constructor(t){this.types=t;for(let i=0;i<t.length;i++)if(t[i].id!=i)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let i=[];for(let n of this.types){let s=null;for(let h of t){let u=h(n);u&&(s||(s=Object.assign({},n.props)),s[u[0].id]=u[1])}i.push(s?new Oe(n.name,s,n.id,n.flags):n)}return new Ad(i)}}const qs=new WeakMap,Zu=new WeakMap;var $t;(function(f){f[f.ExcludeBuffers=1]="ExcludeBuffers",f[f.IncludeAnonymous=2]="IncludeAnonymous",f[f.IgnoreMounts=4]="IgnoreMounts",f[f.IgnoreOverlays=8]="IgnoreOverlays"})($t||($t={}));class ae{constructor(t,i,n,s,h){if(this.type=t,this.children=i,this.positions=n,this.length=s,this.props=null,h&&h.length){this.props=Object.create(null);for(let[u,d]of h)this.props[typeof u=="number"?u:u.id]=d}}toString(){let t=uo.get(this);if(t&&!t.overlay)return t.tree.toString();let i="";for(let n of this.children){let s=n.toString();s&&(i&&(i+=","),i+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}cursor(t=0){return new Oa(this.topNode,t)}cursorAt(t,i=0,n=0){let s=qs.get(this)||this.topNode,h=new Oa(s);return h.moveTo(t,i),qs.set(this,h._tree),h}get topNode(){return new Re(this,0,0,null)}resolve(t,i=0){let n=Xn(qs.get(this)||this.topNode,t,i,!1);return qs.set(this,n),n}resolveInner(t,i=0){let n=Xn(Zu.get(this)||this.topNode,t,i,!0);return Zu.set(this,n),n}resolveStack(t,i=0){return vv(this,t,i)}iterate(t){let{enter:i,leave:n,from:s=0,to:h=this.length}=t,u=t.mode||0,d=(u&$t.IncludeAnonymous)>0;for(let p=this.cursor(u|$t.IncludeAnonymous);;){let v=!1;if(p.from<=h&&p.to>=s&&(!d&&p.type.isAnonymous||i(p)!==!1)){if(p.firstChild())continue;v=!0}for(;v&&n&&(d||!p.type.isAnonymous)&&n(p),!p.nextSibling();){if(!p.parent())return;v=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let i in this.props)t.push([+i,this.props[i]]);return t}balance(t={}){return this.children.length<=8?this:qa(Oe.none,this.children,this.positions,0,this.children.length,0,this.length,(i,n,s)=>new ae(this.type,i,n,s,this.propValues),t.makeTree||((i,n,s)=>new ae(Oe.none,i,n,s)))}static build(t){return yv(t)}}ae.empty=new ae(Oe.none,[],[],0);class Ga{constructor(t,i){this.buffer=t,this.index=i}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ga(this.buffer,this.index)}}class Wi{constructor(t,i,n){this.buffer=t,this.length=i,this.set=n}get type(){return Oe.none}toString(){let t=[];for(let i=0;i<this.buffer.length;)t.push(this.childString(i)),i=this.buffer[i+3];return t.join(",")}childString(t){let i=this.buffer[t],n=this.buffer[t+3],s=this.set.types[i],h=s.name;if(/\W/.test(h)&&!s.isError&&(h=JSON.stringify(h)),t+=4,n==t)return h;let u=[];for(;t<n;)u.push(this.childString(t)),t=this.buffer[t+3];return h+"("+u.join(",")+")"}findChild(t,i,n,s,h){let{buffer:u}=this,d=-1;for(let p=t;p!=i&&!(Td(h,s,u[p+1],u[p+2])&&(d=p,n>0));p=u[p+3]);return d}slice(t,i,n){let s=this.buffer,h=new Uint16Array(i-t),u=0;for(let d=t,p=0;d<i;){h[p++]=s[d++],h[p++]=s[d++]-n;let v=h[p++]=s[d++]-n;h[p++]=s[d++]-t,u=Math.max(u,v)}return new Wi(h,u,this.set)}}function Td(f,t,i,n){switch(f){case-2:return i<t;case-1:return n>=t&&i<t;case 0:return i<t&&n>t;case 1:return i<=t&&n>t;case 2:return n>t;case 4:return!0}}function Xn(f,t,i,n){for(var s;f.from==f.to||(i<1?f.from>=t:f.from>t)||(i>-1?f.to<=t:f.to<t);){let u=!n&&f instanceof Re&&f.index<0?null:f.parent;if(!u)return f;f=u}let h=n?0:$t.IgnoreOverlays;if(n)for(let u=f,d=u.parent;d;u=d,d=u.parent)u instanceof Re&&u.index<0&&((s=d.enter(t,i,h))===null||s===void 0?void 0:s.from)!=u.from&&(f=d);for(;;){let u=f.enter(t,i,h);if(!u)return f;f=u}}class Ld{cursor(t=0){return new Oa(this,t)}getChild(t,i=null,n=null){let s=Qu(this,t,i,n);return s.length?s[0]:null}getChildren(t,i=null,n=null){return Qu(this,t,i,n)}resolve(t,i=0){return Xn(this,t,i,!1)}resolveInner(t,i=0){return Xn(this,t,i,!0)}matchContext(t){return La(this,t)}enterUnfinishedNodesBefore(t){let i=this.childBefore(t),n=this;for(;i;){let s=i.lastChild;if(!s||s.to!=i.to)break;s.type.isError&&s.from==s.to?(n=i,i=s.prevSibling):i=s}return n}get node(){return this}get next(){return this.parent}}class Re extends Ld{constructor(t,i,n,s){super(),this._tree=t,this.from=i,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,i,n,s,h=0){for(let u=this;;){for(let{children:d,positions:p}=u._tree,v=i>0?d.length:-1;t!=v;t+=i){let b=d[t],x=p[t]+u.from;if(Td(s,n,x,x+b.length)){if(b instanceof Wi){if(h&$t.ExcludeBuffers)continue;let S=b.findChild(0,b.buffer.length,i,n-x,s);if(S>-1)return new Bi(new gv(u,b,t,x),null,S)}else if(h&$t.IncludeAnonymous||!b.type.isAnonymous||Va(b)){let S;if(!(h&$t.IgnoreMounts)&&(S=uo.get(b))&&!S.overlay)return new Re(S.tree,x,t,u);let M=new Re(b,x,t,u);return h&$t.IncludeAnonymous||!M.type.isAnonymous?M:M.nextChild(i<0?b.children.length-1:0,i,n,s)}}}if(h&$t.IncludeAnonymous||!u.type.isAnonymous||(u.index>=0?t=u.index+i:t=i<0?-1:u._parent._tree.children.length,u=u._parent,!u))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,i,n=0){let s;if(!(n&$t.IgnoreOverlays)&&(s=uo.get(this._tree))&&s.overlay){let h=t-this.from;for(let{from:u,to:d}of s.overlay)if((i>0?u<=h:u<h)&&(i<0?d>=h:d>h))return new Re(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,i,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Qu(f,t,i,n){let s=f.cursor(),h=[];if(!s.firstChild())return h;if(i!=null){for(let u=!1;!u;)if(u=s.type.is(i),!s.nextSibling())return h}for(;;){if(n!=null&&s.type.is(n))return h;if(s.type.is(t)&&h.push(s.node),!s.nextSibling())return n==null?h:[]}}function La(f,t,i=t.length-1){for(let n=f.parent;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[i]&&t[i]!=n.name)return!1;i--}}return!0}class gv{constructor(t,i,n,s){this.parent=t,this.buffer=i,this.index=n,this.start=s}}class Bi extends Ld{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,i,n){super(),this.context=t,this._parent=i,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,i,n){let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.context.start,n);return h<0?null:new Bi(this.context,this,h)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,i,n=0){if(n&$t.ExcludeBuffers)return null;let{buffer:s}=this.context,h=s.findChild(this.index+4,s.buffer[this.index+3],i>0?1:-1,t-this.context.start,i);return h<0?null:new Bi(this.context,this,h)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,i=t.buffer[this.index+3];return i<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Bi(this.context,this._parent,i):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,i=this._parent?this._parent.index+4:0;return this.index==i?this.externalSibling(-1):new Bi(this.context,this._parent,t.findChild(i,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],i=[],{buffer:n}=this.context,s=this.index+4,h=n.buffer[this.index+3];if(h>s){let u=n.buffer[this.index+1];t.push(n.slice(s,h,u)),i.push(0)}return new ae(this.type,t,i,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Od(f){if(!f.length)return null;let t=0,i=f[0];for(let h=1;h<f.length;h++){let u=f[h];(u.from>i.from||u.to<i.to)&&(i=u,t=h)}let n=i instanceof Re&&i.index<0?null:i.parent,s=f.slice();return n?s[t]=n:s.splice(t,1),new mv(s,i)}class mv{constructor(t,i){this.heads=t,this.node=i}get next(){return Od(this.heads)}}function vv(f,t,i){let n=f.resolveInner(t,i),s=null;for(let h=n instanceof Re?n:n.context.parent;h;h=h.parent)if(h.index<0){let u=h.parent;(s||(s=[n])).push(u.resolve(t,i)),h=u}else{let u=uo.get(h.tree);if(u&&u.overlay&&u.overlay[0].from<=t&&u.overlay[u.overlay.length-1].to>=t){let d=new Re(u.tree,u.overlay[0].from+h.from,-1,h);(s||(s=[n])).push(Xn(d,t,i,!1))}}return s?Od(s):n}class Oa{get name(){return this.type.name}constructor(t,i=0){if(this.mode=i,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Re)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let n=t._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,i){this.index=t;let{start:n,buffer:s}=this.buffer;return this.type=i||s.set.types[s.buffer[t]],this.from=n+s.buffer[t+1],this.to=n+s.buffer[t+2],!0}yield(t){return t?t instanceof Re?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,i,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,i,n,this.mode));let{buffer:s}=this.buffer,h=s.findChild(this.index+4,s.buffer[this.index+3],t,i-this.buffer.start,n);return h<0?!1:(this.stack.push(this.index),this.yieldBuf(h))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,i,n=this.mode){return this.buffer?n&$t.ExcludeBuffers?!1:this.enterChild(1,t,i):this.yield(this._tree.enter(t,i,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$t.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&$t.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:i}=this.buffer,n=this.stack.length-1;if(t<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(i.findChild(s,this.index,-1,0,4))}else{let s=i.buffer[this.index+3];if(s<(n<0?i.buffer.length:i.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let i,n,{buffer:s}=this;if(s){if(t>0){if(this.index<s.buffer.buffer.length)return!1}else for(let h=0;h<this.index;h++)if(s.buffer.buffer[h+3]<this.index)return!1;({index:i,parent:n}=s)}else({index:i,_parent:n}=this._tree);for(;n;{index:i,_parent:n}=n)if(i>-1)for(let h=i+t,u=t<0?-1:n._tree.children.length;h!=u;h+=t){let d=n._tree.children[h];if(this.mode&$t.IncludeAnonymous||d instanceof Wi||!d.type.isAnonymous||Va(d))return!1}return!0}move(t,i){if(i&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,i=0){for(;(this.from==this.to||(i<1?this.from>=t:this.from>t)||(i>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,i););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,i=null,n=0;if(t&&t.context==this.buffer)t:for(let s=this.index,h=this.stack.length;h>=0;){for(let u=t;u;u=u._parent)if(u.index==s){if(s==this.index)return u;i=u,n=h+1;break t}s=this.stack[--h]}for(let s=n;s<this.stack.length;s++)i=new Bi(this.buffer,i,this.stack[s]);return this.bufferNode=new Bi(this.buffer,i,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,i){for(let n=0;;){let s=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;s&&i&&i(this),s=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,s=!0}}}matchContext(t){if(!this.buffer)return La(this.node,t);let{buffer:i}=this.buffer,{types:n}=i.set;for(let s=t.length-1,h=this.stack.length-1;s>=0;h--){if(h<0)return La(this.node,t,s);let u=n[i.buffer[this.stack[h]]];if(!u.isAnonymous){if(t[s]&&t[s]!=u.name)return!1;s--}}return!0}}function Va(f){return f.children.some(t=>t instanceof Wi||!t.type.isAnonymous||Va(t))}function yv(f){var t;let{buffer:i,nodeSet:n,maxBufferLength:s=cv,reused:h=[],minRepeatType:u=n.types.length}=f,d=Array.isArray(i)?new Ga(i,i.length):i,p=n.types,v=0,b=0;function x(V,st,Q,pt,yt,at){let{id:nt,start:it,end:ct,size:lt}=d,U=b;for(;lt<0;)if(d.next(),lt==-1){let Xt=h[nt];Q.push(Xt),pt.push(it-V);return}else if(lt==-3){v=nt;return}else if(lt==-4){b=nt;return}else throw new RangeError(`Unrecognized record size: ${lt}`);let ye=p[nt],be,te,he=it-V;if(ct-it<=s&&(te=N(d.pos-st,yt))){let Xt=new Uint16Array(te.size-te.skip),ee=d.pos-te.size,ie=Xt.length;for(;d.pos>ee;)ie=P(te.start,Xt,ie);be=new Wi(Xt,ct-te.start,n),he=te.start-V}else{let Xt=d.pos-lt;d.next();let ee=[],ie=[],ke=nt>=u?nt:-1,Ce=0,De=ct;for(;d.pos>Xt;)ke>=0&&d.id==ke&&d.size>=0?(d.end<=De-s&&(A(ee,ie,it,Ce,d.end,De,ke,U),Ce=ee.length,De=d.end),d.next()):at>2500?S(it,Xt,ee,ie):x(it,Xt,ee,ie,ke,at+1);if(ke>=0&&Ce>0&&Ce<ee.length&&A(ee,ie,it,Ce,it,De,ke,U),ee.reverse(),ie.reverse(),ke>-1&&Ce>0){let Fi=M(ye);be=qa(ye,ee,ie,0,ee.length,0,ct-it,Fi,Fi)}else be=D(ye,ee,ie,ct-it,U-ct)}Q.push(be),pt.push(he)}function S(V,st,Q,pt){let yt=[],at=0,nt=-1;for(;d.pos>st;){let{id:it,start:ct,end:lt,size:U}=d;if(U>4)d.next();else{if(nt>-1&&ct<nt)break;nt<0&&(nt=lt-s),yt.push(it,ct,lt),at++,d.next()}}if(at){let it=new Uint16Array(at*4),ct=yt[yt.length-2];for(let lt=yt.length-3,U=0;lt>=0;lt-=3)it[U++]=yt[lt],it[U++]=yt[lt+1]-ct,it[U++]=yt[lt+2]-ct,it[U++]=U;Q.push(new Wi(it,yt[2]-ct,n)),pt.push(ct-V)}}function M(V){return(st,Q,pt)=>{let yt=0,at=st.length-1,nt,it;if(at>=0&&(nt=st[at])instanceof ae){if(!at&&nt.type==V&&nt.length==pt)return nt;(it=nt.prop(kt.lookAhead))&&(yt=Q[at]+nt.length+it)}return D(V,st,Q,pt,yt)}}function A(V,st,Q,pt,yt,at,nt,it){let ct=[],lt=[];for(;V.length>pt;)ct.push(V.pop()),lt.push(st.pop()+Q-yt);V.push(D(n.types[nt],ct,lt,at-yt,it-at)),st.push(yt-Q)}function D(V,st,Q,pt,yt=0,at){if(v){let nt=[kt.contextHash,v];at=at?[nt].concat(at):[nt]}if(yt>25){let nt=[kt.lookAhead,yt];at=at?[nt].concat(at):[nt]}return new ae(V,st,Q,pt,at)}function N(V,st){let Q=d.fork(),pt=0,yt=0,at=0,nt=Q.end-s,it={size:0,start:0,skip:0};t:for(let ct=Q.pos-V;Q.pos>ct;){let lt=Q.size;if(Q.id==st&&lt>=0){it.size=pt,it.start=yt,it.skip=at,at+=4,pt+=4,Q.next();continue}let U=Q.pos-lt;if(lt<0||U<ct||Q.start<nt)break;let ye=Q.id>=u?4:0,be=Q.start;for(Q.next();Q.pos>U;){if(Q.size<0)if(Q.size==-3)ye+=4;else break t;else Q.id>=u&&(ye+=4);Q.next()}yt=be,pt+=lt,at+=ye}return(st<0||pt==V)&&(it.size=pt,it.start=yt,it.skip=at),it.size>4?it:void 0}function P(V,st,Q){let{id:pt,start:yt,end:at,size:nt}=d;if(d.next(),nt>=0&&pt<u){let it=Q;if(nt>4){let ct=d.pos-(nt-4);for(;d.pos>ct;)Q=P(V,st,Q)}st[--Q]=it,st[--Q]=at-V,st[--Q]=yt-V,st[--Q]=pt}else nt==-3?v=pt:nt==-4&&(b=pt);return Q}let W=[],_=[];for(;d.pos>0;)x(f.start||0,f.bufferStart||0,W,_,-1,0);let Y=(t=f.length)!==null&&t!==void 0?t:W.length?_[0]+W[0].length:0;return new ae(p[f.topID],W.reverse(),_.reverse(),Y)}const $u=new WeakMap;function ro(f,t){if(!f.isAnonymous||t instanceof Wi||t.type!=f)return 1;let i=$u.get(t);if(i==null){i=1;for(let n of t.children){if(n.type!=f||!(n instanceof ae)){i=1;break}i+=ro(f,n)}$u.set(t,i)}return i}function qa(f,t,i,n,s,h,u,d,p){let v=0;for(let A=n;A<s;A++)v+=ro(f,t[A]);let b=Math.ceil(v*1.5/8),x=[],S=[];function M(A,D,N,P,W){for(let _=N;_<P;){let Y=_,V=D[_],st=ro(f,A[_]);for(_++;_<P;_++){let Q=ro(f,A[_]);if(st+Q>=b)break;st+=Q}if(_==Y+1){if(st>b){let Q=A[Y];M(Q.children,Q.positions,0,Q.children.length,D[Y]+W);continue}x.push(A[Y])}else{let Q=D[_-1]+A[_-1].length-V;x.push(qa(f,A,D,Y,_,V,Q,null,p))}S.push(V+W-h)}}return M(t,i,n,s,0),(d||p)(x,S,u)}class sr{constructor(t,i,n,s,h=!1,u=!1){this.from=t,this.to=i,this.tree=n,this.offset=s,this.open=(h?1:0)|(u?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,i=[],n=!1){let s=[new sr(0,t.length,t,0,!1,n)];for(let h of i)h.to>t.length&&s.push(h);return s}static applyChanges(t,i,n=128){if(!i.length)return t;let s=[],h=1,u=t.length?t[0]:null;for(let d=0,p=0,v=0;;d++){let b=d<i.length?i[d]:null,x=b?b.fromA:1e9;if(x-p>=n)for(;u&&u.from<x;){let S=u;if(p>=S.from||x<=S.to||v){let M=Math.max(S.from,p)-v,A=Math.min(S.to,x)-v;S=M>=A?null:new sr(M,A,S.tree,S.offset+v,d>0,!!b)}if(S&&s.push(S),u.to>x)break;u=h<t.length?t[h++]:null}if(!b)break;p=b.toA,v=b.toA-b.toB}return s}}class bv{startParse(t,i,n){return typeof t=="string"&&(t=new wv(t)),n=n?n.length?n.map(s=>new Vl(s.from,s.to)):[new Vl(0,0)]:[new Vl(0,t.length)],this.createParse(t,i||[],n)}parse(t,i,n){let s=this.startParse(t,i,n);for(;;){let h=s.advance();if(h)return h}}}class wv{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,i){return this.string.slice(t,i)}}new kt({perNode:!0});let xv=0;class $e{constructor(t,i,n){this.set=t,this.base=i,this.modified=n,this.id=xv++}static define(t){if(t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new $e([],null,[]);if(i.set.push(i),t)for(let n of t.set)i.set.push(n);return i}static defineModifier(){let t=new co;return i=>i.modified.indexOf(t)>-1?i:co.get(i.base||i,i.modified.concat(t).sort((n,s)=>n.id-s.id))}}let Sv=0;class co{constructor(){this.instances=[],this.id=Sv++}static get(t,i){if(!i.length)return t;let n=i[0].instances.find(d=>d.base==t&&kv(i,d.modified));if(n)return n;let s=[],h=new $e(s,t,i);for(let d of i)d.instances.push(h);let u=Cv(i);for(let d of t.set)if(!d.modified.length)for(let p of u)s.push(co.get(d,p));return h}}function kv(f,t){return f.length==t.length&&f.every((i,n)=>i==t[n])}function Cv(f){let t=[[]];for(let i=0;i<f.length;i++)for(let n=0,s=t.length;n<s;n++)t.push(t[n].concat(f[i]));return t.sort((i,n)=>n.length-i.length)}function Mv(f){let t=Object.create(null);for(let i in f){let n=f[i];Array.isArray(n)||(n=[n]);for(let s of i.split(" "))if(s){let h=[],u=2,d=s;for(let x=0;;){if(d=="..."&&x>0&&x+3==s.length){u=1;break}let S=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!S)throw new RangeError("Invalid path: "+s);if(h.push(S[0]=="*"?"":S[0][0]=='"'?JSON.parse(S[0]):S[0]),x+=S[0].length,x==s.length)break;let M=s[x++];if(x==s.length&&M=="!"){u=0;break}if(M!="/")throw new RangeError("Invalid path: "+s);d=s.slice(x)}let p=h.length-1,v=h[p];if(!v)throw new RangeError("Invalid path: "+s);let b=new Da(n,u,p>0?h.slice(0,p):null);t[v]=b.sort(t[v])}}return Av.add(t)}const Av=new kt;class Da{constructor(t,i,n,s){this.tags=t,this.mode=i,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Da.empty=new Da([],2,null);function Tv(f,t){let i=Object.create(null);for(let h of f)if(!Array.isArray(h.tag))i[h.tag.id]=h.class;else for(let u of h.tag)i[u.id]=h.class;let{scope:n,all:s=null}=t||{};return{style:h=>{let u=s;for(let d of h)for(let p of d.set){let v=i[p.id];if(v){u=u?u+" "+v:v;break}}return u},scope:n}}const z=$e.define,Ys=z(),Li=z(),tc=z(Li),ec=z(Li),Oi=z(),Xs=z(Oi),ql=z(Oi),Qe=z(),tr=z(Qe),Je=z(),Ze=z(),Na=z(),Nn=z(Na),_s=z(),ot={comment:Ys,lineComment:z(Ys),blockComment:z(Ys),docComment:z(Ys),name:Li,variableName:z(Li),typeName:tc,tagName:z(tc),propertyName:ec,attributeName:z(ec),className:z(Li),labelName:z(Li),namespace:z(Li),macroName:z(Li),literal:Oi,string:Xs,docString:z(Xs),character:z(Xs),attributeValue:z(Xs),number:ql,integer:z(ql),float:z(ql),bool:z(Oi),regexp:z(Oi),escape:z(Oi),color:z(Oi),url:z(Oi),keyword:Je,self:z(Je),null:z(Je),atom:z(Je),unit:z(Je),modifier:z(Je),operatorKeyword:z(Je),controlKeyword:z(Je),definitionKeyword:z(Je),moduleKeyword:z(Je),operator:Ze,derefOperator:z(Ze),arithmeticOperator:z(Ze),logicOperator:z(Ze),bitwiseOperator:z(Ze),compareOperator:z(Ze),updateOperator:z(Ze),definitionOperator:z(Ze),typeOperator:z(Ze),controlOperator:z(Ze),punctuation:Na,separator:z(Na),bracket:Nn,angleBracket:z(Nn),squareBracket:z(Nn),paren:z(Nn),brace:z(Nn),content:Qe,heading:tr,heading1:z(tr),heading2:z(tr),heading3:z(tr),heading4:z(tr),heading5:z(tr),heading6:z(tr),contentSeparator:z(Qe),list:z(Qe),quote:z(Qe),emphasis:z(Qe),strong:z(Qe),link:z(Qe),monospace:z(Qe),strikethrough:z(Qe),inserted:z(),deleted:z(),changed:z(),invalid:z(),meta:_s,documentMeta:z(_s),annotation:z(_s),processingInstruction:z(_s),definition:$e.defineModifier(),constant:$e.defineModifier(),function:$e.defineModifier(),standard:$e.defineModifier(),local:$e.defineModifier(),special:$e.defineModifier()};Tv([{tag:ot.link,class:"tok-link"},{tag:ot.heading,class:"tok-heading"},{tag:ot.emphasis,class:"tok-emphasis"},{tag:ot.strong,class:"tok-strong"},{tag:ot.keyword,class:"tok-keyword"},{tag:ot.atom,class:"tok-atom"},{tag:ot.bool,class:"tok-bool"},{tag:ot.url,class:"tok-url"},{tag:ot.labelName,class:"tok-labelName"},{tag:ot.inserted,class:"tok-inserted"},{tag:ot.deleted,class:"tok-deleted"},{tag:ot.literal,class:"tok-literal"},{tag:ot.string,class:"tok-string"},{tag:ot.number,class:"tok-number"},{tag:[ot.regexp,ot.escape,ot.special(ot.string)],class:"tok-string2"},{tag:ot.variableName,class:"tok-variableName"},{tag:ot.local(ot.variableName),class:"tok-variableName tok-local"},{tag:ot.definition(ot.variableName),class:"tok-variableName tok-definition"},{tag:ot.special(ot.variableName),class:"tok-variableName2"},{tag:ot.definition(ot.propertyName),class:"tok-propertyName tok-definition"},{tag:ot.typeName,class:"tok-typeName"},{tag:ot.namespace,class:"tok-namespace"},{tag:ot.className,class:"tok-className"},{tag:ot.macroName,class:"tok-macroName"},{tag:ot.propertyName,class:"tok-propertyName"},{tag:ot.operator,class:"tok-operator"},{tag:ot.comment,class:"tok-comment"},{tag:ot.meta,class:"tok-meta"},{tag:ot.invalid,class:"tok-invalid"},{tag:ot.punctuation,class:"tok-punctuation"}]);var Yl;const In=new kt;function Lv(f){return et.define({combine:f?t=>t.concat(f):void 0})}const Ov=new kt;class ni{constructor(t,i,n=[],s=""){this.data=t,this.name=s,ut.prototype.hasOwnProperty("tree")||Object.defineProperty(ut.prototype,"tree",{get(){return Ea(this)}}),this.parser=i,this.extension=[Xr.of(this),ut.languageData.of((h,u,d)=>{let p=ic(h,u,d),v=p.type.prop(In);if(!v)return[];let b=h.facet(v),x=p.type.prop(Ov);if(x){let S=p.resolve(u-p.from,d);for(let M of x)if(M.test(S,h)){let A=h.facet(M.facet);return M.type=="replace"?A:A.concat(b)}}return b})].concat(n)}isActiveAt(t,i,n=-1){return ic(t,i,n).type.prop(In)==this.data}findRegions(t){let i=t.facet(Xr);if((i==null?void 0:i.data)==this.data)return[{from:0,to:t.doc.length}];if(!i||!i.allowsNesting)return[];let n=[],s=(h,u)=>{if(h.prop(In)==this.data){n.push({from:u,to:u+h.length});return}let d=h.prop(kt.mounted);if(d){if(d.tree.prop(In)==this.data){if(d.overlay)for(let p of d.overlay)n.push({from:p.from+u,to:p.to+u});else n.push({from:u,to:u+h.length});return}else if(d.overlay){let p=n.length;if(s(d.tree,d.overlay[0].from+u),n.length>p)return}}for(let p=0;p<h.children.length;p++){let v=h.children[p];v instanceof ae&&s(v,h.positions[p]+u)}};return s(Ea(t),0),n}get allowsNesting(){return!0}}ni.setState=Ht.define();function ic(f,t,i){let n=f.facet(Xr),s=Ea(f).topNode;if(!n||n.allowsNesting)for(let h=s;h;h=h.enter(t,i,$t.ExcludeBuffers))h.type.isTop&&(s=h);return s}class Pa extends ni{constructor(t,i,n){super(t,i,[],n),this.parser=i}static define(t){let i=Lv(t.languageData);return new Pa(i,t.parser.configure({props:[In.add(n=>n.isTop?i:void 0)]}),t.name)}configure(t,i){return new Pa(this.data,this.parser.configure(t),i||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ea(f){let t=f.field(ni.state,!1);return t?t.tree:ae.empty}class Dv{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,i){let n=this.cursorPos-this.string.length;return t<n||i>=this.cursorPos?this.doc.sliceString(t,i):this.string.slice(t-n,i-n)}}let Pn=null;class po{constructor(t,i,n=[],s,h,u,d,p){this.parser=t,this.state=i,this.fragments=n,this.tree=s,this.treeLen=h,this.viewport=u,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(t,i,n){return new po(t,i,[],ae.empty,0,n,[],null)}startParse(){return this.parser.startParse(new Dv(this.state.doc),this.fragments)}work(t,i){return i!=null&&i>=this.state.doc.length&&(i=void 0),this.tree!=ae.empty&&this.isDone(i??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof t=="number"){let s=Date.now()+t;t=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),i!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>i)&&i<this.state.doc.length&&this.parse.stopAt(i);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(sr.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(i??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,i;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(i=this.parse.advance()););}),this.treeLen=t,this.tree=i,this.fragments=this.withoutTempSkipped(sr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let i=Pn;Pn=this;try{return t()}finally{Pn=i}}withoutTempSkipped(t){for(let i;i=this.tempSkipped.pop();)t=rc(t,i.from,i.to);return t}changes(t,i){let{fragments:n,tree:s,treeLen:h,viewport:u,skipped:d}=this;if(this.takeTree(),!t.empty){let p=[];if(t.iterChangedRanges((v,b,x,S)=>p.push({fromA:v,toA:b,fromB:x,toB:S})),n=sr.applyChanges(n,p),s=ae.empty,h=0,u={from:t.mapPos(u.from,-1),to:t.mapPos(u.to,1)},this.skipped.length){d=[];for(let v of this.skipped){let b=t.mapPos(v.from,1),x=t.mapPos(v.to,-1);b<x&&d.push({from:b,to:x})}}}return new po(this.parser,i,n,s,h,u,d,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let i=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:h}=this.skipped[n];s<t.to&&h>t.from&&(this.fragments=rc(this.fragments,s,h),this.skipped.splice(n--,1))}return this.skipped.length>=i?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,i){this.skipped.push({from:t,to:i})}static getSkippingParser(t){return new class extends bv{createParse(i,n,s){let h=s[0].from,u=s[s.length-1].to;return{parsedPos:h,advance(){let p=Pn;if(p){for(let v of s)p.tempSkipped.push(v);t&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,t]):t)}return this.parsedPos=u,new ae(Oe.none,[],[],u-h)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let i=this.fragments;return this.treeLen>=t&&i.length&&i[0].from==0&&i[0].to>=t}static get(){return Pn}}function rc(f,t,i){return sr.applyChanges(f,[{fromA:t,toA:i,fromB:t,toB:i}])}class Yr{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let i=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),i.viewport.to);return i.work(20,n)||i.takeTree(),new Yr(i)}static init(t){let i=Math.min(3e3,t.doc.length),n=po.create(t.facet(Xr).parser,t,{from:0,to:i});return n.work(20,i)||n.takeTree(),new Yr(n)}}ni.state=fr.define({create:Yr.init,update(f,t){for(let i of t.effects)if(i.is(ni.setState))return i.value;return t.startState.facet(Xr)!=t.state.facet(Xr)?Yr.init(t.state):f.apply(t)}});let Dd=f=>{let t=setTimeout(()=>f(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Dd=f=>{let t=-1,i=setTimeout(()=>{t=requestIdleCallback(f,{timeout:500-100})},100);return()=>t<0?clearTimeout(i):cancelIdleCallback(t)});const Xl=typeof navigator<"u"&&(!((Yl=navigator.scheduling)===null||Yl===void 0)&&Yl.isInputPending)?()=>navigator.scheduling.isInputPending():null,Nv=Ii.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let i=this.view.state.field(ni.state).context;(i.updateViewport(t.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}scheduleWork(){if(this.working)return;let{state:t}=this.view,i=t.field(ni.state);(i.tree!=i.context.tree||!i.context.isDone(t.doc.length))&&(this.working=Dd(this.work))}work(t){this.working=null;let i=Date.now();if(this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,h=n.field(ni.state);if(h.tree==h.context.tree&&h.context.isDone(s+1e5))return;let u=Date.now()+Math.min(this.chunkBudget,100,t&&!Xl?Math.max(25,t.timeRemaining()-5):1e9),d=h.context.treeLen<s&&n.doc.length>s+1e3,p=h.context.work(()=>Xl&&Xl()||Date.now()>u,s+(d?0:1e5));this.chunkBudget-=Date.now()-i,(p||this.chunkBudget<=0)&&(h.context.takeTree(),this.view.dispatch({effects:ni.setState.of(new Yr(h.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(h.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(i=>ri(this.view.state,i)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Xr=et.define({combine(f){return f.length?f[0]:null},enables:f=>[ni.state,Nv,ht.contentAttributes.compute([f],t=>{let i=t.facet(f);return i&&i.name?{"data-language":i.name}:{}})]});class Qv{constructor(t,i=[]){this.language=t,this.support=i,this.extension=[t,i]}}const yo=et.define({combine:f=>{if(!f.length)return"  ";let t=f[0];if(!t||/\S/.test(t)||Array.from(t).some(i=>i!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(f[0]));return t}});function Pv(f){let t=f.facet(yo);return t.charCodeAt(0)==9?f.tabSize*t.length:t.length}function Ev(f,t){let i="",n=f.tabSize,s=f.facet(yo)[0];if(s=="	"){for(;t>=n;)i+="	",t-=n;s=" "}for(let h=0;h<t;h++)i+=s;return i}const $v=new kt;function ty({except:f,units:t=1}={}){return i=>{let n=f&&f.test(i.textAfter);return i.baseIndent+(n?0:t*i.unit)}}const ey=new kt;function iy(f){let t=f.firstChild,i=f.lastChild;return t&&t.to<i.from?{from:t.to,to:i.type.isError?f.to:i.from}:null}const Bv=Object.create(null),nc=[Oe.none],sc=[],oc=Object.create(null),Rv=Object.create(null);for(let[f,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Rv[f]=Hv(Bv,t);function _l(f,t){sc.indexOf(f)>-1||(sc.push(f),console.warn(t))}function Hv(f,t){let i=[];for(let d of t.split(" ")){let p=[];for(let v of d.split(".")){let b=f[v]||ot[v];b?typeof b=="function"?p.length?p=p.map(b):_l(v,`Modifier ${v} used at start of tag`):p.length?_l(v,`Tag ${v} used as modifier`):p=Array.isArray(b)?b:[b]:_l(v,`Unknown highlighting tag ${v}`)}for(let v of p)i.push(v)}if(!i.length)return 0;let n=t.replace(/ /g,"_"),s=n+" "+i.map(d=>d.id),h=oc[s];if(h)return h.id;let u=oc[s]=Oe.define({id:nc.length,name:n,props:[Mv({[n]:i})]});return nc.push(u),u.id}Yt.RTL,Yt.LTR;function Nd(f,t){let i=-1;return f.changeByRange(n=>{let s=[];for(let u=n.from;u<=n.to;){let d=f.doc.lineAt(u);d.number>i&&(n.empty||n.to>d.from)&&(t(d,s,n),i=d.number),u=d.to+1}let h=f.changes(s);return{changes:s,range:j.range(h.mapPos(n.anchor,1),h.mapPos(n.head,1))}})}const Iv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Nd(f,(i,n)=>{n.push({from:i.from,insert:f.facet(yo)})}),{userEvent:"input.indent"})),!0),Wv=({state:f,dispatch:t})=>f.readOnly?!1:(t(f.update(Nd(f,(i,n)=>{let s=/^\s*/.exec(i.text)[0];if(!s)return;let h=y0(s,f.tabSize),u=0,d=Ev(f,Math.max(0,h-Pv(f)));for(;u<s.length&&u<d.length&&s.charCodeAt(u)==d.charCodeAt(u);)u++;n.push({from:i.from+u,to:i.from+s.length,insert:d.slice(u)})}),{userEvent:"delete.dedent"})),!0),Fv={key:"Tab",run:Iv,shift:Wv};/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var zv=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[t0.basicSetup]}),Kv=Symbol("vue-codemirror-global-config"),me,Uv=function(f){var t=f.onUpdate,i=f.onChange,n=f.onFocus,s=f.onBlur,h=function(u,d){var p={};for(var v in u)Object.prototype.hasOwnProperty.call(u,v)&&d.indexOf(v)<0&&(p[v]=u[v]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var b=0;for(v=Object.getOwnPropertySymbols(u);b<v.length;b++)d.indexOf(v[b])<0&&Object.prototype.propertyIsEnumerable.call(u,v[b])&&(p[v[b]]=u[v[b]])}return p}(f,["onUpdate","onChange","onFocus","onBlur"]);return ut.create({doc:h.doc,selection:h.selection,extensions:(Array.isArray(h.extensions)?h.extensions:[h.extensions]).concat([ht.updateListener.of(function(u){t(u),u.docChanged&&i(u.state.doc.toString(),u),u.focusChanged&&(u.view.hasFocus?n(u):s(u))})])})},Br=function(f){var t=new _n;return{compartment:t,run:function(i){t.get(f.state)?f.dispatch({effects:t.reconfigure(i)}):f.dispatch({effects:Ht.appendConfig.of(t.of(i))})}}},lc=function(f,t){var i=Br(f),n=i.compartment,s=i.run;return function(h){var u=n.get(f.state);s(h??u!==t?t:[])}},js={type:Boolean,default:void 0},Gv={autofocus:js,disabled:js,indentWithTab:js,tabSize:Number,placeholder:String,style:Object,autoDestroy:js,phrases:Object,root:Object,extensions:Array,selection:Object},Vv={modelValue:{type:String,default:""}},qv=Object.assign(Object.assign({},Gv),Vv);(function(f){f.Change="change",f.Update="update",f.Focus="focus",f.Blur="blur",f.Ready="ready",f.ModelUpdate="update:modelValue"})(me||(me={}));var ir={};ir[me.Change]=function(f,t){return!0},ir[me.Update]=function(f){return!0},ir[me.Focus]=function(f){return!0},ir[me.Blur]=function(f){return!0},ir[me.Ready]=function(f){return!0};var Pd={};Pd[me.ModelUpdate]=ir[me.Change];var Yv=Object.assign(Object.assign({},ir),Pd),Xv=Xg({name:"VueCodemirror",props:Object.assign({},qv),emits:Object.assign({},Yv),setup:function(f,t){var i=Pl(),n=Pl(),s=Pl(),h=Object.assign(Object.assign({},zv),_g(Kv,{})),u=jg(function(){var d={};return Object.keys($g(f)).forEach(function(p){var v;p!=="modelValue"&&(d[p]=(v=f[p])!==null&&v!==void 0?v:h[p])}),d});return Jg(function(){var d;n.value=Uv({doc:f.modelValue,selection:u.value.selection,extensions:(d=h.extensions)!==null&&d!==void 0?d:[],onFocus:function(v){return t.emit(me.Focus,v)},onBlur:function(v){return t.emit(me.Blur,v)},onUpdate:function(v){return t.emit(me.Update,v)},onChange:function(v,b){v!==f.modelValue&&(t.emit(me.Change,v,b),t.emit(me.ModelUpdate,v,b))}}),s.value=function(v){return new ht(Object.assign({},v))}({state:n.value,parent:i.value,root:u.value.root});var p=function(v){var b=function(){return v.state.doc.toString()},x=Br(v).run,S=lc(v,[ht.editable.of(!1),ut.readOnly.of(!0)]),M=lc(v,Cd.of([Fv])),A=Br(v).run,D=Br(v).run,N=Br(v).run,P=Br(v).run;return{focus:function(){return v.focus()},getDoc:b,setDoc:function(W){W!==b()&&v.dispatch({changes:{from:0,to:v.state.doc.length,insert:W}})},reExtensions:x,toggleDisabled:S,toggleIndentWithTab:M,setTabSize:function(W){A([ut.tabSize.of(W),yo.of(" ".repeat(W))])},setPhrases:function(W){D([ut.phrases.of(W)])},setPlaceholder:function(W){N(sv(W))},setStyle:function(W){W===void 0&&(W={}),P(ht.theme({"&":Object.assign({},W)}))}}}(s.value);Ti(function(){return f.modelValue},function(v){v!==p.getDoc()&&p.setDoc(v)}),Ti(function(){return f.extensions},function(v){return p.reExtensions(v||[])},{immediate:!0}),Ti(function(){return u.value.disabled},function(v){return p.toggleDisabled(v)},{immediate:!0}),Ti(function(){return u.value.indentWithTab},function(v){return p.toggleIndentWithTab(v)},{immediate:!0}),Ti(function(){return u.value.tabSize},function(v){return p.setTabSize(v)},{immediate:!0}),Ti(function(){return u.value.phrases},function(v){return p.setPhrases(v||{})},{immediate:!0}),Ti(function(){return u.value.placeholder},function(v){return p.setPlaceholder(v)},{immediate:!0}),Ti(function(){return u.value.style},function(v){return p.setStyle(v)},{immediate:!0}),u.value.autofocus&&p.focus(),t.emit(me.Ready,{state:n.value,view:s.value,container:i.value})}),Zg(function(){u.value.autoDestroy&&s.value&&function(d){d.destroy()}(s.value)}),function(){return Qg("div",{class:"v-codemirror",style:{display:"contents"},ref:i})}}}),ry=Xv;export{cv as D,$t as I,Qv as L,Ad as N,bv as P,ae as T,Oe as a,kt as b,Pa as c,ty as d,iy as e,ey as f,ry as g,$v as i,Jv as l,Mv as s,ot as t};
