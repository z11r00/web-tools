import{t as j,i as oe,S as G,a as se,r as ne,u as ie}from"./xlsx-20bc10ae.js";import{D as ue}from"./DetailHeader-47695dd5.js";import{d as de,l as re,M as n,o as ce,r as d,b as me,c as ve,h as t,f as i,w as a,i as o,O as fe,p as pe,k as _e,_ as xe}from"./index-17477c0a.js";const he=y=>(pe("data-v-39314dfb"),y=y(),_e(),y),we={class:"flex flex-col mt-3 flex-1"},ge={class:"p-4 rounded-2xl flex"},be={class:"w-4/6"},Ve={class:"flex flex-row-reverse mb-4"},Ce=he(()=>i("div",{class:"flex justify-center items-center max-h-[500px] max-w-[1000px] overflow-auto"},[i("div",{id:"main",class:"bg-white"})],-1)),ke={class:"w-2/6 bg-white ml-3 rounded-lg p-3"},ye={class:"mb-3"},Se={class:"flex items-center ml-1"},Ue={class:"flex w-full"},De={class:"flex"},Te={class:"flex mt-3"},$e={class:"flex"},ze={class:"flex"},Be={class:"flex"},Ee={class:"flex"},Ae={class:"flex"},Fe={class:"flex"},Ie={class:"flex"},Oe={class:"flex"},Re=de({__name:"Line",setup(y){const q=re({title:"折线图"}),E=n(),m=n(),S=n(),W=n(1),A=n(100),U=n(720),D=n(400),F=n("1"),T=n("#5470c6"),$=n("center"),z=n("Tools-Web"),B=n("在线图表制作工具"),I=n(!0),O=n(!0),R=n(!1),L=n("Tools-Web"),J=()=>{let u=document.createElement("canvas"),e=u.getContext("2d");return u.width=u.height=100,e.textAlign="center",e.textBaseline="middle",e.globalAlpha=.08,e.font="20px Microsoft Yahei",e.translate(50,50),e.rotate(-Math.PI/4),e.fillText(L.value,0,0),u},r=u=>{var c,s,v,p,_;let e=E.value;switch(u){case"scale":let b=A.value/100;e.style.transform=`scale(${b})`;break;case"size":e.style.width=U.value+"px",e.style.height=D.value+"px",H();break;case"title":let h="",f="";I.value===!0&&(h=z.value),O.value===!0&&(f=B.value),(c=m.value)==null||c.setOption({title:{text:h,subtext:f,left:$.value}});break;case"color":(s=m.value)==null||s.setOption({series:[{itemStyle:{color:T.value}}]});break;case"watermark":R.value===!0?(v=m.value)==null||v.setOption({backgroundColor:{image:J()}}):(p=m.value)==null||p.setOption({backgroundColor:"#fff"});break;case"data":(_=m.value)==null||_.setOption({xAxis:{data:w.value},series:[{data:g.value}]});break}},Y=()=>{},w=n(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),g=n(["23","24","18","25","27","28","25"]),K={backgroundColor:"#fff",title:{text:z.value,subtext:B.value,left:$.value},xAxis:{data:w.value},yAxis:{},series:[{type:"line",data:g.value,itemStyle:{color:T.value}}],tooltip:{}},H=()=>{m.value=oe(E.value),m.value.clear(),m.value.resize({width:U.value,height:D.value}),m.value.setOption(K)},Q=()=>{var s;let u=F.value=="1"?"png":"jpeg",e=(s=m.value)==null?void 0:s.getDataURL({type:u,pixelRatio:2});if(e!=null){var c=document.createElement("a");c.href=e,c.download="echart."+u,c.click()}},k=n(!1),M=n({}),X=()=>{k.value==!0?k.value=!1:(k.value=!0,G.locale("zh-cn",window.x_spreadsheet.$messages["zh-cn"]),new G("#x-spreadsheet",{showToolbar:!1,showBottomBar:!1,view:{height:()=>document.documentElement.clientHeight/2,width:()=>document.documentElement.clientWidth}}).loadData({styles:[{bgcolor:"#f4f5f8",textwrap:!0,color:"#900b09",border:{top:["thin","#0366d6"],bottom:["thin","#0366d6"],right:["thin","#0366d6"],left:["thin","#0366d6"]}}],rows:M.value}).change(u=>{let e=se(u);w.value=e[0],g.value=e[1],r("data")}))},P=n(),Z=async u=>{const e=u.file,c=new FileReader;c.onload=s=>{try{if(!s.target)return;const v=s.target.result,p=ne(v,{type:"binary"});let _=0,b=[],h=[];for(let f in p.Sheets){if(_>0)continue;const x=ie.sheet_to_json(p.Sheets[f],{header:["0","1"]});if(x.length!=0){for(let V in x)if(x[V]!=null){let C=x;b.push(C[V][0]),h.push(C[V][1])}_++}}w.value=b,g.value=h,r("data"),M.value=j([w,g])}catch(v){console.log("error"),console.log(v)}},c.readAsArrayBuffer(e)},ee=u=>{S.value.clearFiles();const e=u[0];e.uid=fe(),S.value.handleStart(e),S.value.submit()};return ce(()=>{E.value=document.getElementById("main"),r("size"),H(),M.value=j([w,g])}),(u,e)=>{const c=d("el-input-number"),s=d("el-text"),v=d("el-button"),p=d("el-radio"),_=d("el-radio-group"),b=d("el-upload"),h=d("el-tooltip"),f=d("el-collapse-item"),x=d("el-radio-button"),V=d("el-divider"),C=d("el-switch"),N=d("el-input"),te=d("el-color-picker"),le=d("el-collapse"),ae=d("el-drawer");return me(),ve("div",we,[t(ue,{title:q.title},null,8,["title"]),i("div",ge,[i("div",be,[i("div",Ve,[t(c,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=l=>A.value=l),min:1,max:100,step:5,onChange:e[1]||(e[1]=l=>r("scale")),"step-strictly":""},null,8,["modelValue"]),t(s,null,{default:a(()=>[o("缩放：")]),_:1})]),Ce]),i("div",ke,[i("div",ye,[t(v,{class:"w-full mb-3",type:"primary",size:"large",onClick:Q},{default:a(()=>[o("下载图表")]),_:1}),i("div",Se,[t(s,null,{default:a(()=>[o("文件类型")]),_:1}),t(_,{modelValue:F.value,"onUpdate:modelValue":e[2]||(e[2]=l=>F.value=l),class:"ml-4"},{default:a(()=>[t(p,{size:"large",label:"1"},{default:a(()=>[o("PNG")]),_:1}),t(p,{size:"large",label:"2"},{default:a(()=>[o("JPEG")]),_:1})]),_:1},8,["modelValue"])]),i("div",Ue,[t(h,{class:"box-item",effect:"dark",content:"支持上传：xls, xlsx, csv文件",placement:"top-start"},{default:a(()=>[t(v,{class:"w-1/2"},{default:a(()=>[t(b,{"file-list":P.value,"onUpdate:fileList":e[3]||(e[3]=l=>P.value=l),class:"dataFileRef flex",ref_key:"dataFileRef",ref:S,accept:".xls,.xlsx,.csv","http-request":Z,"on-exceed":ee,limit:1},{default:a(()=>[o(" 上传数据 ")]),_:1},8,["file-list"])]),_:1})]),_:1}),t(v,{class:"w-1/2",onClick:X},{default:a(()=>[o("编辑数据")]),_:1})])]),t(le,{modelValue:W.value,"onUpdate:modelValue":e[24]||(e[24]=l=>W.value=l),onChange:Y,accordion:""},{default:a(()=>[t(f,{title:"画布设置",name:"1"},{default:a(()=>[i("div",De,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("宽度")]),_:1}),t(c,{modelValue:U.value,"onUpdate:modelValue":e[4]||(e[4]=l=>U.value=l),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:e[5]||(e[5]=l=>r("size"))},null,8,["modelValue"])]),i("div",Te,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("高度")]),_:1}),t(c,{modelValue:D.value,"onUpdate:modelValue":e[6]||(e[6]=l=>D.value=l),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:e[7]||(e[7]=l=>r("size"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"标题设置",name:"2"},{default:a(()=>[i("div",$e,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("位置")]),_:1}),t(_,{modelValue:$.value,"onUpdate:modelValue":e[8]||(e[8]=l=>$.value=l),class:"ml-3",onChange:e[9]||(e[9]=l=>r("title"))},{default:a(()=>[t(x,{label:"left",value:"left"},{default:a(()=>[o("左")]),_:1}),t(x,{label:"center",value:"center"},{default:a(()=>[o("中")]),_:1}),t(x,{label:"right",value:"right"},{default:a(()=>[o("右")]),_:1})]),_:1},8,["modelValue"])]),t(V,{"content-position":"left",class:"pl-10"},{default:a(()=>[o("标题")]),_:1}),i("div",ze,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:I.value,"onUpdate:modelValue":e[10]||(e[10]=l=>I.value=l),class:"ml-3",onChange:e[11]||(e[11]=l=>r("title"))},null,8,["modelValue"])]),i("div",Be,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("标题")]),_:1}),t(N,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:z.value,"onUpdate:modelValue":e[12]||(e[12]=l=>z.value=l),onBlur:e[13]||(e[13]=l=>r("title"))},null,8,["modelValue"])]),t(V,{"content-position":"left"},{default:a(()=>[o("副标题")]),_:1}),i("div",Ee,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:O.value,"onUpdate:modelValue":e[14]||(e[14]=l=>O.value=l),class:"ml-3",onChange:e[15]||(e[15]=l=>r("title"))},null,8,["modelValue"])]),i("div",Ae,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("副标题")]),_:1}),t(N,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:B.value,"onUpdate:modelValue":e[16]||(e[16]=l=>B.value=l),onBlur:e[17]||(e[17]=l=>r("title"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"图形属性",name:"3"},{default:a(()=>[i("div",Fe,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("颜色")]),_:1}),t(te,{modelValue:T.value,"onUpdate:modelValue":e[18]||(e[18]=l=>T.value=l),class:"ml-3",onChange:e[19]||(e[19]=l=>r("color"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"水印设置",name:"4"},{default:a(()=>[i("div",Ie,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:R.value,"onUpdate:modelValue":e[20]||(e[20]=l=>R.value=l),class:"ml-3",onChange:e[21]||(e[21]=l=>r("watermark"))},null,8,["modelValue"])]),i("div",Oe,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("水印内容")]),_:1}),t(N,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:L.value,"onUpdate:modelValue":e[22]||(e[22]=l=>L.value=l),onChange:e[23]||(e[23]=l=>r("watermark"))},null,8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])])]),t(ae,{id:"x-spreadsheet",modelValue:k.value,"onUpdate:modelValue":e[25]||(e[25]=l=>k.value=l),direction:"btt",class:"sheet",style:{}},null,8,["modelValue"])])}}});const We=xe(Re,[["__scopeId","data-v-39314dfb"],["__file","D:/3code/14H5/tools-vue-ts/src/components/Tools/Chart/Line/Line.vue"]]);export{We as default};
