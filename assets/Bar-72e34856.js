import{t as G,i as oe,S as q,a as se,r as ne,u as ue}from"./xlsx-20bc10ae.js";import{D as ie}from"./DetailHeader-47695dd5.js";import{d as de,l as re,M as n,o as ce,r as d,b as me,c as ve,h as t,f as u,w as a,i as o,O as fe,p as pe,k as _e,_ as xe}from"./index-17477c0a.js";const he=y=>(pe("data-v-513ee320"),y=y(),_e(),y),we={class:"flex flex-col mt-3 flex-1"},ge={class:"p-4 rounded-2xl flex"},Ve={class:"w-4/6"},be={class:"flex flex-row-reverse mb-4"},Ce=he(()=>u("div",{class:"flex justify-center items-center max-h-[500px] max-w-[1000px] overflow-auto"},[u("div",{id:"main",class:"bg-white"})],-1)),ke={class:"w-2/6 bg-white ml-3 rounded-lg p-3"},ye={class:"mb-3"},Se={class:"flex items-center ml-1"},Ue={class:"flex w-full"},Be={class:"flex"},De={class:"flex mt-3"},Te={class:"flex"},$e={class:"flex"},ze={class:"flex"},Ee={class:"flex"},Ae={class:"flex"},Fe={class:"flex"},Ie={class:"flex"},Oe={class:"flex"},Re=de({__name:"Bar",setup(y){const J=re({title:"柱状图"}),E=n(),m=n(),S=n(),H=n(1),A=n(100),U=n(720),B=n(400),F=n("1"),D=n("#5470c6"),T=n("center"),$=n("Tools-Web"),z=n("在线图表制作工具"),I=n(!0),O=n(!0),R=n(!1),M=n("Tools-Web"),L=()=>{let i=document.createElement("canvas"),e=i.getContext("2d");return i.width=i.height=100,e.textAlign="center",e.textBaseline="middle",e.globalAlpha=.08,e.font="20px Microsoft Yahei",e.translate(50,50),e.rotate(-Math.PI/4),e.fillText(M.value,0,0),i},r=i=>{var c,s,v,p,_;let e=E.value;switch(i){case"scale":let V=A.value/100;e.style.transform=`scale(${V})`;break;case"size":e.style.width=U.value+"px",e.style.height=B.value+"px",P();break;case"title":let h="",f="";I.value===!0&&(h=$.value),O.value===!0&&(f=z.value),(c=m.value)==null||c.setOption({title:{text:h,subtext:f,left:T.value}});break;case"color":(s=m.value)==null||s.setOption({series:[{itemStyle:{color:D.value}}]});break;case"watermark":R.value===!0?(v=m.value)==null||v.setOption({backgroundColor:{image:L()}}):(p=m.value)==null||p.setOption({backgroundColor:"#fff"});break;case"data":(_=m.value)==null||_.setOption({xAxis:{data:w.value},series:[{data:g.value}]});break}},Y=()=>{},w=n(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),g=n(["23","24","18","25","27","28","25"]),K={backgroundColor:"#fff",title:{text:$.value,subtext:z.value,left:T.value},xAxis:{data:w.value},yAxis:{},series:[{type:"bar",data:g.value,itemStyle:{color:D.value}}],tooltip:{}},P=()=>{m.value=oe(E.value),m.value.clear(),m.value.resize({width:U.value,height:B.value}),m.value.setOption(K)},Q=()=>{var s;let i=F.value=="1"?"png":"jpeg",e=(s=m.value)==null?void 0:s.getDataURL({type:i,pixelRatio:2});if(e!=null){var c=document.createElement("a");c.href=e,c.download="echart."+i,c.click()}},k=n(!1),N=n({}),X=()=>{k.value==!0?k.value=!1:(k.value=!0,q.locale("zh-cn",window.x_spreadsheet.$messages["zh-cn"]),new q("#x-spreadsheet",{showToolbar:!1,showBottomBar:!1,view:{height:()=>document.documentElement.clientHeight/2,width:()=>document.documentElement.clientWidth}}).loadData({styles:[{bgcolor:"#f4f5f8",textwrap:!0,color:"#900b09",border:{top:["thin","#0366d6"],bottom:["thin","#0366d6"],right:["thin","#0366d6"],left:["thin","#0366d6"]}}],rows:N.value}).change(i=>{let e=se(i);w.value=e[0],g.value=e[1],r("data")}))},j=n(),Z=async i=>{const e=i.file,c=new FileReader;c.onload=s=>{try{if(!s.target)return;const v=s.target.result,p=ne(v,{type:"binary"});let _=0,V=[],h=[];for(let f in p.Sheets){if(_>0)continue;const x=ue.sheet_to_json(p.Sheets[f],{header:["0","1"]});if(x.length!=0){for(let b in x)if(x[b]!=null){let C=x;V.push(C[b][0]),h.push(C[b][1])}_++}}w.value=V,g.value=h,r("data"),N.value=G([w,g])}catch(v){console.log("error"),console.log(v)}},c.readAsArrayBuffer(e)},ee=i=>{S.value.clearFiles();const e=i[0];e.uid=fe(),S.value.handleStart(e),S.value.submit()};return ce(()=>{E.value=document.getElementById("main"),r("size"),P(),N.value=G([w,g])}),(i,e)=>{const c=d("el-input-number"),s=d("el-text"),v=d("el-button"),p=d("el-radio"),_=d("el-radio-group"),V=d("el-upload"),h=d("el-tooltip"),f=d("el-collapse-item"),x=d("el-radio-button"),b=d("el-divider"),C=d("el-switch"),W=d("el-input"),te=d("el-color-picker"),le=d("el-collapse"),ae=d("el-drawer");return me(),ve("div",we,[t(ie,{title:J.title},null,8,["title"]),u("div",ge,[u("div",Ve,[u("div",be,[t(c,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=l=>A.value=l),min:1,max:100,step:5,onChange:e[1]||(e[1]=l=>r("scale")),"step-strictly":""},null,8,["modelValue"]),t(s,null,{default:a(()=>[o("缩放：")]),_:1})]),Ce]),u("div",ke,[u("div",ye,[t(v,{class:"w-full mb-3",type:"primary",size:"large",onClick:Q},{default:a(()=>[o("下载图表")]),_:1}),u("div",Se,[t(s,null,{default:a(()=>[o("文件类型")]),_:1}),t(_,{modelValue:F.value,"onUpdate:modelValue":e[2]||(e[2]=l=>F.value=l),class:"ml-4"},{default:a(()=>[t(p,{size:"large",label:"1"},{default:a(()=>[o("PNG")]),_:1}),t(p,{size:"large",label:"2"},{default:a(()=>[o("JPEG")]),_:1})]),_:1},8,["modelValue"])]),u("div",Ue,[t(h,{class:"box-item",effect:"dark",content:"支持上传：xls, xlsx, csv文件",placement:"top-start"},{default:a(()=>[t(v,{class:"w-1/2"},{default:a(()=>[t(V,{"file-list":j.value,"onUpdate:fileList":e[3]||(e[3]=l=>j.value=l),class:"dataFileRef flex",ref_key:"dataFileRef",ref:S,accept:".xls,.xlsx,.csv","http-request":Z,"on-exceed":ee,limit:1},{default:a(()=>[o(" 上传数据 ")]),_:1},8,["file-list"])]),_:1})]),_:1}),t(v,{class:"w-1/2",onClick:X},{default:a(()=>[o("编辑数据")]),_:1})])]),t(le,{modelValue:H.value,"onUpdate:modelValue":e[24]||(e[24]=l=>H.value=l),onChange:Y,accordion:""},{default:a(()=>[t(f,{title:"画布设置",name:"1"},{default:a(()=>[u("div",Be,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("宽度")]),_:1}),t(c,{modelValue:U.value,"onUpdate:modelValue":e[4]||(e[4]=l=>U.value=l),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:e[5]||(e[5]=l=>r("size"))},null,8,["modelValue"])]),u("div",De,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("高度")]),_:1}),t(c,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=l=>B.value=l),min:1,max:4e3,step:10,"controls-position":"right",class:"h-8 w-60 max-w-[60%] ml-3",onChange:e[7]||(e[7]=l=>r("size"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"标题设置",name:"2"},{default:a(()=>[u("div",Te,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("位置")]),_:1}),t(_,{modelValue:T.value,"onUpdate:modelValue":e[8]||(e[8]=l=>T.value=l),class:"ml-3",onChange:e[9]||(e[9]=l=>r("title"))},{default:a(()=>[t(x,{label:"left",value:"left"},{default:a(()=>[o("左")]),_:1}),t(x,{label:"center",value:"center"},{default:a(()=>[o("中")]),_:1}),t(x,{label:"right",value:"right"},{default:a(()=>[o("右")]),_:1})]),_:1},8,["modelValue"])]),t(b,{"content-position":"left",class:"pl-10"},{default:a(()=>[o("标题")]),_:1}),u("div",$e,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:I.value,"onUpdate:modelValue":e[10]||(e[10]=l=>I.value=l),class:"ml-3",onChange:e[11]||(e[11]=l=>r("title"))},null,8,["modelValue"])]),u("div",ze,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("标题")]),_:1}),t(W,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:$.value,"onUpdate:modelValue":e[12]||(e[12]=l=>$.value=l),onBlur:e[13]||(e[13]=l=>r("title"))},null,8,["modelValue"])]),t(b,{"content-position":"left"},{default:a(()=>[o("副标题")]),_:1}),u("div",Ee,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:O.value,"onUpdate:modelValue":e[14]||(e[14]=l=>O.value=l),class:"ml-3",onChange:e[15]||(e[15]=l=>r("title"))},null,8,["modelValue"])]),u("div",Ae,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("副标题")]),_:1}),t(W,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:z.value,"onUpdate:modelValue":e[16]||(e[16]=l=>z.value=l),onBlur:e[17]||(e[17]=l=>r("title"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"图形属性",name:"3"},{default:a(()=>[u("div",Fe,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("颜色")]),_:1}),t(te,{modelValue:D.value,"onUpdate:modelValue":e[18]||(e[18]=l=>D.value=l),class:"ml-3",onChange:e[19]||(e[19]=l=>r("color"))},null,8,["modelValue"])])]),_:1}),t(f,{title:"水印设置",name:"4"},{default:a(()=>[u("div",Ie,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("显示")]),_:1}),t(C,{modelValue:R.value,"onUpdate:modelValue":e[20]||(e[20]=l=>R.value=l),class:"ml-3",onChange:e[21]||(e[21]=l=>r("watermark"))},null,8,["modelValue"])]),u("div",Oe,[t(s,{class:"w-16 text-right"},{default:a(()=>[o("水印内容")]),_:1}),t(W,{class:"h-8 w-60 max-w-[60%] ml-3",modelValue:M.value,"onUpdate:modelValue":e[22]||(e[22]=l=>M.value=l),onChange:e[23]||(e[23]=l=>r("watermark"))},null,8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])])]),t(ae,{id:"x-spreadsheet",modelValue:k.value,"onUpdate:modelValue":e[25]||(e[25]=l=>k.value=l),direction:"btt","custom-class":"sheet",style:{}},null,8,["modelValue"])])}}});const He=xe(Re,[["__scopeId","data-v-513ee320"],["__file","D:/3code/14H5/tools-vue-ts/src/components/Tools/Chart/Bar/Bar.vue"]]);export{He as default};
